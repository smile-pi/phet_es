/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

// Copyright 2002-2013, University of Colorado Boulder

// Copyright 2002-2013, University of Colorado

/**
 * @license RequireJS i18n 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/i18n for details
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Author: Sam Reid (PhET Interactive Simulations)
 *
 * Load the strings only once and from a single location, because loading them from different relative paths
 * causes them to fall back to the root language sometimes for unknown reasons.
 * See #17 at https://github.com/phetsims/resistance-in-a-wire/issues/17
 *
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Model container for the "resistance-in-a-wire" module.
 *
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * White Block with black border container
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * view for vertical slider control
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Block shows resistance TextBlock
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Container for sliders and circumjacent text
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Block shows R = œÅL/A formula with letters scaling
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Container for resistor and nearby graphics
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Stage for the "ResistanceInAWire" view.
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * View for ResistanceInAWire simulations. Contains stage and reset button
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * Main entry point for the "resistance in a wire" sim.
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner)
 */

/**
 * Copyright 2002-2013, University of Colorado
 * RequireJS configuration file for Resistance in a Wire simulation.
 * @author Vasily Shakhov (Mlearner)
 * @author Anton Ulyanov (Mlearner
 */

!function(){var requirejs,require,define;!function(t){function e(t,e){return v.call(t,e)}function i(t,e){var i,n,s,r,o,a,h,u,l,c,d=e&&e.split("/"),f=p.map,m=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=d.concat(t.split("/")),u=0;u<t.length;u+=1)if(c=t[u],"."===c)t.splice(u,1),u-=1;else if(".."===c){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&f){for(i=t.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(l=d.length;l>0;l-=1)if(s=f[d.slice(0,l).join("/")],s&&(s=s[n])){r=s,o=u;break}if(r)break;!a&&m&&m[n]&&(a=m[n],h=u)}!r&&a&&(r=a,o=h),r&&(i.splice(0,o,r),t=i.join("/"))}return t}function n(e,i){return function(){return l.apply(t,y.call(arguments,0).concat([e,i]))}}function s(t){return function(e){return i(e,t)}}function r(t){return function(e){f[t]=e}}function o(i){if(e(m,i)){var n=m[i];delete m[i],g[i]=!0,u.apply(t,n)}if(!e(f,i)&&!e(g,i))throw new Error("No "+i);return f[i]}function a(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function h(t){return function(){return p&&p.config&&p.config[t]||{}}}var u,l,c,d,f={},m={},p={},g={},v=Object.prototype.hasOwnProperty,y=[].slice;c=function(t,e){var n,r=a(t),h=r[0];return t=r[1],h&&(h=i(h,e),n=o(h)),h?t=n&&n.normalize?n.normalize(t,s(e)):i(t,e):(t=i(t,e),r=a(t),h=r[0],t=r[1],h&&(n=o(h))),{f:h?h+"!"+t:t,n:t,pr:h,p:n}},d={require:function(t){return n(t)},exports:function(t){var e=f[t];return"undefined"!=typeof e?e:f[t]={}},module:function(t){return{id:t,uri:"",exports:f[t],config:h(t)}}},u=function(i,s,a,h){var u,l,p,v,y,E,S=[];if(h=h||i,"function"==typeof a){for(s=!s.length&&a.length?["require","exports","module"]:s,y=0;y<s.length;y+=1)if(v=c(s[y],h),l=v.f,"require"===l)S[y]=d.require(i);else if("exports"===l)S[y]=d.exports(i),E=!0;else if("module"===l)u=S[y]=d.module(i);else if(e(f,l)||e(m,l)||e(g,l))S[y]=o(l);else{if(!v.p)throw new Error(i+" missing "+l);v.p.load(v.n,n(h,!0),r(l),{}),S[y]=f[l]}p=a.apply(f[i],S),i&&(u&&u.exports!==t&&u.exports!==f[i]?f[i]=u.exports:p===t&&E||(f[i]=p))}else i&&(f[i]=a)},requirejs=require=l=function(e,i,n,s,r){return"string"==typeof e?d[e]?d[e](i):o(c(e,i).f):(e.splice||(p=e,i.splice?(e=i,i=n,n=null):e=t),i=i||function(){},"function"==typeof n&&(n=s,s=r),s?u(t,e,i,n):setTimeout(function(){u(t,e,i,n)},4),l)},l.config=function(t){return p=t,p.deps&&l(p.deps,p.callback),l},define=function(t,i,n){i.splice||(n=i,i=[]),e(f,t)||e(m,t)||(m[t]=[t,i,n])},define.amd={jQuery:!0}}(),define("almond",function(){}),define("JOIST/joistImageLoader",[],function(){return{imageNames:["phet-logo-loading.svg","phet-logo-short.svg","phet-logo-short.png"]}}),define("JOIST/SimLauncher",["require","JOIST/joistImageLoader"],function(t){var e=t("JOIST/joistImageLoader"),i=0;return{launch:function(t,n){function s(){i++,2===i&&($("#splash").remove(),n())}function r(t,e){var i=new PxLoader,n={};t.imageNames.forEach(function(t){n[t]=i.addImage(e+"/"+t)}),t.getImage=function(t){return n[t]},i.addCompletionListener(s),i.start()}r(t,"images");var o=new Image;o.onerror=function(){console.log("SimLauncher.js could not find the production/chipper image location for joist images, so looking for relative path ../joist/images... This is normal in development (requirejs) mode, see the documentation in SimLauncher.js"),r(e,"../joist/images")},o.onload=function(){r(e,"images/joist")},o.src="images/joist/"+e.imageNames[0]}}}),define("ASSERT/assert",["require"],function(){var t=function(t,e){var i="assert."+t,n=window.has&&void 0!==window.has(i),s=n?!window.has(i):e;return s?null:function(t,e){var i="function"==typeof t?t():t;if(!i){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(n){e=e+", stack=\n"+n.stack}throw new Error("Assertion failed: "+e)}}};return t}),define("SCENERY/scenery",["require","ASSERT/assert","ASSERT/assert"],function(t){window.sceneryAssert=t("ASSERT/assert")("scenery"),window.sceneryAssertExtra=t("ASSERT/assert")("scenery.extra"),window.sceneryLayerLog=null,window.sceneryEventLog=null,window.sceneryAccessibilityLog=null;var e=document.createElement("canvas"),i=e.getContext("2d");return{scratchCanvas:e,scratchContext:i,enableLayerLogging:function(){window.sceneryLayerLog=function(t){console.log(t)}},disableLayerLogging:function(){window.sceneryLayerLog=null},enableEventLogging:function(){window.sceneryEventLog=function(t){console.log(t)}},disableEventLogging:function(){window.sceneryEventLog=null},enableAccessibilityLogging:function(){window.sceneryAccessibilityLog=function(t){console.log(t)}},disableAccessibilityLogging:function(){window.sceneryAccessibilityLog=null}}}),define("DOT/dot",["require"],function(){var t=function e(){switch(arguments.length){case 2:return new e.Vector2(arguments[0],arguments[1]);case 3:return new e.Vector3(arguments[0],arguments[1],arguments[2]);case 4:return new e.Vector4(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw new Error("dot takes 2-4 arguments")}};return t.FastArray=window.Float64Array?window.Float64Array:window.Array,t}),define("PHET_CORE/extend",["require"],function(){return function(t){return _.each(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}),t}}),define("PHET_CORE/inherit",["require","PHET_CORE/extend"],function(t){function e(t,e,n,s){function r(){}return r.prototype=t.prototype,e.prototype=i(new r,{constructor:e},n),i(e,s),e}var i=t("PHET_CORE/extend");return e}),define("DOT/Util",["require","ASSERT/assert","DOT/dot"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");i.Util={testAssert:function(){return"assert.dot: "+(e?"true":"false")},clamp:function(t,e,i){return e>t?e:t>i?i:t},moduloBetweenDown:function(t,i,n){e&&e(n>i,"max > min required for moduloBetween");var s=n-i,r=(t-i)%s;return 0>r&&(r+=s),r+i},moduloBetweenUp:function(t,e,i){return-n.moduloBetweenDown(-t,-i,-e)},rangeInclusive:function(t,e){if(t>e)return[];for(var i=new Array(e-t+1),n=t;e>=n;n++)i[n-t]=n;return i},rangeExclusive:function(t,e){return n.rangeInclusive(t+1,e-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},lineLineIntersection:function(t,e,n,s){return new i.Vector2(((t.x*e.y-t.y*e.x)*(n.x-s.x)-(t.x-e.x)*(n.x*s.y-n.y*s.x))/((t.x-e.x)*(n.y-s.y)-(t.y-e.y)*(n.x-s.x)),((t.x*e.y-t.y*e.x)*(n.y-s.y)-(t.y-e.y)*(n.x*s.y-n.y*s.x))/((t.x-e.x)*(n.y-s.y)-(t.y-e.y)*(n.x-s.x)))},solveQuadraticRootsReal:function(t,e,i){var n=e*e-4*t*i;if(0>n)return[];var s=Math.sqrt(n);return[(-e-s)/(2*t),(-e+s)/(2*t)]},solveCubicRootsReal:function(t,e,i,s){var r=1e7;if(0===t||Math.abs(e/t)>r||Math.abs(i/t)>r||Math.abs(s/t)>r)return n.solveQuadraticRootsReal(e,i,s);if(0===s||Math.abs(t/s)>r||Math.abs(e/s)>r||Math.abs(i/s)>r)return n.solveQuadraticRootsReal(t,e,i);e/=t,i/=t,s/=t;var o=(3*i-e*e)/9,a=(-(27*s)+e*(9*i-2*e*e))/54,h=o*o*o+a*a,u=e/3;if(h>0){var l=Math.sqrt(h);return[n.cubeRoot(a+l)+n.cubeRoot(a-l)-u]}if(0===h){var c=n.cubeRoot(a),d=u-c;return[-u+2*c,d,d]}var f=-o*o*o;f=Math.acos(a/Math.sqrt(f));var m=2*Math.sqrt(-o);return[-u+m*Math.cos(f/3),-u+m*Math.cos((f+2*Math.PI)/3),-u+m*Math.cos((f+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,e,i,n,s){return(n-i)/(e-t)*(s-t)+i},toFixed:function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},isInteger:function(t){return Math.floor(t)===t}};var n=i.Util;return i.testAssert=n.testAssert,i.clamp=n.clamp,i.moduloBetweenDown=n.moduloBetweenDown,i.moduloBetweenUp=n.moduloBetweenUp,i.rangeInclusive=n.rangeInclusive,i.rangeExclusive=n.rangeExclusive,i.toRadians=n.toRadians,i.toDegrees=n.toDegrees,i.lineLineIntersection=n.lineLineIntersection,i.solveQuadraticRootsReal=n.solveQuadraticRootsReal,i.solveCubicRootsReal=n.solveCubicRootsReal,i.cubeRoot=n.cubeRoot,i.linear=n.linear,n}),define("DOT/Vector2",["require","ASSERT/assert","DOT/dot","PHET_CORE/inherit","DOT/Util"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot"),n=t("PHET_CORE/inherit");t("DOT/Util"),i.Vector2=function(t,i){this.x=t||0,this.y=i||0,e&&e("number"==typeof this.x,"x needs to be a number"),e&&e("number"==typeof this.y,"y needs to be a number")};var s=i.Vector2;s.createPolar=function(t,e){return new s(t*Math.cos(e),t*Math.sin(e))},s.prototype={constructor:s,isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},dot:function(t){return this.x*t.x+this.y*t.y},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,e){return e||(e=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(){return new s(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new s(this.x/t,this.y/t)},timesScalar:function(t){return new s(this.x*t,this.y*t)},times:function(t){return e&&e(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new s(this.x*t.x,this.y*t.y)},plus:function(t){return new s(this.x+t.x,this.y+t.y)},plusScalar:function(t){return new s(this.x+t,this.y+t)},minus:function(t){return new s(this.x-t.x,this.y-t.y)},minusScalar:function(t){return new s(this.x-t,this.y-t)},dividedScalar:function(t){return new s(this.x/t,this.y/t)},negated:function(){return new s(-this.x,-this.y)},angle:function(){return Math.atan2(this.y,this.x)},perpendicular:function(){return new s(this.y,-this.x)},angleBetween:function(t){var e=this.magnitude(),n=t.magnitude();return Math.acos(i.clamp((this.x*t.x+this.y*t.y)/(e*n),-1,1))},rotated:function(t){var e=this.angle()+t,i=this.magnitude();return new s(i*Math.cos(e),i*Math.sin(e))},blend:function(t,e){return new s(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new i.Vector3(this.x,this.y)},set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},subtractScalar:function(t){return this.x-=t,this.y-=t,this},componentMultiply:function(t){return this.x*=t.x,this.y*=t.y,this},divideScalar:function(t){return this.x/=t,this.y/=t,this},negate:function(){return this.x=-this.x,this.y=-this.y,this}},s.Immutable=function(t,e){s.call(this,t,e)};var r=s.Immutable;return n(s,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("set"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("copy"),r.mutableOverrideHelper("add"),r.mutableOverrideHelper("addScalar"),r.mutableOverrideHelper("subtract"),r.mutableOverrideHelper("subtractScalar"),r.mutableOverrideHelper("componentMultiply"),r.mutableOverrideHelper("divideScalar"),r.mutableOverrideHelper("negate"),s.ZERO=new r(0,0),s.X_UNIT=new r(1,0),s.Y_UNIT=new r(0,1),s}),define("DOT/Vector4",["require","ASSERT/assert","DOT/dot","DOT/Util"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");t("DOT/Util"),i.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1};var n=i.Vector4;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t,this.w/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return e&&e(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new n(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,e){return this.plus(t.minus(this).times(e))},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new i.Vector3(this.x,this.y,this.z)},set:function(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},setW:function(t){this.w=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t,this.w+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t,this.w-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t,this.w/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=e},isVector4:!0,dimension:4},n.Immutable=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1};var s=n.Immutable;return s.prototype=new n,s.prototype.constructor=s,s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},s.mutableOverrideHelper("set"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),s.mutableOverrideHelper("setW"),s.mutableOverrideHelper("copy"),s.mutableOverrideHelper("add"),s.mutableOverrideHelper("addScalar"),s.mutableOverrideHelper("subtract"),s.mutableOverrideHelper("subtractScalar"),s.mutableOverrideHelper("componentMultiply"),s.mutableOverrideHelper("divideScalar"),s.mutableOverrideHelper("negate"),n.ZERO=new s(0,0,0,0),n.X_UNIT=new s(1,0,0,0),n.Y_UNIT=new s(0,1,0,0),n.Z_UNIT=new s(0,0,1,0),n.W_UNIT=new s(0,0,0,1),n}),define("DOT/Vector3",["require","ASSERT/assert","DOT/dot","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),i.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};var n=i.Vector3;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},cross:function(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t)},times:function(t){return e&&e(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t)},negated:function(){return new n(-this.x,-this.y,-this.z)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,e){return this.plus(t.minus(this).times(e))},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new i.Vector2(this.x,this.y)},toVector4:function(){return new i.Vector4(this.x,this.y,this.z)},set:function(t,e,i){this.x=t,this.y=e,this.z=i},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=e},isVector3:!0,dimension:3},n.Immutable=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};var s=n.Immutable;return s.prototype=new n,s.prototype.constructor=s,s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},s.mutableOverrideHelper("set"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),s.mutableOverrideHelper("copy"),s.mutableOverrideHelper("add"),s.mutableOverrideHelper("addScalar"),s.mutableOverrideHelper("subtract"),s.mutableOverrideHelper("subtractScalar"),s.mutableOverrideHelper("componentMultiply"),s.mutableOverrideHelper("divideScalar"),s.mutableOverrideHelper("negate"),n.ZERO=new s(0,0,0),n.X_UNIT=new s(1,0,0),n.Y_UNIT=new s(0,1,0),n.Z_UNIT=new s(0,0,1),n}),define("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){var e=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var i=window.Float32Array||Array;e.Matrix4=function(t,e,n,s,r,o,a,h,u,l,c,d,f,m,p,g,v){this.entries=new i(16),this.rowMajor(void 0===t?1:t,e||0,n||0,s||0,r||0,void 0===o?1:o,a||0,h||0,u||0,l||0,void 0===c?1:c,d||0,f||0,m||0,p||0,void 0===g?1:g,v)};var n=e.Matrix4;n.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3};var s=n.Types;return n.identity=function(){return new n(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,s.IDENTITY)},n.translation=function(t,e,i){return new n(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1,s.TRANSLATION_3D)},n.translationFromVector=function(t){return n.translation(t.x,t.y,t.z)},n.scaling=function(t,e,i){return e=void 0===e?t:e,i=void 0===i?t:i,new n(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1,s.SCALING)},n.rotationAxisAngle=function(t,e){var i=Math.cos(e),r=Math.sin(e),o=1-i;return new n(t.x*t.x*o+i,t.x*t.y*o-t.z*r,t.x*t.z*o+t.y*r,0,t.y*t.x*o+t.z*r,t.y*t.y*o+i,t.y*t.z*o-t.x*r,0,t.z*t.x*o-t.y*r,t.z*t.y*o+t.x*r,t.z*t.z*o+i,0,0,0,0,1,s.OTHER)},n.rotationX=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1,s.OTHER)},n.rotationY=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1,s.OTHER)},n.rotationZ=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1,s.OTHER)},n.gluPerspective=function(t,e,i,s){var r=Math.cos(t)/Math.sin(t);return new n(r/e,0,0,0,0,r,0,0,0,0,(s+i)/(i-s),2*s*i/(i-s),0,0,-1,0)},n.prototype={constructor:n,rowMajor:function(t,e,i,n,r,o,a,h,u,l,c,d,f,m,p,g,v){this.entries[0]=t,this.entries[1]=r,this.entries[2]=u,this.entries[3]=f,this.entries[4]=e,this.entries[5]=o,this.entries[6]=l,this.entries[7]=m,this.entries[8]=i,this.entries[9]=a,this.entries[10]=c,this.entries[11]=p,this.entries[12]=n,this.entries[13]=h,this.entries[14]=d,this.entries[15]=g,this.type=void 0===v?s.OTHER:v},columnMajor:function(t,e,i,n,s,r,o,a,h,u,l,c,d,f,m,p,g){this.rowMajor(t,s,h,d,e,r,u,f,i,o,l,m,n,a,c,p,g)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},plus:function(t){return new n(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new n(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new n(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new n(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){var t=this.determinant();if(0!==t)return new n((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0")},timesMatrix:function(t){var e=s.OTHER;return this.type===s.TRANSLATION_3D&&t.type===s.TRANSLATION_3D&&(e=s.TRANSLATION_3D),this.type===s.SCALING&&t.type===s.SCALING&&(e=s.SCALING),this.type===s.IDENTITY&&(e=t.type),t.type===s.IDENTITY&&(e=this.type),new n(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33(),e)},timesVector4:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new e.Vector4(i,n,s,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,n=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,s=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new e.Vector4(i,n,s,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,n=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,s=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new e.Vector3(i,n,s)},determinant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},translation:function(){return new e.Vector3(this.m03(),this.m13(),this.m23())},scaling:function(){return new e.Vector3(this.m00(),this.m11(),this.m22())},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},n.IDENTITY=new n,n.IDENTITY.makeImmutable(),n}),define("DOT/Matrix3",["require","DOT/dot","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){var e=t("DOT/dot"),i=e.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4"),e.Matrix3=function(t,e,n,s,r,o,a,h,u,l){this.entries=new i(9),this.rowMajor(void 0===t?1:t,e||0,n||0,s||0,void 0===r?1:r,o||0,a||0,h||0,void 0===u?1:u,l)};var n=e.Matrix3;n.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var s=n.Types;return n.identity=function(){return new n(1,0,0,0,1,0,0,0,1,s.IDENTITY)},n.translation=function(t,e){return new n(1,0,t,0,1,e,0,0,1,s.TRANSLATION_2D)},n.translationFromVector=function(t){return n.translation(t.x,t.y)},n.scaling=function(t,e){return e=void 0===e?t:e,new n(t,0,0,0,e,0,0,0,1,s.SCALING)},n.scale=n.scaling,n.affine=function(t,e,i,r,o,a){return new n(t,i,o,e,r,a,0,0,1,s.AFFINE)},n.rotationAxisAngle=function(t,e){var i=Math.cos(e),r=Math.sin(e),o=1-i;return new n(t.x*t.x*o+i,t.x*t.y*o-t.z*r,t.x*t.z*o+t.y*r,t.y*t.x*o+t.z*r,t.y*t.y*o+i,t.y*t.z*o-t.x*r,t.z*t.x*o-t.y*r,t.z*t.y*o+t.x*r,t.z*t.z*o+i,s.OTHER)},n.rotationX=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(1,0,0,0,e,-i,0,i,e,s.OTHER)},n.rotationY=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(e,0,i,0,1,0,-i,0,e,s.OTHER)},n.rotationZ=function(t){var e=Math.cos(t),i=Math.sin(t);return new n(e,-i,0,i,e,0,0,0,1,s.AFFINE)},n.rotation2=n.rotationZ,n.fromSVGMatrix=function(t){return new n(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,s.AFFINE)},n.rotateAToB=function(t,i){var s,r,o,a=t,h=i,u=1e-4,l=a.cross(h);if(s=a.dot(h),o=0>s?-s:s,o>1-u){var c,d,f,m=new e.Vector3(a.x>0?a.x:-a.x,a.y>0?a.y:-a.y,a.z>0?a.z:-a.z);m=m.x<m.y?m.x<m.z?e.Vector3.X_UNIT:e.Vector3.Z_UNIT:m.y<m.z?e.Vector3.Y_UNIT:e.Vector3.Z_UNIT;var p=m.minus(a);return l=m.minus(h),c=2/p.dot(p),d=2/l.dot(l),f=c*d*p.dot(l),n.IDENTITY.plus(n.rowMajor(-c*p.x*p.x-d*l.x*l.x+f*l.x*p.x,-c*p.x*p.y-d*l.x*l.y+f*l.x*p.y,-c*p.x*p.z-d*l.x*l.z+f*l.x*p.z,-c*p.y*p.x-d*l.y*l.x+f*l.y*p.x,-c*p.y*p.y-d*l.y*l.y+f*l.y*p.y,-c*p.y*p.z-d*l.y*l.z+f*l.y*p.z,-c*p.z*p.x-d*l.z*l.x+f*l.z*p.x,-c*p.z*p.y-d*l.z*l.y+f*l.z*p.y,-c*p.z*p.z-d*l.z*l.z+f*l.z*p.z))
}var g,v,y,E,S;return r=1/(1+s),g=r*l.x,v=r*l.z,y=g*l.y,E=g*l.z,S=v*l.y,n.rowMajor(s+g*l.x,y-l.z,E+l.y,y+l.z,s+r*l.y*l.y,S-l.x,E-l.y,S+l.x,s+v*l.z)},n.prototype={constructor:n,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isAffine:function(){return this.type===s.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new e.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new e.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){var t=this.timesVector2(e.Vector2.X_UNIT).minus(this.timesVector2(e.Vector2.ZERO));return Math.atan2(t.y,t.x)},get rotation(){return this.getRotation()},toMatrix4:function(){return new e.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case s.IDENTITY:return"";case s.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+this.entries[7]+")";case s.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,e){return Math.abs(this.m00()-t.m00())<e&&Math.abs(this.m01()-t.m01())<e&&Math.abs(this.m02()-t.m02())<e&&Math.abs(this.m10()-t.m10())<e&&Math.abs(this.m11()-t.m11())<e&&Math.abs(this.m12()-t.m12())<e&&Math.abs(this.m20()-t.m20())<e&&Math.abs(this.m21()-t.m21())<e&&Math.abs(this.m22()-t.m22())<e},copy:function(){return new n(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return new n(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return new n(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return new n(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===s.IDENTITY||this.type===s.SCALING?this.type:void 0)},negated:function(){return new n(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_2D:return new n(1,0,-this.m02(),0,1,-this.m12(),0,0,1,s.TRANSLATION_2D);case s.SCALING:return new n(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),s.SCALING);case s.AFFINE:if(t=this.getDeterminant(),0!==t)return new n((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,s.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case s.OTHER:if(t=this.getDeterminant(),0!==t)return new n((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,s.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_2D)return new n(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,s.TRANSLATION_2D);if(this.type===s.SCALING)return new n(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?new n(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,s.AFFINE):new n(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02(),n=this.m10()*t.x+this.m11()*t.y+this.m12();return new e.Vector2(i,n)},timesVector3:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new e.Vector3(i,n,s)},timesTransposeVector2:function(t){var i=this.m00()*t.x+this.m10()*t.y,n=this.m01()*t.x+this.m11()*t.y;return new e.Vector2(i,n)},timesRelativeVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y,n=this.m10()*t.y+this.m11()*t.y;return new e.Vector2(i,n)},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},rowMajor:function(t,e,i,n,r,o,a,h,u,l){return this.entries[0]=t,this.entries[1]=n,this.entries[2]=a,this.entries[3]=e,this.entries[4]=r,this.entries[5]=h,this.entries[6]=i,this.entries[7]=o,this.entries[8]=u,this.type=void 0===l?0===a&&0===h&&1===u?s.AFFINE:s.OTHER:l,this},columnMajor:function(t,e,i,n,s,r,o,a,h,u){return this.rowMajor(t,n,o,e,s,a,i,r,h,u)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===s.IDENTITY||this.type===s.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,s.TRANSLATION_2D);case s.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),s.SCALING);case s.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,s.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case s.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,s.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,s.TRANSLATION_2D);if(this.type===s.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,s.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},multiplyVector2:function(t){var e=this.m00()*t.x+this.m01()*t.y+this.m02(),i=this.m10()*t.x+this.m11()*t.y+this.m12();return t.setX(e),t.setY(i),t},multiplyVector3:function(t){var e=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,i=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,n=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return t.setX(e),t.setY(i),t.setZ(n),t},multiplyTransposeVector2:function(t){var e=this.m00()*t.x+this.m10()*t.y,i=this.m01()*t.x+this.m11()*t.y;return t.setX(e),t.setY(i),t},multiplyRelativeVector2:function(t){var e=this.m00()*t.x+this.m01()*t.y,i=this.m10()*t.y+this.m11()*t.y;return t.setX(e),t.setY(i),t},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==s.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},n.IDENTITY=new n(1,0,0,0,1,0,0,0,1,s.IDENTITY),n.IDENTITY.makeImmutable(),n.X_REFLECTION=new n(-1,0,0,0,1,0,0,0,1,s.AFFINE),n.X_REFLECTION.makeImmutable(),n.Y_REFLECTION=new n(1,0,0,0,-1,0,0,0,1,s.AFFINE),n.Y_REFLECTION.makeImmutable(),n.translationTimesMatrix=function(t,e,i){var r;return i.type===s.IDENTITY||i.type===s.TRANSLATION_2D?new n(1,0,i.m02()+t,0,1,i.m12()+e,0,0,1,s.TRANSLATION_2D):(r=i.type===s.OTHER?s.OTHER:s.AFFINE,new n(i.m00(),i.m01(),i.m02()+t,i.m10(),i.m11(),i.m12()+e,i.m20(),i.m21(),i.m22(),r))},n.printer={print:function(t){console.log(t.toString())}},n}),define("DOT/Ray2",["require","ASSERT/assert","DOT/dot"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");i.Ray2=function(t,i){this.pos=t,this.dir=i,e&&e(Math.abs(i.magnitude()-1)<.01)};var n=i.Ray2;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),define("DOT/Transform3",["require","ASSERT/assert","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2"),i.Transform3=function(t){this.listeners=[],this.set(void 0===t?i.Matrix3.IDENTITY:t)};var n=i.Transform3;return n.prototype={constructor:n,set:function(t){e&&e(t instanceof i.Matrix3);var n,s=this.matrix,r=this.listeners.length;for(n=0;r>n;n++)this.listeners[n].before(t,s);for(this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null,n=0;r>n;n++)this.listeners[n].after(t,s)},prepend:function(t){this.set(t.timesMatrix(this.matrix))},prependTranslation:function(t,e){this.set(i.Matrix3.translationTimesMatrix(t,e,this.matrix))},append:function(t){this.set(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new n(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed},deepCopy:function(){var t=new n(this.matrix.copy());t.inverse=this.inverse?this.inverse.copy():null,t.matrixTransposed=this.matrixTransposed?this.matrixTransposed.copy():null,t.inverseTransposed=this.inverseTransposed?this.inverseTransposed.copy():null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){return this.transformPosition2(t).minus(this.transformPosition2(i.Vector2.ZERO))},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t)},transformDeltaX:function(t){return this.transformDelta2(new i.Vector2(t,0)).x},transformDeltaY:function(t){return this.transformDelta2(new i.Vector2(0,t)).y},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new i.Ray2(this.transformPosition2(t.pos),this.transformDelta2(t.dir).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){return this.inversePosition2(t).minus(this.inversePosition2(i.Vector2.ZERO))},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t)},inverseDeltaX:function(t){return this.inverseDelta2(new i.Vector2(t,0)).x},inverseDeltaY:function(t){return this.inverseDelta2(new i.Vector2(0,t)).y},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new i.Ray2(this.inversePosition2(t.pos),this.inverseDelta2(t.dir).normalized())},addTransformListener:function(t){e&&e(!_.contains(this.listeners,t)),this.listeners.push(t)},prependTransformListener:function(t){e&&e(!_.contains(this.listeners,t)),this.listeners.unshift(t)},removeTransformListener:function(t){e&&e(_.contains(this.listeners,t)),this.listeners.splice(_.indexOf(this.listeners,t),1)}},n}),define("DOT/Bounds2",["require","ASSERT/assert","DOT/dot","DOT/Vector2"],function(t){var e=t("ASSERT/assert")("dot"),i=t("DOT/dot");t("DOT/Vector2"),i.Bounds2=function(t,i,n,s){e&&e(void 0!==s,"Bounds2 requires 4 parameters"),this.minX=t,this.minY=i,this.maxX=n,this.maxY=s};var n=i.Bounds2;return n.prototype={constructor:n,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getCenter:function(){return new i.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,e){e=e||0;var i=this.isFinite(),n=t.isFinite();return i&&n?Math.abs(this.minX-t.minX)<e&&Math.abs(this.minY-t.minY)<e&&Math.abs(this.maxX-t.maxX)<e&&Math.abs(this.maxY-t.maxY)<e:i!==n?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<e:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<e:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<e:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<e:this.maxY===t.maxY)},copy:function(){return new n(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new n(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new n(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,e){return new n(Math.min(this.minX,t),Math.min(this.minY,e),Math.max(this.maxX,t),Math.max(this.maxY,e))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new n(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new n(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new n(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new n(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new n(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new n(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new n(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},eroded:function(t){return this.dilated(-t)},shiftedX:function(t){return new n(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new n(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,e){return new n(this.minX+t,this.minY+e,this.maxX+t,this.maxY+e)},set:function(t,e,i,n){return this.minX=t,this.minY=e,this.maxX=i,this.maxY=n,this},setBounds:function(t){return this.set(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.minX=Math.min(this.minX,t.minX),this.minY=Math.min(this.minY,t.minY),this.maxX=Math.max(this.maxX,t.maxX),this.maxY=Math.max(this.maxY,t.maxY),this},constrainBounds:function(t){return this.minX=Math.max(this.minX,t.minX),this.minY=Math.max(this.minY,t.minY),this.maxX=Math.min(this.maxX,t.maxX),this.maxY=Math.min(this.maxY,t.maxY),this},addCoordinates:function(t,e){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),this},addPoint:function(t){return this.addCoordinates(t.x,t.y)},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},roundOut:function(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this},roundIn:function(){return this.minX=Math.ceil(this.minX),this.minY=Math.ceil(this.minY),this.maxX=Math.floor(this.maxX),this.maxY=Math.floor(this.maxY),this},transform:function(t){if(this.isEmpty())return this;var e=this.minX,s=this.minY,r=this.maxX,o=this.maxY,a=new i.Vector2;return this.setBounds(n.NOTHING),this.addPoint(t.multiplyVector2(a.set(e,s))),this.addPoint(t.multiplyVector2(a.set(e,o))),this.addPoint(t.multiplyVector2(a.set(r,s))),this.addPoint(t.multiplyVector2(a.set(r,o))),this},dilate:function(t){return this.set(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},erode:function(t){return this.dilate(-t)},shiftX:function(t){return this.setMinX(this.minX+t).setMaxX(this.maxX+t)},shiftY:function(t){return this.setMinY(this.minY+t).setMaxY(this.maxY+t)},shift:function(t,e){return this.shiftX(t).shiftY(e)}},n.rect=function(t,e,i,s){return new n(t,e,t+i,e+s)},n.EVERYTHING=new n(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n.NOTHING=new n(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n}),define("SCENERY/util/Util",["require","SCENERY/scenery","DOT/Matrix3","DOT/Transform3","DOT/Bounds2","DOT/Vector2"],function(t){function e(t,e){return new o(t,e)}var i=t("SCENERY/scenery"),n=t("DOT/Matrix3"),s=t("DOT/Transform3"),r=t("DOT/Bounds2"),o=t("DOT/Vector2"),a=!1,h="",u="",l=!1,c=!1;if(document&&document.createElement){var d,f=document.createElement("div").style,m=["transform","webkitTransform","oTransform","mozTransform","msTransform"],p=["transformOrigin","webkitTransformOrigin","oTransformOrigin","mozTransformOrigin","msTransformOrigin"];for(d=0;d<m.length;d++)if(m[d]in f){h=m[d];break}for(d=0;d<p.length;d++)if(p[d]in f){u=p[d];break}u||(u="transformOrigin"),("webkitBackfaceVisibility"in f||"webkitTransform"in f)&&(l=!0),"mozTransform"in f&&(c=!0)}i.Util={extend:function(t){return _.each(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}),t},objectCreate:Object.create||function(t){function e(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return e.prototype=t,new e},applyCSSTransform:function(t,e){var i=t.getCSSTransform();(l||c)&&(i+=" translateZ(0)"),l&&(e.style.webkitBackfaceVisibility="hidden"),e.style[h]=i,e.style[u]="top left"},testAssert:function(){return"assert.scenery: false"},testAssertExtra:function(){return"assert.scenery.extra: false"},polyfillRequestAnimationFrame:function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),s=window.setTimeout(function(){e(i+n)},n);return t=i+n,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})},backingStorePixelRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},backingScale:function(t){if("devicePixelRatio"in window){var e=g.backingStorePixelRatio(t);return window.devicePixelRatio/e}return 1},scanBounds:function(t,i,n){for(var s=_.map(_.range(i),function(){return!1}),o=_.map(_.range(i),function(){return!1}),a=0;i>a;a++)for(var h=0;i>h;h++){var u=4*(h*i+a);(0!==t.data[u]||0!==t.data[u+1]||0!==t.data[u+2]||0!==t.data[u+3])&&(s[a]=!0,o[h]=!0)}var l=_.indexOf(s,!0),c=_.lastIndexOf(s,!0),d=_.indexOf(o,!0),f=_.lastIndexOf(o,!0),m=i/16;return{minBounds:new r(1>l||l>=i-1?Number.POSITIVE_INFINITY:n.inversePosition2(e(l+1+m,0)).x,1>d||d>=i-1?Number.POSITIVE_INFINITY:n.inversePosition2(e(0,d+1+m)).y,1>c||c>=i-1?Number.NEGATIVE_INFINITY:n.inversePosition2(e(c-m,0)).x,1>f||f>=i-1?Number.NEGATIVE_INFINITY:n.inversePosition2(e(0,f-m)).y),maxBounds:new r(1>l||l>=i-1?Number.NEGATIVE_INFINITY:n.inversePosition2(e(l-1-m,0)).x,1>d||d>=i-1?Number.NEGATIVE_INFINITY:n.inversePosition2(e(0,d-1-m)).y,1>c||c>=i-1?Number.POSITIVE_INFINITY:n.inversePosition2(e(c+2+m,0)).x,1>f||f>=i-1?Number.POSITIVE_INFINITY:n.inversePosition2(e(0,f+2+m)).y)}},canvasAccurateBounds:function(t,i){function o(e){function i(t){var e=document.createElement("canvas");e.width=l,e.height=l;var i=e.getContext("2d");i.putImageData(t,0,0),$(e).css("border","1px solid black"),$(window).ready(function(){$("#display").append(e)})}p.save(),e.matrix.canvasSetTransform(p),t(p),p.restore();var n=p.getImageData(0,0,l,l),s=g.scanBounds(n,l,e);return a&&i(n),p.clearRect(0,0,l,l),s}function h(t){var e=2,i=(l-2*e)/(t.maxX-t.minX),r=(l-2*e)/(t.maxY-t.minY),o=-i*t.minX+e,a=-r*t.minY+e;return new s(n.translation(o,a).timesMatrix(n.scaling(i,r)))}var u=i&&i.precision?i.precision:.001,l=i&&i.resolution?i.resolution:128,c=i&&i.initialScale?i.initialScale:1/16,d=r.NOTHING,f=r.EVERYTHING,m=document.createElement("canvas");m.width=l,m.height=l;var p=m.getContext("2d");a&&$(window).ready(function(){var t=document.createElement("h2");$(t).text("Bounds Scan"),$("#display").append(t)});var v=new s;v.append(n.translation(l/2,l/2)),v.append(n.scaling(c));var y=o(v);d=d.union(y.minBounds),f=f.intersection(y.maxBounds);var E,S,T;for(E=f.minY,S=f.maxY;isFinite(d.minX)&&isFinite(f.minX)&&Math.abs(d.minX-f.minX)>u;){if(T=o(h(new r(f.minX,E,d.minX,S))),d.minX<=T.minBounds.minX&&f.minX>=T.maxBounds.minX){a&&(console.log("warning, exiting infinite loop!"),console.log('transformed "min" minX: '+h(new r(f.minX,f.minY,d.minX,f.maxY)).transformPosition2(e(d.minX,0))),console.log('transformed "max" minX: '+h(new r(f.minX,f.minY,d.minX,f.maxY)).transformPosition2(e(f.minX,0))));break}d=d.withMinX(Math.min(d.minX,T.minBounds.minX)),f=f.withMinX(Math.max(f.minX,T.maxBounds.minX)),E=Math.max(E,T.maxBounds.minY),S=Math.min(S,T.maxBounds.maxY)}for(E=f.minY,S=f.maxY;isFinite(d.maxX)&&isFinite(f.maxX)&&Math.abs(d.maxX-f.maxX)>u;){if(T=o(h(new r(d.maxX,E,f.maxX,S))),d.maxX>=T.minBounds.maxX&&f.maxX<=T.maxBounds.maxX){a&&console.log("warning, exiting infinite loop!");break}d=d.withMaxX(Math.max(d.maxX,T.minBounds.maxX)),f=f.withMaxX(Math.min(f.maxX,T.maxBounds.maxX)),E=Math.max(E,T.maxBounds.minY),S=Math.min(S,T.maxBounds.maxY)}for(E=f.minX,S=f.maxX;isFinite(d.minY)&&isFinite(f.minY)&&Math.abs(d.minY-f.minY)>u;){if(T=o(h(new r(E,f.minY,S,d.minY))),d.minY<=T.minBounds.minY&&f.minY>=T.maxBounds.minY){a&&console.log("warning, exiting infinite loop!");break}d=d.withMinY(Math.min(d.minY,T.minBounds.minY)),f=f.withMinY(Math.max(f.minY,T.maxBounds.minY)),E=Math.max(E,T.maxBounds.minX),S=Math.min(S,T.maxBounds.maxX)}for(E=f.minX,S=f.maxX;isFinite(d.maxY)&&isFinite(f.maxY)&&Math.abs(d.maxY-f.maxY)>u;){if(T=o(h(new r(E,d.maxY,S,f.maxY))),d.maxY>=T.minBounds.maxY&&f.maxY<=T.maxBounds.maxY){a&&console.log("warning, exiting infinite loop!");break}d=d.withMaxY(Math.max(d.maxY,T.minBounds.maxY)),f=f.withMaxY(Math.min(f.maxY,T.maxBounds.maxY)),E=Math.max(E,T.maxBounds.minX),S=Math.min(S,T.maxBounds.maxX)}a&&(console.log("minBounds: "+d),console.log("maxBounds: "+f));var w=new r((d.minX+f.minX)/2,(d.minY+f.minY)/2,(d.maxX+f.maxX)/2,(d.maxY+f.maxY)/2);return w.minBounds=d,w.maxBounds=f,w.isConsistent=f.containsBounds(d),w.precision=Math.max(Math.abs(d.minX-f.minX),Math.abs(d.minY-f.minY),Math.abs(d.maxX-f.maxX),Math.abs(d.maxY-f.maxY)),w}};var g=i.Util;return g}),define("KITE/kite",["require"],function(){return{}}),define("KITE/segments/Segment",["require","ASSERT/assert","KITE/kite","DOT/Util"],function(t){var e=t("ASSERT/assert")("kite"),i=t("KITE/kite"),n=t("DOT/Util");i.Segment=function(){};var s=i.Segment;return s.prototype={constructor:s,subdivisions:function(t,i){for(var s=this,r=[],o=0;o<t.length;o++){var a=t[o],h=s.subdivided(a,i);e&&e(2===h.length),r.push(h[0]),s=h[1];for(var u=o+1;u<t.length;u++)t[u]=n.linear(a,1,0,1,t[u])}return r.push(s),r},subdividedIntoMonotone:function(){return this.subdivisions(this.getInteriorExtremaTs())}},s}),define("KITE/segments/Line",["require","ASSERT/assert","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Util","KITE/segments/Segment"],function(t){t("ASSERT/assert")("kite"),t("KITE/kite");var e=t("PHET_CORE/inherit"),i=t("DOT/Bounds2"),n=t("DOT/Util").lineLineIntersection,s=t("KITE/segments/Segment");return s.Line=function(t,e){return this.start=t,this.end=e,t.equals(e,0)?(this.invalid=!0,void 0):(this.startTangent=e.minus(t).normalized(),this.endTangent=this.startTangent,this.bounds=i.NOTHING.withPoint(t).withPoint(e),void 0)},e(s,s.Line,{positionAt:function(t){return this.start.plus(this.end.minus(this.start).times(t))},tangentAt:function(){return this.startTangent},curvatureAt:function(){return 0},getSVGPathFragment:function(){return"L "+this.end.x+" "+this.end.y},strokeLeft:function(t){var e=this.endTangent.perpendicular().negated().times(t/2);return[new s.Line(this.start.plus(e),this.end.plus(e))]},strokeRight:function(t){var e=this.startTangent.perpendicular().times(t/2);return[new s.Line(this.end.plus(e),this.start.plus(e))]},getInteriorExtremaTs:function(){return[]},subdivided:function(t){var e=this.positionAt(t);return[new s.Line(this.start,e),new s.Line(e,this.end)]},intersectsBounds:function(){throw new Error("Segment.Line.intersectsBounds unimplemented")},intersection:function(t){var e=[],i=this.start,s=this.end,r=n(i,s,t.pos,t.pos.plus(t.dir));if(!isFinite(r.x)||!isFinite(r.y))return e;if(i.x!==s.x&&(i.x>s.x?r.x>=i.x||r.x<s.x:r.x<=i.x||r.x>s.x))return e;
if(i.y!==s.y&&(i.y>s.y?r.y>=i.y||r.y<s.y:r.y<=i.y||r.y>s.y))return e;var o=r.minus(t.pos).dot(t.dir);if(0>o)return e;var a=s.minus(i),h=a.perpendicular();return e.push({distance:o,point:t.pointAtDistance(o),normal:h.dot(t.dir)>0?h.negated():h,wind:t.dir.perpendicular().dot(a)<0?1:-1}),e},windingIntersection:function(t){var e=this.intersection(t);return e.length?e[0].wind:0},writeToContext:function(t){t.lineTo(this.end.x,this.end.y)},transformed:function(t){return new s.Line(t.timesVector2(this.start),t.timesVector2(this.end))}}),s.Line}),define("KITE/segments/Arc",["require","ASSERT/assert","KITE/kite","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Util","KITE/segments/Segment"],function(t){var e=t("ASSERT/assert")("kite");t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),s=t("DOT/Bounds2"),r=t("DOT/Util"),o=t("KITE/segments/Segment");return o.Arc=function(t,i,r,o,a){function h(e){u.containsAngle(e)&&(u.bounds=u.bounds.withPoint(t.plus(n.createPolar(i,e))))}if(0>i&&(i=-i,r+=Math.PI,o+=Math.PI),this.center=t,this.radius=i,this.startAngle=r,this.endAngle=o,this.anticlockwise=a,this.start=this.positionAtAngle(r),this.end=this.positionAtAngle(o),this.startTangent=this.tangentAtAngle(r),this.endTangent=this.tangentAtAngle(o),0>=i||r===o)return this.invalid=!0,void 0;this.actualEndAngle=this.anticlockwise?this.startAngle>this.endAngle?this.endAngle:this.startAngle<this.endAngle?this.endAngle-2*Math.PI:this.startAngle:this.startAngle<this.endAngle?this.endAngle:this.startAngle>this.endAngle?this.endAngle+2*Math.PI:this.startAngle,e&&e(!(!a&&o-r<=2*-Math.PI||a&&r-o<=2*-Math.PI),"Not handling arcs with start/end angles that show differences in-between browser handling"),e&&e(!(!a&&o-r>2*Math.PI||a&&r-o>2*Math.PI),"Not handling arcs with start/end angles that show differences in-between browser handling"),!a&&o-r>=2*Math.PI||a&&r-o>=2*Math.PI,this.angleDifference=this.anticlockwise?this.startAngle-this.endAngle:this.endAngle-this.startAngle,this.angleDifference<0&&(this.angleDifference+=2*Math.PI),e&&e(this.angleDifference>=0),this.bounds=s.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var u=this;r!==o&&(h(0),h(Math.PI/2),h(Math.PI),h(3*Math.PI/2))},i(o,o.Arc,{mapAngle:function(t){return this.startAngle>this.actualEndAngle?r.moduloBetweenUp(t,this.startAngle-2*Math.PI,this.startAngle):r.moduloBetweenDown(t,this.startAngle,this.startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this.startAngle)/(this.actualEndAngle-this.startAngle)},angleAt:function(t){return this.startAngle+(this.actualEndAngle-this.startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(){return(this.anticlockwise?-1:1)/this.radius},positionAtAngle:function(t){return this.center.plus(n.createPolar(this.radius,t))},tangentAtAngle:function(t){var e=n.createPolar(1,t);return this.anticlockwise?e.perpendicular():e.perpendicular().negated()},containsAngle:function(t){var e=this.anticlockwise?t-this.endAngle:t-this.startAngle,i=r.moduloBetweenDown(e,0,2*Math.PI);return i<=this.angleDifference},getSVGPathFragment:function(){var t,e=.01,i=this.anticlockwise?"0":"1";if(this.angleDifference<2*Math.PI-e)return t=this.angleDifference<Math.PI?"0":"1","A "+this.radius+" "+this.radius+" 0 "+t+" "+i+" "+this.end.x+" "+this.end.y;var s=(this.startAngle+this.endAngle)/2,r=this.center.plus(n.createPolar(this.radius,s));t="0";var o="A "+this.radius+" "+this.radius+" 0 "+t+" "+i+" "+r.x+" "+r.y,a="A "+this.radius+" "+this.radius+" 0 "+t+" "+i+" "+this.end.x+" "+this.end.y;return o+" "+a},strokeLeft:function(t){return[new o.Arc(this.center,this.radius+(this.anticlockwise?1:-1)*t/2,this.startAngle,this.endAngle,this.anticlockwise)]},strokeRight:function(t){return[new o.Arc(this.center,this.radius+(this.anticlockwise?-1:1)*t/2,this.endAngle,this.startAngle,!this.anticlockwise)]},getInteriorExtremaTs:function(){var t=this,e=[];return _.each([0,Math.PI/2,Math.PI,3*Math.PI/2],function(i){if(t.containsAngle(i)){var n=t.tAtAngle(i),s=1e-10;n>s&&1-s>n&&e.push(n)}}),e.sort()},subdivided:function(t){var e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new o.Arc(this.center,this.radius,e,i,this.anticlockwise),new o.Arc(this.center,this.radius,i,n,this.anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.intersectsBounds unimplemented!")},intersection:function(t){var e=[],i=0,n=t.pos.minus(this.center),s=t.dir.dot(n),r=n.magnitudeSquared(),o=4*s*s-4*(r-this.radius*this.radius);if(i>o)return e;var a=t.dir.dot(this.center)-t.dir.dot(t.pos),h=Math.sqrt(o)/2,u=a-h,l=a+h;if(i>l)return e;var c=t.pointAtDistance(l),d=c.minus(this.center).normalized();if(i>u)this.containsAngle(d.angle())&&e.push({distance:l,point:c,normal:d.negated(),wind:this.anticlockwise?-1:1});else{var f=t.pointAtDistance(u),m=f.minus(this.center).normalized();this.containsAngle(m.angle())&&e.push({distance:u,point:f,normal:m,wind:this.anticlockwise?1:-1}),this.containsAngle(d.angle())&&e.push({distance:l,point:c,normal:d.negated(),wind:this.anticlockwise?-1:1})}return e},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.arc(this.center.x,this.center.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},transformed:function(t){var e=t.timesVector2(n.createPolar(1,this.startAngle)).minus(t.timesVector2(n.ZERO)).angle(),i=t.timesVector2(n.createPolar(1,this.endAngle)).minus(t.timesVector2(n.ZERO)).angle(),s=t.getDeterminant()>=0?this.anticlockwise:!this.anticlockwise,r=t.getScaleVector();if(r.x!==r.y){var a=r.x*this.radius,h=r.y*this.radius;return new o.EllipticalArc(t.timesVector2(this.center),a,h,0,e,i,s)}var u=r.x*this.radius;return new o.Arc(t.timesVector2(this.center),u,e,i,s)}}),o.Arc}),define("KITE/util/Subpath",["require","ASSERT/assert","DOT/Vector2","DOT/Bounds2","DOT/Util","KITE/kite","KITE/segments/Line","KITE/segments/Arc"],function(t){var e=t("ASSERT/assert")("kite");t("DOT/Vector2");var i=t("DOT/Bounds2"),n=t("DOT/Util").lineLineIntersection,s=t("KITE/kite");t("KITE/segments/Line"),t("KITE/segments/Arc"),s.Subpath=function(t,e,i){this.segments=t||[],this.points=e||(t&&t.length?_.map(t,function(t){return t.start}).concat(t[t.length-1].end):[]),this.closed=!!i,this._strokedSubpaths=null,this._strokedSubpathsComputed=!1,this._strokedStyles=null};var r=s.Subpath;return r.prototype={copy:function(){return new r(this.segments.slice(0),this.points.slice(0),this.closed)},invalidate:function(){this._strokedSubpathsComputed=!1},addPoint:function(t){return this.points.push(t),this},addSegment:function(t){return t.invalid||(e&&e(t.start.isFinite(),"Segment start is infinite"),e&&e(t.end.isFinite(),"Segment end is infinite"),e&&e(t.startTangent.isFinite(),"Segment startTangent is infinite"),e&&e(t.endTangent.isFinite(),"Segment endTangent is infinite"),e&&e(t.bounds.isEmpty()||t.bounds.isFinite(),"Segment bounds is infinite and non-empty"),this.segments.push(t),this.invalidate()),this},close:function(){this.closed=!0},getLength:function(){return this.points.length},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},getFirstSegment:function(){return _.first(this.segments)},getLastSegment:function(){return _.last(this.segments)},isDrawable:function(){return this.segments.length>0},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equalsEpsilon(this.getLastPoint(),1e-9)},getClosingSegment:function(){return e&&e(this.hasClosingSegment(),"Implicit closing segment unnecessary on a fully closed path"),new s.Segment.Line(this.getLastPoint(),this.getFirstPoint())},writeToContext:function(t){if(this.isDrawable()){var e=this.getFirstSegment().start;t.moveTo(e.x,e.y);for(var i=this.segments.length,n=0;i>n;n++)this.segments[n].writeToContext(t);this.closed&&t.closePath()}},transformed:function(t){return new r(_.map(this.segments,function(e){return e.transformed(t)}),_.map(this.points,function(e){return t.timesVector2(e)}),this.closed)},computeBounds:function(){for(var t=i.NOTHING.copy(),e=this.segments.length,n=0;e>n;n++)t.includeBounds(this.segments[n].bounds);return t},stroked:function(t){function e(e,i,r){var o=e.plus(i.perpendicular().negated().times(u/2)),a=e.plus(r.perpendicular().negated().times(u/2)),h=o.equals(a)?[]:[new s.Segment.Line(o,a)];if(!(i.perpendicular().dot(r)>0))return h;switch(t.lineJoin){case"round":var l=i.angle()+Math.PI/2,c=r.angle()+Math.PI/2;return[new s.Segment.Arc(e,u/2,l,c,!0)];case"miter":var d=i.angleBetween(r.negated());if(d<Math.PI-1e-5,1/Math.sin(d/2)<=t.miterLimit&&d<Math.PI-1e-5){var f=n(o,o.plus(i),a,a.plus(r));return[new s.Segment.Line(o,f),new s.Segment.Line(f,a)]}return h;case"bevel":return h}}function i(e,i){var n=e.plus(i.perpendicular().times(-u/2)),r=e.plus(i.perpendicular().times(u/2));switch(t.lineCap){case"butt":return[new s.Segment.Line(n,r)];case"round":var o=i.angle();return[new s.Segment.Arc(e,u/2,o+Math.PI/2,o-Math.PI/2,!0)];case"square":var a=i.perpendicular().negated().times(u/2),h=i.perpendicular().times(u/2),l=i.times(u/2),c=e.plus(a).plus(l),d=e.plus(h).plus(l);return[new s.Segment.Line(n,c),new s.Segment.Line(c,d),new s.Segment.Line(d,r)]}}function o(t){l=l.concat(t)}function a(t){c=c.concat(t)}if(!this.isDrawable())return[];if(void 0===t&&(t=new s.LineStyles),this._strokedSubpathsComputed&&this._strokedStyles.equals(t))return this._strokedSubpaths;var h,u=t.lineWidth,l=[],c=[],d=this.getFirstSegment(),f=this.getLastSegment(),m=f.end.equals(d.start),p=m?null:new s.Segment.Line(this.segments[this.segments.length-1].end,this.segments[0].start);for(h=0;h<this.segments.length;h++)h>0&&o(e(this.segments[h].start,this.segments[h-1].endTangent,this.segments[h].startTangent,!0)),o(this.segments[h].strokeLeft(u));for(h=this.segments.length-1;h>=0;h--)h<this.segments.length-1&&a(e(this.segments[h].end,this.segments[h+1].startTangent.negated(),this.segments[h].endTangent.negated(),!1)),a(this.segments[h].strokeRight(u));var g;return this.closed?(m?(o(e(f.end,f.endTangent,d.startTangent)),a(e(f.end,d.startTangent.negated(),f.endTangent.negated()))):(o(e(p.start,f.endTangent,p.startTangent)),o(p.strokeLeft(u)),o(e(p.end,p.endTangent,d.startTangent)),a(e(p.end,d.startTangent.negated(),p.endTangent.negated())),a(p.strokeRight(u)),a(e(p.start,p.startTangent.negated(),f.endTangent.negated()))),g=[new r(l,null,!0),new r(c,null,!0)]):g=[new r(l.concat(i(f.end,f.endTangent)).concat(c).concat(i(d.start,d.startTangent.negated())),null,!0)],this._strokedSubpaths=g,this._strokedSubpathsComputed=!0,this._strokedStyles=new s.LineStyles(t),g}},s.Subpath}),define("KITE/../parser/svgPath",["require","KITE/kite"],function(t){function e(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var i=t("KITE/kite");i.svgPath={parse:function(t,i){function n(t){Q>j||(j>Q&&(Q=j,$=[]),$.push(t))}function s(){var t,e,i,n,s,o;for(s=j,o=j,t=[],e=X();null!==e;)t.push(e),e=X();if(null!==t)if(e=r(),e=null!==e?e:"",null!==e){for(i=[],n=X();null!==n;)i.push(n),n=X();null!==i?t=[t,e,i]:(t=null,j=o)}else t=null,j=o;else t=null,j=o;return null!==t&&(t=function(t,e){return e?e:[]}(s,t[1])),null===t&&(j=s),t}function r(){var t,e,i,n,s;if(n=j,s=j,t=o(),null!==t){for(e=[],i=X();null!==i;)e.push(i),i=X();null!==e?(i=r(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)}else t=null,j=s;return null!==t&&(t=function(t,e,i){return e.concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=o(),null!==t&&(t=function(t,e){return e}(n,t)),null===t&&(j=n)),t}function o(){var t,e,i,n,s;if(n=j,s=j,t=u(),null!==t){for(e=[],i=X();null!==i;)e.push(i),i=X();null!==e?(i=a(),i=null!==i?i:"",null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)}else t=null,j=s;return null!==t&&(t=function(t,e,i){return i.length?e.concat(i):e}(n,t[0],t[2])),null===t&&(j=n),t}function a(){var t,e,i,n,s;if(n=j,s=j,t=h(),null!==t){for(e=[],i=X();null!==i;)e.push(i),i=X();null!==e?(i=a(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)}else t=null,j=s;return null!==t&&(t=function(t,e,i){return e.concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=h(),null!==t&&(t=function(t,e){return e}(n,t)),null===t&&(j=n)),t}function h(){var t;return t=c(),null===t&&(t=d(),null===t&&(t=m(),null===t&&(t=g(),null===t&&(t=y(),null===t&&(t=T(),null===t&&(t=C(),null===t&&(t=R(),null===t&&(t=N())))))))),t}function u(){var e,i,s,r,o;if(r=j,o=j,77===t.charCodeAt(j)?(e="M",j++):(e=null,0===J&&n('"M"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=l(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return W(e,!1)}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,109===t.charCodeAt(j)?(e="m",j++):(e=null,0===J&&n('"m"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=l(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return W(e,!0)}(r,e[2])),null===e&&(j=r)}return e}function l(){var t,e,i,n,s;return n=j,s=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=f(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=A(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function c(){var e,i;return i=j,90===t.charCodeAt(j)?(e="Z",j++):(e=null,0===J&&n('"Z"')),null===e&&(122===t.charCodeAt(j)?(e="z",j++):(e=null,0===J&&n('"z"'))),null!==e&&(e=function(){return{cmd:"close"}}(i,e)),null===e&&(j=i),e}function d(){var e,i,s,r,o;if(r=j,o=j,76===t.charCodeAt(j)?(e="L",j++):(e=null,0===J&&n('"L"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=f(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"lineTo",args:[t.x,t.y]}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,108===t.charCodeAt(j)?(e="l",j++):(e=null,0===J&&n('"l"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=f(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"lineToRelative",args:[t.x,t.y]}})}(r,e[2])),null===e&&(j=r)}return e}function f(){var t,e,i,n,s;return n=j,s=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=f(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=A(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function m(){var e,i,s,r,o;if(r=j,o=j,72===t.charCodeAt(j)?(e="H",j++):(e=null,0===J&&n('"H"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=p(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"horizontalLineTo",args:[t]}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,104===t.charCodeAt(j)?(e="h",j++):(e=null,0===J&&n('"h"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=p(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"horizontalLineToRelative",args:[t]}})}(r,e[2])),null===e&&(j=r)}return e}function p(){var t,e,i,n,s;return n=j,s=j,t=O(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=p(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=O(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function g(){var e,i,s,r,o;if(r=j,o=j,86===t.charCodeAt(j)?(e="V",j++):(e=null,0===J&&n('"V"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=v(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"verticalLineTo",args:[t]}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,118===t.charCodeAt(j)?(e="v",j++):(e=null,0===J&&n('"v"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=v(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"verticalLineToRelative",args:[t]}})}(r,e[2])),null===e&&(j=r)}return e}function v(){var t,e,i,n,s;return n=j,s=j,t=O(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=v(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=O(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function y(){var e,i,s,r,o;if(r=j,o=j,67===t.charCodeAt(j)?(e="C",j++):(e=null,0===J&&n('"C"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=E(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"cubicCurveTo",args:t}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,99===t.charCodeAt(j)?(e="c",j++):(e=null,0===J&&n('"c"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=E(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"cubicCurveToRelative",args:t}})}(r,e[2])),null===e&&(j=r)}return e}function E(){var t,e,i,n,s;return n=j,s=j,t=S(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=E(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=S(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function S(){var t,e,i,n,s,r,o;return r=j,o=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=A(),null!==i?(n=B(),n=null!==n?n:"",null!==n?(s=A(),null!==s?t=[t,e,i,n,s]:(t=null,j=o)):(t=null,j=o)):(t=null,j=o)):(t=null,j=o)):(t=null,j=o),null!==t&&(t=function(t,e,i,n){return[e.x,e.y,i.x,i.y,n.x,n.y]}(r,t[0],t[2],t[4])),null===t&&(j=r),t}function T(){var e,i,s,r,o;if(r=j,o=j,83===t.charCodeAt(j)?(e="S",j++):(e=null,0===J&&n('"S"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=w(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"smoothCubicCurveTo",args:t}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,115===t.charCodeAt(j)?(e="s",j++):(e=null,0===J&&n('"s"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=w(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"smoothCubicCurveToRelative",args:t}})}(r,e[2])),null===e&&(j=r)}return e}function w(){var t,e,i,n,s;return n=j,s=j,t=b(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=w(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=b(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function b(){var t,e,i,n,s;return n=j,s=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=A(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e.x,e.y,i.x,i.y]}(n,t[0],t[2])),null===t&&(j=n),t}function C(){var e,i,s,r,o;if(r=j,o=j,81===t.charCodeAt(j)?(e="Q",j++):(e=null,0===J&&n('"Q"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=x(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"quadraticCurveTo",args:t}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,113===t.charCodeAt(j)?(e="q",j++):(e=null,0===J&&n('"q"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=x(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"quadraticCurveToRelative",args:t}})}(r,e[2])),null===e&&(j=r)}return e}function x(){var t,e,i,n,s;return n=j,s=j,t=_(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=x(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=_(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function _(){var t,e,i,n,s;return n=j,s=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=A(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e.x,e.y,i.x,i.y]}(n,t[0],t[2])),null===t&&(j=n),t}function R(){var e,i,s,r,o;if(r=j,o=j,84===t.charCodeAt(j)?(e="T",j++):(e=null,0===J&&n('"T"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=P(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"smoothQuadraticCurveTo",args:[t.x,t.y]}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,116===t.charCodeAt(j)?(e="t",j++):(e=null,0===J&&n('"t"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=P(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"smoothQuadraticCurveToRelative",args:[t.x,t.y]}})}(r,e[2])),null===e&&(j=r)}return e}function P(){var t,e,i,n,s;return n=j,s=j,t=A(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=P(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=A(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function N(){var e,i,s,r,o;if(r=j,o=j,65===t.charCodeAt(j)?(e="A",j++):(e=null,0===J&&n('"A"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=I(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;if(null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"ellipticalArcTo",args:t}})}(r,e[2])),null===e&&(j=r),null===e){if(r=j,o=j,97===t.charCodeAt(j)?(e="a",j++):(e=null,0===J&&n('"a"')),null!==e){for(i=[],s=X();null!==s;)i.push(s),s=X();null!==i?(s=I(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)}else e=null,j=o;null!==e&&(e=function(t,e){return e.map(function(t){return{cmd:"ellipticalArcToRelative",args:t}})}(r,e[2])),null===e&&(j=r)}return e}function I(){var t,e,i,n,s;return n=j,s=j,t=L(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=I(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(n,t[0],t[2])),null===t&&(j=n),null===t&&(n=j,t=L(),null!==t&&(t=function(t,e){return[e]}(n,t)),null===t&&(j=n)),t}function L(){var t,e,i,n,s,r,o,a,h,u,l,c,d;return c=j,d=j,t=M(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=M(),null!==i?(n=B(),n=null!==n?n:"",null!==n?(s=O(),null!==s?(r=B(),null!==r?(o=Y(),null!==o?(a=B(),a=null!==a?a:"",null!==a?(h=Y(),null!==h?(u=B(),u=null!==u?u:"",null!==u?(l=A(),null!==l?t=[t,e,i,n,s,r,o,a,h,u,l]:(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d)):(t=null,j=d),null!==t&&(t=function(t,e,i,n,s,r,o){return[e,i,n,s,r,o.x,o.y]}(c,t[0],t[2],t[4],t[6],t[8],t[10])),null===t&&(j=c),t}function A(){var t,e,i,n,s;return n=j,s=j,t=O(),null!==t?(e=B(),e=null!==e?e:"",null!==e?(i=O(),null!==i?t=[t,e,i]:(t=null,j=s)):(t=null,j=s)):(t=null,j=s),null!==t&&(t=function(t,e,i){return{x:e,y:i}}(n,t[0],t[2])),null===t&&(j=n),t}function M(){var t,e;return e=j,t=k(),null!==t&&(t=function(t,e){return parseFloat(e,10)}(e,t)),null===t&&(j=e),null===t&&(e=j,t=V(),null!==t&&(t=function(t,e){return parseInt(e,10)}(e,t)),null===t&&(j=e)),t}function O(){var t,e,i,n;return i=j,n=j,t=H(),t=null!==t?t:"",null!==t?(e=k(),null!==e?t=[t,e]:(t=null,j=n)):(t=null,j=n),null!==t&&(t=function(t,e,i){return parseFloat(e+i,10)}(i,t[0],t[1])),null===t&&(j=i),null===t&&(i=j,n=j,t=H(),t=null!==t?t:"",null!==t?(e=V(),null!==e?t=[t,e]:(t=null,j=n)):(t=null,j=n),null!==t&&(t=function(t,e,i){return parseInt(e+i,10)}(i,t[0],t[1])),null===t&&(j=i)),t}function Y(){var e,i;return i=j,48===t.charCodeAt(j)?(e="0",j++):(e=null,0===J&&n('"0"')),null!==e&&(e=function(){return!1}(i)),null===e&&(j=i),null===e&&(i=j,49===t.charCodeAt(j)?(e="1",j++):(e=null,0===J&&n('"1"')),null!==e&&(e=function(){return!0}(i)),null===e&&(j=i)),e}function B(){var t,e,i,n,s;if(s=j,e=X(),null!==e)for(t=[];null!==e;)t.push(e),e=X();else t=null;if(null!==t)if(e=D(),e=null!==e?e:"",null!==e){for(i=[],n=X();null!==n;)i.push(n),n=X();null!==i?t=[t,e,i]:(t=null,j=s)}else t=null,j=s;else t=null,j=s;if(null===t)if(s=j,t=D(),null!==t){for(e=[],i=X();null!==i;)e.push(i),i=X();null!==e?t=[t,e]:(t=null,j=s)}else t=null,j=s;return t}function D(){var e;return 44===t.charCodeAt(j)?(e=",",j++):(e=null,0===J&&n('","')),e}function k(){var t,e,i,n;return i=j,n=j,t=F(),null!==t?(e=q(),e=null!==e?e:"",null!==e?t=[t,e]:(t=null,j=n)):(t=null,j=n),null!==t&&(t=function(t,e,i){return e+i}(i,t[0],t[1])),null===t&&(j=i),null===t&&(i=j,n=j,t=V(),null!==t?(e=q(),null!==e?t=[t,e]:(t=null,j=n)):(t=null,j=n),null!==t&&(t=function(t,e,i){return e+i}(i,t[0],t[1])),null===t&&(j=i)),t}function F(){var e,i,s,r,o;return r=j,o=j,e=V(),e=null!==e?e:"",null!==e?(46===t.charCodeAt(j)?(i=".",j++):(i=null,0===J&&n('"."')),null!==i?(s=V(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)):(e=null,j=o),null!==e&&(e=function(t,e,i){return e+"."+i}(r,e[0],e[2])),null===e&&(j=r),null===e&&(r=j,o=j,e=V(),null!==e?(46===t.charCodeAt(j)?(i=".",j++):(i=null,0===J&&n('"."')),null!==i?e=[e,i]:(e=null,j=o)):(e=null,j=o),null!==e&&(e=function(t,e){return e}(r,e[0])),null===e&&(j=r)),e}function q(){var e,i,s,r,o;return r=j,o=j,101===t.charCodeAt(j)?(e="e",j++):(e=null,0===J&&n('"e"')),null===e&&(69===t.charCodeAt(j)?(e="E",j++):(e=null,0===J&&n('"E"'))),null!==e?(i=H(),i=null!==i?i:"",null!==i?(s=V(),null!==s?e=[e,i,s]:(e=null,j=o)):(e=null,j=o)):(e=null,j=o),null!==e&&(e=function(t,e,i,n){return e+i+n}(r,e[0],e[1],e[2])),null===e&&(j=r),e}function H(){var e;return 43===t.charCodeAt(j)?(e="+",j++):(e=null,0===J&&n('"+"')),null===e&&(45===t.charCodeAt(j)?(e="-",j++):(e=null,0===J&&n('"-"'))),e}function V(){var t,e,i,n;return i=j,n=j,t=z(),null!==t?(e=V(),null!==e?t=[t,e]:(t=null,j=n)):(t=null,j=n),null!==t&&(t=function(t,e,i){return e+i}(i,t[0],t[1])),null===t&&(j=i),null===t&&(t=z()),t}function z(){var e;return/^[0-9]/.test(t.charAt(j))?(e=t.charAt(j),j++):(e=null,0===J&&n("[0-9]")),e}function X(){var e;return 32===t.charCodeAt(j)?(e=" ",j++):(e=null,0===J&&n('" "')),null===e&&(9===t.charCodeAt(j)?(e="	",j++):(e=null,0===J&&n('"\\t"')),null===e&&(13===t.charCodeAt(j)?(e="\r",j++):(e=null,0===J&&n('"\\r"')),null===e&&(10===t.charCodeAt(j)?(e="\n",j++):(e=null,0===J&&n('"\\n"'))))),e}function G(t){t.sort();for(var e=null,i=[],n=0;n<t.length;n++)t[n]!==e&&(i.push(t[n]),e=t[n]);return i}function U(){for(var e=1,i=1,n=!1,s=0;s<Math.max(j,Q);s++){var r=t.charAt(s);"\n"===r?(n||e++,i=1,n=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(e++,i=1,n=!0):(i++,n=!1)}return{line:e,column:i}}function W(t,e){var i=[{cmd:e?"moveToRelative":"moveTo",args:[t[0].x,t[0].y]}];if(t.length>1)for(var n=1;n<t.length;n++)i.push({cmd:e?"lineToRelative":"lineTo",args:[t[n].x,t[n].y]});return i}var K={svgPath:s,movetoDrawtoCommandGroups:r,movetoDrawtoCommandGroup:o,drawtoCommands:a,drawtoCommand:h,moveto:u,movetoArgumentSequence:l,closepath:c,lineto:d,linetoArgumentSequence:f,horizontalLineto:m,horizontalLinetoArgumentSequence:p,verticalLineto:g,verticalLinetoArgumentSequence:v,curveto:y,curvetoArgumentSequence:E,curvetoArgument:S,smoothCurveto:T,smoothCurvetoArgumentSequence:w,smoothCurvetoArgument:b,quadraticBezierCurveto:C,quadraticBezierCurvetoArgumentSequence:x,quadraticBezierCurvetoArgument:_,smoothQuadraticBezierCurveto:R,smoothQuadraticBezierCurvetoArgumentSequence:P,ellipticalArc:N,ellipticalArcArgumentSequence:I,ellipticalArcArgument:L,coordinatePair:A,nonnegativeNumber:M,number:O,flag:Y,commaWsp:B,comma:D,floatingPointConstant:k,fractionalConstant:F,exponent:q,sign:H,digitSequence:V,digit:z,wsp:X};if(void 0!==i){if(void 0===K[i])throw new Error("Invalid rule name: "+e(i)+".")}else i="svgPath";var j=0,J=0,Q=0,$=[],Z=K[i]();if(null===Z||j!==t.length){var te=Math.max(j,Q),ee=te<t.length?t.charAt(te):null,ie=U();throw new this.SyntaxError(G($),ee,te,ie.line,ie.column)}return Z},toSource:function(){return this._source}};var n=i.svgPath;return n.SyntaxError=function(t,i,n,s,r){function o(t,i){var n,s;switch(t.length){case 0:n="end of input";break;case 1:n=t[0];break;default:n=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return s=i?e(i):"end of input","Expected "+n+" but "+s+" found."}this.name="SyntaxError",this.expected=t,this.found=i,this.message=o(t,i),this.offset=n,this.line=s,this.column=r},n.SyntaxError.prototype=Error.prototype,n}),define("KITE/util/LineStyles",["require","ASSERT/assert","KITE/kite"],function(t){t("ASSERT/assert")("kite");var e=t("KITE/kite");e.LineStyles=function(t){void 0===t&&(t={}),this.lineWidth=void 0!==t.lineWidth?t.lineWidth:1,this.lineCap=void 0!==t.lineCap?t.lineCap:"butt",this.lineJoin=void 0!==t.lineJoin?t.lineJoin:"miter",this.lineDash=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset=void 0!==t.lineDashOffset?t.lineDashOffset:0,this.miterLimit=void 0!==t.miterLimit?t.miterLimit:10};var i=e.LineStyles;return i.prototype={constructor:i,equals:function(t){var e=this.lineWidth===t.lineWidth&&this.lineCap===t.lineCap&&this.lineJoin===t.lineJoin&&this.miterLimit===t.miterLimit&&this.lineDashOffset===t.lineDashOffset;if(!e)return!1;if(!this.lineDash!=!t.lineDash)return!1;if(this.lineDash){if(this.lineDash.length!==t.lineDash.length)return!1;for(var i=0;i<this.lineDash.length;i++)if(this.lineDash[i]!==t.lineDash[i])return!1;return!0}return!0}},e.LineStyles}),define("KITE/segments/Quadratic",["require","ASSERT/assert","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Matrix3","DOT/Util","KITE/segments/Segment"],function(t){var e=t("ASSERT/assert")("kite");t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),s=t("DOT/Matrix3"),r=t("DOT/Util").solveQuadraticRootsReal,o=t("KITE/segments/Segment");return o.Quadratic=function(t,i,s,r){if(this.start=t,this.control=i,this.end=s,t.equals(s)&&t.equals(i))return this.invalid=!0,void 0;var o;if(!r){var a=t.equals(i),h=s.equals(i);e&&e(!a||!h),this.startTangent=a?s.minus(t).normalized():i.minus(t).normalized(),this.endTangent=h?s.minus(t).normalized():s.minus(i).normalized(),this.bounds=new n(Math.min(t.x,s.x),Math.min(t.y,s.y),Math.max(t.x,s.x),Math.max(t.y,s.y));var u=2*(s.x-2*i.x+t.x);0!==u&&(this.tCriticalX=-2*(i.x-t.x)/u,o>0&&1>o&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCriticalX))));var l=2*(s.y-2*i.y+t.y);0!==l&&(this.tCriticalY=-2*(i.y-t.y)/l,o>0&&1>o&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCriticalY))))}},i(o,o.Quadratic,{degree:2,positionAt:function(t){var e=1-t;return this.start.times(e*e).plus(this.control.times(2*e*t)).plus(this.end.times(t*t))},tangentAt:function(t){return this.control.minus(this.start).times(2*(1-t)).plus(this.end.minus(this.control).times(2*t))},curvatureAt:function(t){var e=1e-7;if(Math.abs(t-.5)>.5-e){var i=.5>t,n=i?this.start:this.end,s=this.control,r=i?this.end:this.start,o=s.minus(n),a=o.magnitude(),h=(i?-1:1)*o.perpendicular().normalized().dot(r.minus(s));return h*(this.degree-1)/(this.degree*a*a)}return this.subdivided(t,!0)[0].curvatureAt(1)},offsetTo:function(t,e){for(var i=[this],n=5,s=0;n>s;s++)i=_.flatten(_.map(i,function(t){return t.subdivided(.5,!0)}));var r=_.map(i,function(e){return e.approximateOffset(t)});return e&&(r.reverse(),r=_.map(r,function(t){return t.reversed(!0)})),r},subdivided:function(t,e){var i=this.start.blend(this.control,t),n=this.control.blend(this.end,t),s=i.blend(n,t);return[new o.Quadratic(this.start,i,s,e),new o.Quadratic(s,n,this.end,e)]},reversed:function(){return new o.Quadratic(this.end,this.control,this.start)
},approximateOffset:function(t){return new o.Quadratic(this.start.plus((this.start.equals(this.control)?this.end.minus(this.start):this.control.minus(this.start)).perpendicular().normalized().times(t)),this.control.plus(this.end.minus(this.start).perpendicular().normalized().times(t)),this.end.plus((this.end.equals(this.control)?this.end.minus(this.start):this.end.minus(this.control)).perpendicular().normalized().times(t)))},getSVGPathFragment:function(){return"Q "+this.control.x+" "+this.control.y+" "+this.end.x+" "+this.end.y},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=[],e=1e-10;return void 0!==this.tCriticalX&&this.tCriticalX>e&&this.tCriticalX<1-e&&t.push(this.tCriticalX),void 0!==this.tCriticalY&&this.tCriticalY>e&&this.tCriticalY<1-e&&t.push(this.tCriticalY),t.sort()},intersectsBounds:function(){throw new Error("Segment.Quadratic.intersectsBounds unimplemented")},intersection:function(t){var e=this,i=[],n=s.rotation2(-t.dir.angle()).timesMatrix(s.translation(-t.pos.x,-t.pos.y)),o=n.timesVector2(this.start),a=n.timesVector2(this.control),h=n.timesVector2(this.end),u=o.y-2*a.y+h.y,l=-2*o.y+2*a.y,c=o.y,d=r(u,l,c);return _.each(d,function(n){if(n>=0&&1>=n){var s=e.positionAt(n),r=e.tangentAt(n).normalized(),o=r.perpendicular(),a=s.minus(t.pos);a.dot(t.dir)>0&&i.push({distance:a.magnitude(),point:s,normal:o.dot(t.dir)>0?o.negated():o,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),i},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.quadraticCurveTo(this.control.x,this.control.y,this.end.x,this.end.y)},transformed:function(t){return new o.Quadratic(t.timesVector2(this.start),t.timesVector2(this.control),t.timesVector2(this.end))}}),o.Quadratic}),define("KITE/segments/Cubic",["require","ASSERT/assert","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Vector2","DOT/Matrix3","DOT/Util","DOT/Util","KITE/segments/Segment","KITE/segments/Quadratic"],function(t){t("ASSERT/assert")("kite"),t("KITE/kite");var e=t("PHET_CORE/inherit"),i=t("DOT/Bounds2"),n=t("DOT/Vector2"),s=t("DOT/Matrix3"),r=t("DOT/Util").solveQuadraticRootsReal,o=t("DOT/Util").solveCubicRootsReal,a=t("KITE/segments/Segment");return t("KITE/segments/Quadratic"),a.Cubic=function(t,e,n,s,o){function h(t,e,i,n){var s=-3*t+9*e-9*i+3*n,o=6*t-12*e+6*i,a=-3*t+3*e;return r(s,o,a)}if(this.start=t,this.control1=e,this.control2=n,this.end=s,!o){if(t.equals(s,0)&&t.equals(e,0)&&t.equals(n,0))return this.invalid=!0,void 0;this.startTangent=this.tangentAt(0).normalized(),this.endTangent=this.tangentAt(1).normalized(),this.r=e.minus(t).normalized(),this.s=this.r.perpendicular();var u=t.times(-1).plus(e.times(3)).plus(n.times(-3)).plus(s),l=t.times(3).plus(e.times(-6)).plus(n.times(3)),c=t.times(-3).plus(e.times(3)),d=u.perpendicular(),f=l.perpendicular(),m=d.dot(l);if(this.tCusp=-.5*(d.dot(c)/m),this.tDeterminant=this.tCusp*this.tCusp-1/3*(f.dot(c)/m),this.tDeterminant>=0){var p=Math.sqrt(this.tDeterminant);this.tInflection1=this.tCusp-p,this.tInflection2=this.tCusp+p}if(this.hasCusp()){var g=this.subdivided(this.tCusp,!0);this.startQuadratic=new a.Quadratic(g[0].start,g[0].control1,g[0].end,!1),this.endQuadratic=new a.Quadratic(g[1].start,g[1].control2,g[1].end,!1)}this.bounds=i.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var v=this;this.xExtremaT=h(this.start.x,this.control1.x,this.control2.x,this.end.x),_.each(this.xExtremaT,function(t){t>=0&&1>=t&&(v.bounds=v.bounds.withPoint(v.positionAt(t)))}),this.yExtremaT=h(this.start.y,this.control1.y,this.control2.y,this.end.y),_.each(this.yExtremaT,function(t){t>=0&&1>=t&&(v.bounds=v.bounds.withPoint(v.positionAt(t)))}),this.hasCusp()&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCusp)))}},e(a,a.Cubic,{degree:3,hasCusp:function(){var t=1e-6;return this.tangentAt(this.tCusp).magnitude()<t&&this.tCusp>=0&&this.tCusp<=1},positionAt:function(t){var e=1-t;return this.start.times(e*e*e).plus(this.control1.times(3*e*e*t)).plus(this.control2.times(3*e*t*t)).plus(this.end.times(t*t*t))},tangentAt:function(t){var e=1-t;return this.start.times(-3*e*e).plus(this.control1.times(3*e*e-6*e*t)).plus(this.control2.times(6*e*t-3*t*t)).plus(this.end.times(3*t*t))},curvatureAt:function(t){var e=1e-7;if(Math.abs(t-.5)>.5-e){var i=.5>t,n=i?this.start:this.end,s=i?this.control1:this.control2,r=i?this.control2:this.control1,o=s.minus(n),a=o.magnitude(),h=(i?-1:1)*o.perpendicular().normalized().dot(r.minus(s));return h*(this.degree-1)/(this.degree*a*a)}return this.subdivided(t,!0)[0].curvatureAt(1)},toRS:function(t){var e=t.minus(this.start);return new n(e.dot(this.r),e.dot(this.s))},subdivided:function(t,e){var i=this.start.blend(this.control1,t),n=this.control2.blend(this.end,t),s=this.control1.blend(this.control2,t),r=i.blend(s,t),o=s.blend(n,t),h=r.blend(o,t);return[new a.Cubic(this.start,i,r,h,e),new a.Cubic(h,o,n,this.end,e)]},offsetTo:function(t,e){for(var i=32,n=[],s=[],r=0;i>r;r++){var o=r/(i-1);e&&(o=1-o),n.push(this.positionAt(o).plus(this.tangentAt(o).perpendicular().normalized().times(t))),r>0&&s.push(new a.Line(n[r-1],n[r]))}return s},getSVGPathFragment:function(){return"C "+this.control1.x+" "+this.control1.y+" "+this.control2.x+" "+this.control2.y+" "+this.end.x+" "+this.end.y},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this.xExtremaT.concat(this.yExtremaT),e=[];return _.each(t,function(t){var i=1e-10;t>i&&1-i>t&&_.every(e,function(e){return Math.abs(t-e)>i})&&e.push(t)}),e.sort()},intersectsBounds:function(){throw new Error("Segment.Cubic.intersectsBounds unimplemented")},intersection:function(t){var e=this,i=[],n=s.rotation2(-t.dir.angle()).timesMatrix(s.translation(-t.pos.x,-t.pos.y)),r=n.timesVector2(this.start),a=n.timesVector2(this.control1),h=n.timesVector2(this.control2),u=n.timesVector2(this.end),l=-r.y+3*a.y-3*h.y+u.y,c=3*r.y-6*a.y+3*h.y,d=-3*r.y+3*a.y,f=r.y,m=o(l,c,d,f);return _.each(m,function(n){if(n>=0&&1>=n){var s=e.positionAt(n),r=e.tangentAt(n).normalized(),o=r.perpendicular(),a=s.minus(t.pos);a.dot(t.dir)>0&&i.push({distance:a.magnitude(),point:s,normal:o.dot(t.dir)>0?o.negated():o,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),i},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.bezierCurveTo(this.control1.x,this.control1.y,this.control2.x,this.control2.y,this.end.x,this.end.y)},transformed:function(t){return new a.Cubic(t.timesVector2(this.start),t.timesVector2(this.control1),t.timesVector2(this.control2),t.timesVector2(this.end))}}),a.Cubic}),define("KITE/segments/EllipticalArc",["require","ASSERT/assert","KITE/kite","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/segments/Segment","KITE/util/Subpath"],function(t){var e=t("ASSERT/assert")("kite");t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),s=t("DOT/Bounds2"),r=t("DOT/Matrix3"),o=t("DOT/Transform3"),a=t("DOT/Util").toDegrees,h=t("DOT/Util"),u=t("KITE/segments/Segment");return t("KITE/util/Subpath"),u.EllipticalArc=function(t,i,r,o,a,h,l){function c(t){f.containsAngle(t)&&(f.bounds=f.bounds.withPoint(f.positionAtAngle(t)))}if(0>i&&(i=-i,a=Math.PI-a,h=Math.PI-h,l=!l),0>r&&(r=-r,a=-a,h=-h,l=!l),r>i){o+=Math.PI/2,a-=Math.PI/2,h-=Math.PI/2;var d=i;i=r,r=d}if(this.center=t,this.radiusX=i,this.radiusY=r,this.rotation=o,this.startAngle=a,this.endAngle=h,this.anticlockwise=l,this.unitTransform=u.EllipticalArc.computeUnitTransform(t,i,r,o),this.start=this.positionAtAngle(a),this.end=this.positionAtAngle(h),this.startTangent=this.tangentAtAngle(a).normalized(),this.endTangent=this.tangentAtAngle(h).normalized(),0===i||0===r||a===h)return this.invalid=!0,void 0;if(r>i)throw new Error("Not verified to work if radiusX < radiusY");this.actualEndAngle=this.anticlockwise?this.startAngle>this.endAngle?this.endAngle:this.startAngle<this.endAngle?this.endAngle-2*Math.PI:this.startAngle:this.startAngle<this.endAngle?this.endAngle:this.startAngle>this.endAngle?this.endAngle+2*Math.PI:this.startAngle,e&&e(!(!l&&h-a<=2*-Math.PI||l&&a-h<=2*-Math.PI),"Not handling elliptical arcs with start/end angles that show differences in-between browser handling"),e&&e(!(!l&&h-a>2*Math.PI||l&&a-h>2*Math.PI),"Not handling elliptical arcs with start/end angles that show differences in-between browser handling"),!l&&h-a>=2*Math.PI||l&&a-h>=2*Math.PI,this.angleDifference=this.anticlockwise?this.startAngle-this.endAngle:this.endAngle-this.startAngle,this.angleDifference<0&&(this.angleDifference+=2*Math.PI),e&&e(this.angleDifference>=0),this.unitArcSegment=new u.Arc(n.ZERO,1,a,h,l),this.bounds=s.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var f=this;if(a!==h){var m=Math.atan(-(r/i)*Math.tan(o)),p=Math.atan(r/i/Math.tan(o));this.possibleExtremaAngles=[m,m+Math.PI,p,p+Math.PI],_.each(this.possibleExtremaAngles,c)}},i(u,u.EllipticalArc,{mapAngle:function(t){return this.startAngle>this.actualEndAngle?h.moduloBetweenUp(t,this.startAngle-2*Math.PI,this.startAngle):h.moduloBetweenDown(t,this.startAngle,this.startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this.startAngle)/(this.actualEndAngle-this.startAngle)},angleAt:function(t){return this.startAngle+(this.actualEndAngle-this.startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){var e=this.angleAt(t),i=this.radiusX*Math.sin(e),n=this.radiusY*Math.cos(e),s=Math.pow(n*n+i*i,1.5);return(this.anticlockwise?-1:1)*this.radiusX*this.radiusY/s},positionAtAngle:function(t){return this.unitTransform.transformPosition2(n.createPolar(1,t))},tangentAtAngle:function(t){var e=this.unitTransform.transformNormal2(n.createPolar(1,t));return this.anticlockwise?e.perpendicular():e.perpendicular().negated()},containsAngle:function(t){var e=this.anticlockwise?t-this.endAngle:t-this.startAngle,i=e%(2*Math.PI);return 0>i&&(i+=2*Math.PI),i<=this.angleDifference},offsetTo:function(t,e){for(var i=32,n=[],s=[],r=0;i>r;r++){var o=r/(i-1);e&&(o=1-o);var a=this.angleAt(o);n.push(this.positionAtAngle(a).plus(this.tangentAtAngle(a).perpendicular().normalized().times(t))),r>0&&s.push(new u.Line(n[r-1],n[r]))}return s},getSVGPathFragment:function(){var t,e=.01,i=this.anticlockwise?"0":"1",n=a(this.rotation);if(this.angleDifference<2*Math.PI-e)return t=this.angleDifference<Math.PI?"0":"1","A "+this.radiusX+" "+this.radiusY+" "+n+" "+t+" "+i+" "+this.end.x+" "+this.end.y;var s=(this.startAngle+this.endAngle)/2,r=this.positionAtAngle(s);t="0";var o="A "+this.radiusX+" "+this.radiusY+" "+n+" "+t+" "+i+" "+r.x+" "+r.y,h="A "+this.radiusX+" "+this.radiusY+" "+n+" "+t+" "+i+" "+this.end.x+" "+this.end.y;return o+" "+h},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this,e=[];return _.each(this.possibleExtremaAngles,function(i){if(t.containsAngle(i)){var n=t.tAtAngle(i),s=1e-10;n>s&&1-s>n&&e.push(n)}}),e.sort()},subdivided:function(t){var e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new u.EllipticalArc(this.center,this.radiusX,this.radiusY,this.rotation,e,i,this.anticlockwise),new u.EllipticalArc(this.center,this.radiusX,this.radiusY,this.rotation,i,n,this.anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.EllipticalArc.intersectsBounds unimplemented")},intersection:function(t){var e=this.unitTransform,i=e.inverseRay2(t),n=this.unitArcSegment.intersection(i);return _.map(n,function(i){var n=e.transformPosition2(i.point);return{distance:t.pos.distance(n),point:n,normal:e.inverseNormal2(i.normal),wind:i.wind}})},windingIntersection:function(t){var e=this.unitTransform.inverseRay2(t);return this.unitArcSegment.windingIntersection(e)},writeToContext:function(t){t.ellipse?t.ellipse(this.center.x,this.center.y,this.radiusX,this.radiusY,this.rotation,this.startAngle,this.endAngle,this.anticlockwise):(this.unitTransform.getMatrix().canvasAppendTransform(t),t.arc(0,0,1,this.startAngle,this.endAngle,this.anticlockwise),this.unitTransform.getInverse().canvasAppendTransform(t))},transformed:function(t){var e=t.timesVector2(n.createPolar(this.radiusX,this.rotation)).minus(t.timesVector2(n.ZERO)),i=t.timesVector2(n.createPolar(this.radiusY,this.rotation+Math.PI/2)).minus(t.timesVector2(n.ZERO)),s=e.angle(),r=e.magnitude(),o=i.magnitude(),a=t.getDeterminant()<0,h=a?!this.anticlockwise:this.anticlockwise,l=a?-this.startAngle:this.startAngle,c=a?-this.endAngle:this.endAngle;return new u.EllipticalArc(t.timesVector2(this.center),r,o,s,l,c,h)}}),u.EllipticalArc.computeUnitTransform=function(t,e,i,n){return new o(r.translation(t.x,t.y).timesMatrix(r.rotation2(n)).timesMatrix(r.scaling(e,i)))},u.EllipticalArc}),define("KITE/Shape",["require","ASSERT/assert","ASSERT/assert","KITE/kite","DOT/Vector2","DOT/Bounds2","DOT/Ray2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/util/Subpath","KITE/../parser/svgPath","KITE/util/LineStyles","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic"],function(t){function e(t,e){return new r(t,e)}function i(t,e){return new r(t,e)}var n=t("ASSERT/assert")("kite");t("ASSERT/assert")("kite.extra",!0);var s=t("KITE/kite"),r=t("DOT/Vector2"),o=t("DOT/Bounds2"),a=t("DOT/Ray2");t("DOT/Matrix3"),t("DOT/Transform3"),t("DOT/Util").toDegrees,t("DOT/Util").lineLineIntersection;var h=t("KITE/util/Subpath"),u=t("KITE/../parser/svgPath");t("KITE/util/LineStyles"),t("KITE/segments/Arc"),t("KITE/segments/Cubic"),t("KITE/segments/EllipticalArc"),t("KITE/segments/Line"),t("KITE/segments/Quadratic"),s.Shape=function c(t,e){this.subpaths="object"==typeof t?t:[],n&&n(0===this.subpaths.length||"Array"!==this.subpaths[0].constructor.name),this.bounds=e||o.NOTHING;var i=this;t&&"object"!=typeof t&&(n&&n("string"==typeof t,"if subpaths is not an object, it must be a string"),_.each(u.parse(t),function(t){n&&n(void 0!==c.prototype[t.cmd],"method "+t.cmd+" from parsed SVG does not exist"),i[t.cmd].apply(i,t.args)}))};var l=s.Shape;return l.prototype={constructor:l,moveTo:function(t,e){return this.moveToPoint(i(t,e))},moveToRelative:function(t,e){return this.moveToPointRelative(i(t,e))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new s.Subpath).addPoint(t))},lineTo:function(t,e){return this.lineToPoint(i(t,e))},lineToRelative:function(t,e){return this.lineToPointRelative(i(t,e))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){var e=this.getLastSubpath().getLastPoint(),i=t,r=new s.Segment.Line(e,i);this.getLastSubpath().addPoint(i),r.invalid||(this.getLastSubpath().addSegment(r),this.bounds=this.bounds.withPoint(e).withPoint(i),n&&n(!isNaN(this.bounds.getX())))}else this.ensure(t);return this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},quadraticCurveTo:function(t,e,n,s){return this.quadraticCurveToPoint(i(t,e),i(n,s))},quadraticCurveToRelative:function(t,e,n,s){return this.quadraticCurveToPointRelative(i(t,e),i(n,s))},quadraticCurveToPointRelative:function(t,e){var i=this.getRelativePoint();return this.quadraticCurveToPoint(i.plus(t),i.plus(e))},smoothQuadraticCurveTo:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),i(t,e))},smoothQuadraticCurveToRelative:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),i(t,e).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,e){this.ensure(t);var i=this.getLastSubpath().getLastPoint(),n=new s.Segment.Quadratic(i,t,e);return this.getLastSubpath().addPoint(e),n.invalid||(this.getLastSubpath().addSegment(n),this.bounds=this.bounds.union(n.bounds)),this},cubicCurveTo:function(t,e,n,s,r,o){return this.cubicCurveToPoint(i(t,e),i(n,s),i(r,o))},cubicCurveToRelative:function(t,e,n,s,r,o){return this.cubicCurveToPointRelative(i(t,e),i(n,s),i(r,o))},cubicCurveToPointRelative:function(t,e,i){var n=this.getRelativePoint();return this.cubicCurveToPoint(n.plus(t),n.plus(e),n.plus(i))},smoothCubicCurveTo:function(t,e,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),i(t,e),i(n,s))},smoothCubicCurveToRelative:function(t,e,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),i(t,e).plus(this.getRelativePoint()),i(n,s).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,e,i){this.ensure(t);var n=this.getLastSubpath().getLastPoint(),r=new s.Segment.Cubic(n,t,e,i);return r.invalid||(r.hasCusp()?(this.getLastSubpath().addSegment(r.startQuadratic),this.getLastSubpath().addSegment(r.endQuadratic)):this.getLastSubpath().addSegment(r),this.bounds=this.bounds.union(r.bounds)),this.getLastSubpath().addPoint(i),this},arc:function(t,e,n,s,r,o){return this.arcPoint(i(t,e),n,s,r,o)},arcPoint:function(t,e,i,n,r){var o=new s.Segment.Arc(t,e,i,n,r),a=o.start,h=o.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!a.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new s.Segment.Line(this.getLastSubpath().getLastPoint(),a)),this.hasSubpaths()||this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(a),this.getLastSubpath().addPoint(h),o.invalid||(this.getLastSubpath().addSegment(o),this.bounds=this.bounds.union(o.bounds)),this},ellipticalArc:function(t,e,n,s,r,o,a,h){return this.ellipticalArcPoint(i(t,e),n,s,r,o,a,h)},ellipticalArcPoint:function(t,e,i,n,r,o,a){var h=new s.Segment.EllipticalArc(t,e,i,n,r,o,a),u=h.start,l=h.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!u.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new s.Segment.Line(this.getLastSubpath().getLastPoint(),u)),this.hasSubpaths()||this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(u),this.getLastSubpath().addPoint(l),h.invalid||(this.getLastSubpath().addSegment(h),this.bounds=this.bounds.union(h.bounds)),this},close:function(){if(this.hasSubpaths()){var t=this.getLastSubpath(),e=new s.Subpath;t.close(),this.addSubpath(e),e.addPoint(t.getFirstPoint())}return this},ellipticalArcToRelative:function(t,e,i,n,s,r,o){var a=this.getRelativePoint();return this.ellipticalArcTo(t,e,i,n,s,r+a.x,o+a.y)},ellipticalArcTo:function(){throw new Error("ellipticalArcTo unimplemented")},circle:function(t,i,n){if("object"==typeof t){var s=t;return n=i,this.arcPoint(s,n,0,2*Math.PI,!1)}return this.arcPoint(e(t,i),n,0,2*Math.PI,!1)},ellipse:function(t,e,n,s,r){if("object"==typeof t){var o=t;return r=s,s=n,n=e,this.ellipticalArcPoint(o,n,s,r||0,0,2*Math.PI,!1)}return this.ellipticalArcPoint(i(t,e),n,s,r||0,0,2*Math.PI,!1)},rect:function(t,e,r,o){var a=new s.Subpath;return this.addSubpath(a),a.addPoint(i(t,e)),a.addPoint(i(t+r,e)),a.addPoint(i(t+r,e+o)),a.addPoint(i(t,e+o)),a.addSegment(new s.Segment.Line(a.points[0],a.points[1])),a.addSegment(new s.Segment.Line(a.points[1],a.points[2])),a.addSegment(new s.Segment.Line(a.points[2],a.points[3])),a.close(),this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(i(t,e)),this.bounds=this.bounds.withCoordinates(t,e).withCoordinates(t+r,e+o),n&&n(!isNaN(this.bounds.getX())),this},roundRect:function(t,e,i,n,s,r){var o=t+s,a=t+i-s,h=e+r,u=e+n-r;return s===r?this.arc(a,h,s,-Math.PI/2,0,!1).arc(a,u,s,0,Math.PI/2,!1).arc(o,u,s,Math.PI/2,Math.PI,!1).arc(o,h,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(a,h,s,r,0,-Math.PI/2,0,!1).ellipticalArc(a,u,s,r,0,0,Math.PI/2,!1).ellipticalArc(o,u,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(o,h,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},copy:function(){return new l(_.map(this.subpaths,function(t){return t.copy()}),this.bounds)},writeToContext:function(t){for(var e=this.subpaths.length,i=0;e>i;i++)this.subpaths[i].writeToContext(t)},getSVGPath:function(){for(var t=[],e=this.subpaths.length,i=0;e>i;i++){var s=this.subpaths[i];if(s.isDrawable()){var r=s.getFirstSegment().start;n&&n(r.equals(s.getFirstPoint(),1e-5));var o="M "+r.x+" "+r.y+" ";o+=_.map(s.segments,function(t){return t.getSVGPathFragment()}).join(" "),s.isClosed()&&(o+=" Z"),t.push(o)}}return t.join(" ")},transformed:function(t){var e=_.map(this.subpaths,function(e){return e.transformed(t)}),i=_.reduce(e,function(t,e){return t.union(e.computeBounds())},o.NOTHING);return new l(e,i)},computeBounds:function(t){return t?this.bounds.union(this.getStrokedShape(t).bounds):this.bounds},containsPoint:function(t){var e=new a(t,r.X_UNIT);return 0!==this.windingIntersection(e)},intersection:function(t){for(var e=[],i=this.subpaths.length,n=0;i>n;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++){var a=s.segments[o];e=e.concat(a.intersection(t))}s.hasClosingSegment()&&(e=e.concat(s.getClosingSegment().intersection(t)))}}return _.sortBy(e,function(t){return t.distance})},windingIntersection:function(t){for(var e=0,i=this.subpaths.length,n=0;i>n;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++)e+=s.segments[o].windingIntersection(t);s.hasClosingSegment()&&(e+=s.getClosingSegment().windingIntersection(t))}}return e},intersectsBounds:function(t){for(var e=this.subpaths.length,i=0;e>i;i++){var n=this.subpaths[i];if(n.isDrawable()){for(var s=n.segments.length,r=0;s>r;r++)if(n.segments[r].intersectsBounds(t))return!0;if(n.hasClosingSegment()&&n.getClosingSegment().intersectsBounds(t))return!0}}return!1},getStrokedShape:function(t){for(var e=[],i=o.NOTHING.copy(),n=this.subpaths.length,s=0;n>s;s++){var r=this.subpaths[s],a=r.stroked(t);e=e.concat(a)}for(n=e.length,s=0;n>s;s++)i.includeBounds(e[s].computeBounds());return new l(e,i)},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new h),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;var t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){var t=this.getLastPoint(),e=this.getLastSegment();return e&&e instanceof s.Segment.Quadratic?t.plus(t.minus(e.control)):t},getSmoothCubicControlPoint:function(){var t=this.getLastPoint(),e=this.getLastSegment();return e&&e instanceof s.Segment.Cubic?t.plus(t.minus(e.control2)):t},getRelativePoint:function(){var t=this.getLastPoint();return t?t:r.ZERO}},l.rectangle=function(t,e,i,n){return(new l).rect(t,e,i,n)},l.rect=l.rectangle,l.roundRect=function(t,e,i,n,s,r){return(new l).roundRect(t,e,i,n,s,r)},l.roundRectangle=l.roundRect,l.bounds=function(t){return(new l).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},l.lineSegment=function(t,e,i,n){return"number"==typeof t?(new l).moveTo(t,e).lineTo(i,n):(new l).moveToPoint(t).lineToPoint(e)},l.regularPolygon=function(t,e){var i=new l;return _.each(_.range(t),function(n){var s=r.createPolar(e,2*Math.PI*n/t);0===n?i.moveToPoint(s):i.lineToPoint(s)}),i.close()},l.circle=function(t,e,i){return void 0===e?(new l).circle(0,0,t):(new l).circle(t,e,i).close()},l.ellipse=function(t,e,i,n){return void 0===i?(new l).ellipse(0,0,t,e):(new l).ellipse(t,e,i,n).close()},l.arc=function(t,e,i,n,s,r){return(new l).arc(t,e,i,n,s,r)},l}),define("SCENERY/util/FixedNodeEvents",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery"),i=["selfBounds","childBounds","bounds","resize","boundsAccuracy"];e.FixedNodeEvents=function(t){var e=t.prototype;e.initializeNodeEvents=function(){this._events={};for(var t=this,e=i.length,n=0;e>n;n++)t._events[i[n]]=[]},e.addEventListener=function(t,e){return this._events[t].push(e),this},e.removeEventListener=function(t,e){return this._events[t].splice(_.indexOf(this._events[t],e),1),this},e.fireEvent=function(t,e){var i=this._events[t],n=i.length;if(n)for(var s=i.slice(0),r=0;n>r;r++)s[r](e)}};var n=e.FixedNodeEvents;return n}),define("SCENERY/layers/LayerStrategy",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.LayerStrategy={hasPreferredLayerType:function(t){return t.trail.lastNode().hasRenderer()},getPreferredLayerType:function(t,e){var i,n=t.trail.lastNode();return n.hasRendererLayerType()?i=n.getRendererLayerType():(i=e.bestPreferredLayerTypeFor([n.getRenderer()]),i||(i=n.getRenderer().defaultLayerType)),i},enter:function(t,e){var i,n=t.trail,s=n.lastNode();if(s.hasRenderer())i=this.getPreferredLayerType(t,e),e.pushPreferredLayerType(i),e.getCurrentLayerType()!==i&&e.switchToType(t,i);else if(s.isPainted()){var r=s._supportedRenderers,o=e.getCurrentLayerType();i=e.bestPreferredLayerTypeFor(r),i?o!==i&&e.switchToType(t,i):o&&o.supportsNode(s)||e.switchToType(t,r[0].defaultLayerType)}(s.isLayerSplitBefore()||this.hasSplitFlags(s))&&e.switchToType(t,e.getCurrentLayerType()),s.isPainted()&&e.markPainted(t)},exit:function(t,e){var i=t.trail,n=i.lastNode();n.hasRenderer()&&e.popPreferredLayerType(),(n.isLayerSplitAfter()||this.hasSplitFlags(n))&&e.switchToType(t,e.getCurrentLayerType())},hasSplitFlags:function(t){var e=t.getRendererOptions();return t.hasRenderer()&&e&&(e.cssTranslation||e.cssRotation||e.cssScale||e.cssTransform)}};var i=e.LayerStrategy;return i}),define("SCENERY/nodes/Node",["require","DOT/Bounds2","DOT/Transform3","DOT/Matrix3","DOT/Vector2","DOT/Util","KITE/Shape","SCENERY/scenery","SCENERY/util/FixedNodeEvents","SCENERY/layers/LayerStrategy"],function(t){var e=t("DOT/Bounds2"),i=t("DOT/Transform3"),n=t("DOT/Matrix3"),s=t("DOT/Vector2"),r=t("DOT/Util").clamp,o=(t("KITE/Shape"),t("SCENERY/scenery")),a=t("SCENERY/util/FixedNodeEvents"),h=t("SCENERY/layers/LayerStrategy"),u=1;o.Node=function(t){var n=this;this._id=u++,this._instances=[],this._visible=!0,this._opacity=1,this._pickable=!0,this._clipShape=null,this._mouseArea=null,this._touchArea=null,this._cursor=null,this._children=[],this._parents=[],this._peers=[],this._liveRegions=[],this._transform=new i,this._transformListener={before:function(){n.beforeTransformChange()},after:function(){n.afterTransformChange()}},this._transform.addTransformListener(this._transformListener),this._inputListeners=[],this.initializeNodeEvents(),this._includeStrokeInHitRegion=!1,this._bounds=e.NOTHING,this._selfBounds=e.NOTHING,this._childBounds=e.NOTHING,this._boundsDirty=!0,this._selfBoundsDirty=this.isPainted(),this._childBoundsDirty=!0,this._mouseBounds=null,this._mouseBoundsDirty=!0,this._touchBounds=null,this._touchBoundsDirty=!0,this._paintDirty=!1,this._subtreePaintDirty=!1,this._childPaintDirty=!1,this._renderer=null,this._rendererOptions=null,this._rendererLayerType=null,this._layerSplitBefore=!1,this._layerSplitAfter=!1,t&&this.mutate(t)};var l=o.Node;return l.prototype={constructor:l,insertChild:function(t,e){e._parents.push(this),this._children.splice(t,0,e),e.invalidateBounds(),this._boundsDirty=!0,this.markForInsertion(e,t),this.notifyStitch(!1),e.invalidateSubtreePaint()},addChild:function(t){this.insertChild(this._children.length,t)},removeChild:function(t){var e=_.indexOf(this._children,t);this.removeChildWithIndex(t,e)},removeChildAt:function(t){var e=this._children[t];this.removeChildWithIndex(e,t)},removeChildWithIndex:function(t,e){t.markOldPaint(!1);var i=_.indexOf(t._parents,this);this.markForRemoval(t,e),t._parents.splice(i,1),this._children.splice(e,1),this.invalidateBounds(),this._childBoundsDirty=!0,this.notifyStitch(!1)},removeAllChildren:function(){this.setChildren([])},setChildren:function(t){if(this._children!==t){for(;this._children.length;)this.removeChild(this._children[this._children.length-1]);for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])}},getChildren:function(){return this._children.slice(0)},getChildrenCount:function(){return this._children.length},getParents:function(){return this._parents.slice(0)},getChildAt:function(t){return this._children[t]},indexOfParent:function(t){return _.indexOf(this._parents,t)},indexOfChild:function(t){return _.indexOf(this._children,t)},moveToFront:function(){var t=this;_.each(this._parents.slice(0),function(e){e.moveChildToFront(t)})},moveChildToFront:function(t){this.indexOfChild(t)!==this._children.length-1&&(this.removeChild(t),this.addChild(t))},moveToBack:function(){var t=this;_.each(this._parents.slice(0),function(e){e.moveChildToBack(t)})},moveChildToBack:function(t){0!==this.indexOfChild(t)&&(this.removeChild(t),this.insertChild(0,t))},detach:function(){var t=this;_.each(this._parents.slice(0),function(e){e.removeChild(t)})},addPeer:function(t,e){this._peers.push({element:t,options:e})},addLiveRegion:function(t,e){this._liveRegions.push({property:t,options:e})},validateBounds:function(){var t;if(this._selfBoundsDirty&&(this._selfBoundsDirty=!1,this.fireEvent("selfBounds",this._selfBounds)),this._childBoundsDirty){for(t=this._children.length;t--;)this._children[t].validateBounds();var i=this._childBounds;for(this._childBounds=e.NOTHING.copy(),t=this._children.length;t--;)this._childBounds.includeBounds(this._children[t]._bounds);this._childBoundsDirty=!1,this._childBounds.equals(i)||this.fireEvent("childBounds",this._childBounds)}if(this._boundsDirty){this._boundsDirty=!1;var n=this._bounds,s=this.transformBoundsFromLocalToParent(this._selfBounds.copy().includeBounds(this._childBounds)),r=!s.equals(n);if(r){for(this._bounds=s,t=this._parents.length;t--;)this._parents[t].invalidateBounds();this.fireEvent("bounds",this._bounds)}}(this._selfBoundsDirty||this._childBoundsDirty||this._boundsDirty)&&this.validateBounds()},validateMouseBounds:function(){var t=this;if(this._mouseBoundsDirty){var e=!1;this._mouseBounds=this._selfBounds.copy();for(var i=this._children.length;i--;){var n=this._children[i];n.validateMouseBounds(),n._mouseBounds&&(e=!0,t._mouseBounds.includeBounds(n._mouseBounds))}this._mouseArea&&(e=!0,this._mouseBounds.includeBounds(this._mouseArea.bounds)),e?(this.transformBoundsFromLocalToParent(this._mouseBounds),this._mouseBounds.includeBounds(this._bounds)):this._mouseBounds=null,this._mouseBoundsDirty=!1}},validateTouchBounds:function(){var t=this;if(this._touchBoundsDirty){var e=!1;this._touchBounds=this._selfBounds.copy();for(var i=this._children.length;i--;){var n=this._children[i];n.validateTouchBounds(),n._touchBounds&&(e=!0,t._touchBounds.includeBounds(n._touchBounds))}this._touchArea&&(e=!0,this._touchBounds.includeBounds(this._touchArea.bounds)),e?(this.transformBoundsFromLocalToParent(this._touchBounds),this._touchBounds.includeBounds(this._bounds)):this._touchBounds=null,this._touchBoundsDirty=!1}},validatePaint:function(){if(this._paintDirty&&(this._subtreePaintDirty||this.notifyDirtySelfPaint(),this._paintDirty=!1),this._subtreePaintDirty&&(this.notifyDirtySubtreePaint(),this._subtreePaintDirty=!1),this._childPaintDirty){this._childPaintDirty=!1;for(var t=this._children,e=t.length,i=0;e>i;i++)t[i].validatePaint()}},invalidateBounds:function(){this._boundsDirty=!0,this._mouseBoundsDirty=!0,this._touchBoundsDirty=!0;for(var t=this._parents.length;t--;)this._parents[t].invalidateChildBounds()},invalidateChildBounds:function(){if(!this._childBoundsDirty){this._childBoundsDirty=!0,this._mouseBoundsDirty=!0,this._touchBoundsDirty=!0;for(var t=this._parents.length;t--;)this._parents[t].invalidateChildBounds()
}},invalidatePaint:function(){this._paintDirty=!0;for(var t=this._parents.length;t--;)this._parents[t].invalidateChildPaint()},invalidateSubtreePaint:function(){this._subtreePaintDirty=!0;for(var t=this._parents.length;t--;)this._parents[t].invalidateChildPaint()},invalidateChildPaint:function(){if(!this._childPaintDirty){this._childPaintDirty=!0;for(var t=this._parents.length;t--;)this._parents[t].invalidateChildPaint()}},invalidateSelf:function(t){this.notifyBeforeSelfChange(),this._selfBounds.equals(t)||(this._selfBoundsDirty=!0,this.invalidateBounds(),this._selfBounds=t),this.invalidatePaint()},markOldSelfPaint:function(){this.notifyBeforeSelfChange()},markLayerRefreshNeeded:function(){this.markForLayerRefresh(),this.notifyStitch(!0)},markOldPaint:function(t){t?this.notifyBeforeSelfChange():this.notifyBeforeSubtreeChange()},isChild:function(t){{var e=_.contains(this._children,t);_.contains(t._parents,this)}return e},getSelfBounds:function(){return this._selfBounds},getChildBounds:function(){return this.validateBounds(),this._childBounds},getBounds:function(){return this.validateBounds(),this._bounds},getVisibleBounds:function(){for(var t=this._selfBounds.copy(),e=this._children.length;e--;){var i=this._children[e];i.isVisible()&&t.includeBounds(i.getVisibleBounds())}return this.localToParentBounds(t)},trailUnderPointer:function(t){var e={};return t.isMouse&&(e.isMouse=!0),t.isTouch&&(e.isTouch=!0),t.isPen&&(e.isPen=!0),this.trailUnderPoint(t.point,e)},trailUnderPoint:function(t,e){void 0===e&&(e={});var i=void 0===e.pruneInvisible?!0:e.pruneInvisible,n=void 0===e.pruneUnpickable?!0:e.pruneUnpickable;if(i&&!this.isVisible())return null;if(n&&!this.isPickable())return null;this.validateBounds(),e.isMouse&&this.validateMouseBounds(),e.isTouch&&this.validateTouchBounds();var s=e&&(e.isMouse&&this._mouseBounds||e.isTouch&&this._touchBounds||e.isPen);if(s?e.isMouse&&!this._mouseBounds.containsPoint(t)||e.isTouch&&!this._touchBounds.containsPoint(t):!this._bounds.containsPoint(t))return null;var r=this.parentToLocalPoint(t);if(this._children.length>0&&(s||this._childBounds.containsPoint(r)))for(var a=this._children.length-1;a>=0;a--){var h=this._children[a],u=h.trailUnderPoint(r,e);if(u)return u.addAncestor(this,a),u}if(s){if(e.isMouse&&this._mouseArea)return this._mouseArea.containsPoint(r)?new o.Trail(this):null;if((e.isTouch||e.isPen)&&this._touchArea)return this._touchArea.containsPoint(r)?new o.Trail(this):null}return(s||this._selfBounds.containsPoint(r))&&this.containsPointSelf(r)?new o.Trail(this):null},containsPoint:function(t){return null!==this.trailUnderPoint(t)},containsPointSelf:function(t){return this._selfBounds.containsPoint(t)},intersectsBoundsSelf:function(t){return this._selfBounds.intersectsBounds(t)},isPainted:function(){return!1},hasParent:function(){return 0!==this._parents.length},hasChildren:function(){return this._children.length>0},walkDepthFirst:function(t){t(this);for(var e=this._children.length,i=0;e>i;i++)this._children[i].walkDepthFirst(t)},getChildrenWithinBounds:function(t){for(var e=[],i=this._children.length,n=0;i>n;n++){var s=this._children[n];s._bounds.intersection(t).isEmpty()||e.push(s)}return e},addInputListener:function(t){return-1===_.indexOf(this._inputListeners,t)&&this._inputListeners.push(t),this},removeInputListener:function(t){return this._inputListeners.splice(_.indexOf(this._inputListeners,t),1),this},getInputListeners:function(){return this._inputListeners.slice(0)},dispatchEvent:function(t,e){function i(r){n.addAncestor(r),r.fireEvent(t,e);var o=r._parents,a=o.length;s=s||a>1;for(var h=0;a>h;h++)i(o[h]);s&&n.removeAncestor()}var n=new o.Trail;n.setMutable(),e.trail=n;var s=!1;i(this)},translate:function(t,e,i){if("number"==typeof t){if(!t&&!e)return;i?this.prependTranslation(t,e):this.appendMatrix(n.translation(t,e))}else{var s=t;if(!s.x&&!s.y)return;this.translate(s.x,s.y,e)}},scale:function(t,e,i){if("number"==typeof t)if(void 0===e){if(1===t)return;this.appendMatrix(n.scaling(t,t))}else{if(1===t&&1===e)return;i?this.prependMatrix(n.scaling(t,e)):this.appendMatrix(n.scaling(t,e))}else{var s=t;this.scale(s.x,s.y,e)}},rotate:function(t,e){0!==t%(2*Math.PI)&&(e?this.prependMatrix(n.rotation2(t)):this.appendMatrix(n.rotation2(t)))},rotateAround:function(t,e){var i=n.translation(-t.x,-t.y);i=n.rotation2(e).timesMatrix(i),i=n.translation(t.x,t.y).timesMatrix(i),this.prependMatrix(i)},getX:function(){return this._transform.getMatrix().m02()},setX:function(t){return this.translate(t-this.getX(),0,!0),this},getY:function(){return this._transform.getMatrix().m12()},setY:function(t){return this.translate(0,t-this.getY(),!0),this},getScaleVector:function(){return this._transform.getMatrix().getScaleVector()},setScaleMagnitude:function(t,e){var i=this.getScaleVector();return"number"==typeof t?(void 0===e&&(e=t),this.appendMatrix(n.scaling(t/i.x,e/i.y))):this.appendMatrix(n.scaling(t.x/i.x,t.y/i.y)),this},getRotation:function(){return this._transform.getMatrix().getRotation()},setRotation:function(t){return this.appendMatrix(n.rotation2(t-this.getRotation())),this},setTranslation:function(t,e){var i,n,s=this._transform.getMatrix(),r=s.m02(),o=s.m12();return"number"==typeof t?(i=t-r,n=e-o):(i=t.x-r,n=t.y-o),this.translate(i,n,!0),this},getTranslation:function(){var t=this._transform.getMatrix();return new s(t.m02(),t.m12())},appendMatrix:function(t){this._transform.append(t)},prependMatrix:function(t){this._transform.prepend(t)},prependTranslation:function(t,e){this._transform.prependTranslation(t,e)},setMatrix:function(t){this._transform.set(t)},getMatrix:function(){return this._transform.getMatrix()},setTransform:function(t){this._transform!==t&&(this.beforeTransformChange(),this._transform.removeTransformListener(this._transformListener),this._transform=t,this._transform.prependTransformListener(this._transformListener),this.afterTransformChange())},getTransform:function(){return this._transform},resetTransform:function(){this.setMatrix(n.IDENTITY)},beforeTransformChange:function(){this.notifyBeforeSubtreeChange()},afterTransformChange:function(){this.notifyTransformChange(),this.invalidateBounds(),this.invalidateSubtreePaint()},getLeft:function(){return this.getBounds().minX},setLeft:function(t){return this.translate(t-this.getLeft(),0,!0),this},getRight:function(){return this.getBounds().maxX},setRight:function(t){return this.translate(t-this.getRight(),0,!0),this},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(t){return this.translate(t.minus(this.getCenter()),!0),this},getCenterX:function(){return this.getBounds().getCenterX()},setCenterX:function(t){return this.translate(t-this.getCenterX(),0,!0),this},getCenterY:function(){return this.getBounds().getCenterY()},setCenterY:function(t){return this.translate(0,t-this.getCenterY(),!0),this},getTop:function(){return this.getBounds().minY},setTop:function(t){return this.translate(0,t-this.getTop(),!0),this},getBottom:function(){return this.getBounds().maxY},setBottom:function(t){return this.translate(0,t-this.getBottom(),!0),this},getWidth:function(){return this.getBounds().getWidth()},getHeight:function(){return this.getBounds().getHeight()},getId:function(){return this._id},isVisible:function(){return this._visible},setVisible:function(t){return t!==this._visible&&(this._visible&&this.notifyBeforeSubtreeChange(),this._visible=t,this.notifyVisibilityChange()),this},getOpacity:function(){return this._opacity},setOpacity:function(t){var e=r(t,0,1);e!==this._opacity&&(this.notifyBeforeSubtreeChange(),this._opacity=e,this.notifyOpacityChange())},isPickable:function(){return this._pickable},setPickable:function(t){this._pickable!==t&&(this._pickable=t)},setCursor:function(t){this._cursor="auto"===t?null:t},getCursor:function(){return this._cursor},setMouseArea:function(t){this._mouseArea!==t&&(this._mouseArea=t,this.invalidateBounds())},getMouseArea:function(){return this._mouseArea},setTouchArea:function(t){this._touchArea!==t&&(this._touchArea=t,this.invalidateBounds())},getTouchArea:function(){return this._touchArea},updateLayerType:function(){this._renderer&&this._rendererOptions?(this._rendererOptions.cssTransform||this._rendererOptions.cssTranslation||this._rendererOptions.cssRotation||this._rendererOptions.cssScale?this._rendererOptions.baseNode=this:this._rendererOptions.hasOwnProperty("baseNode")&&delete this._rendererOptions.baseNode,this._rendererLayerType=this._renderer.createLayerType(this._rendererOptions)):this._rendererLayerType=null},getRendererLayerType:function(){return this._rendererLayerType},hasRendererLayerType:function(){return!!this._rendererLayerType},setRenderer:function(t){var e;if("string"==typeof t)e=o.Renderer[t];else if(t instanceof o.Renderer)e=t;else{if(t)throw new Error("unrecognized type of renderer: "+t);e=null}e!==this._renderer&&(this._renderer=e,this.updateLayerType(),this.markLayerRefreshNeeded())},getRenderer:function(){return this._renderer},hasRenderer:function(){return!!this._renderer},setRendererOptions:function(t){this._rendererOptions=t,this.updateLayerType(),this.markLayerRefreshNeeded()},getRendererOptions:function(){return this._rendererOptions},hasRendererOptions:function(){return!!this._rendererOptions},setLayerSplitBefore:function(t){this._layerSplitBefore!==t&&(this._layerSplitBefore=t,this.markLayerRefreshNeeded())},isLayerSplitBefore:function(){return this._layerSplitBefore},setLayerSplitAfter:function(t){this._layerSplitAfter!==t&&(this._layerSplitAfter=t,this.markLayerRefreshNeeded())},isLayerSplitAfter:function(){return this._layerSplitAfter},setLayerSplit:function(t){(t!==this._layerSplitBefore||t!==this._layerSplitAfter)&&(this._layerSplitBefore=t,this._layerSplitAfter=t,this.markLayerRefreshNeeded())},getUniqueTrail:function(){for(var t=new o.Trail,e=this;e;)t.addAncestor(e),e=e._parents[0];return t},getConnectedNodes:function(){for(var t=[],e=this._children.concat(this._parents).concat(this);e.length;){var i=e.pop();_.contains(t,i)||(t.push(i),e=e.concat(i._children,i._parents))}return t},getTopologicallySortedNodes:function(){function t(t){delete i[e.id][t.id],_.every(i,function(e){return!e[t.id]})&&n.push(t)}var e,i={},n=[],s=[];for(_.each(this.getConnectedNodes(),function(t){i[t.id]={},_.each(t.children,function(e){i[t.id][e.id]=!0}),t.parents.length||n.push(t)});n.length;)e=n.pop(),s.push(e),_.each(e.children,t);return s},canAddChild:function(t){function e(t){delete n[i.id][t.id],_.every(n,function(e){return!e[t.id]})&&s.push(t)}if(this===t||_.contains(this.children,t))return!1;var i,n={},s=[],r=[];for(_.each(this.getConnectedNodes().concat(t.getConnectedNodes()),function(e){n[e.id]={},_.each(e.children,function(t){n[e.id][t.id]=!0}),e.parents.length||e===t||s.push(e)}),n[this.id][t.id]=!0;s.length;)i=s.pop(),r.push(i),_.each(i.children,e),i===this&&e(t);return _.every(n,function(t){return _.every(t,function(){return!1})})},debugText:function(){var t=new o.TrailPointer(new o.Trail(this),!0),e=new o.TrailPointer(new o.Trail(this),!1),i=0;t.depthFirstUntil(e,function(t){if(t.isBefore){var e=new Array(2*i).join(" ");console.log(e+t.trail.lastNode().getId()+" "+t.trail.toString())}i+=t.isBefore?1:-1},!1)},toCanvas:function(t,e,i,n,s){var r=this,a=2,h=this.getBounds();e=void 0!==e?e:Math.ceil(a-h.minX),i=void 0!==i?i:Math.ceil(a-h.minY),n=void 0!==n?n:Math.ceil(e+h.getWidth()+a),s=void 0!==s?s:Math.ceil(i+h.getHeight()+a);var u=document.createElement("canvas");u.width=n,u.height=s;var l=u.getContext("2d"),c=$(document.createElement("div"));c.width(n).height(s);var d=new o.Scene(c);d.addChild(r),d.x=e,d.y=i,d.updateScene(),d.renderToCanvas(u,l,function(){t(u,e,i),d.removeChild(r)})},toDataURL:function(t,e,i,n,s){this.toCanvas(function(e,i,n){t(e.toDataURL(),i,n)},e,i,n,s)},toImage:function(t,e,i,n,s){this.toDataURL(function(e,i,n){var s=document.createElement("img");s.onload=function(){t(s,i,n);try{delete s.onload}catch(e){}},s.src=e},e,i,n,s)},toImageNodeAsynchronous:function(t,e,i,n,s){this.toImage(function(e,i,n){t(new o.Node({children:[new o.Image(e,{x:-i,y:-n})]}))},e,i,n,s)},toCanvasNodeSynchronous:function(t,e,i,n){var s;return this.toCanvas(function(t,e,i){s=new o.Node({children:[new o.Image(t,{x:-e,y:-i})]})},t,e,i,n),s},toDataURLNodeSynchronous:function(t,e,i,n){var s;return this.toDataURL(function(t,e,i){s=new o.Node({children:[new o.Image(t,{x:-e,y:-i})]})},t,e,i,n),s},getInstances:function(){return this._instances},addInstance:function(t){this._instances.push(t),1===this._instances.length&&this.firstInstanceAdded()},firstInstanceAdded:function(){},getInstanceFromTrail:function(t){var e,i=this._instances.length;if(1===i)e=this._instances[0];else for(var n=i;n--;)if(this._instances[n].trail.equals(t)){e=this._instances[n];break}return e},removeInstance:function(t){var e=_.indexOf(this._instances,t);this._instances.splice(e,1),0===this._instances.length&&this.lastInstanceRemoved()},lastInstanceRemoved:function(){},notifyVisibilityChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyVisibilityChange()},notifyOpacityChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyOpacityChange()},notifyBeforeSelfChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyBeforeSelfChange()},notifyBeforeSubtreeChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyBeforeSubtreeChange()},notifyDirtySelfPaint:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyDirtySelfPaint()},notifyDirtySubtreePaint:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyDirtySubtreePaint()},notifyTransformChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyTransformChange()},notifyBoundsAccuracyChange:function(){for(var t=this._instances.length;t--;)this._instances[t].notifyBoundsAccuracyChange()},notifyStitch:function(t){for(var e=this._instances.length;e--;)this._instances[e].notifyStitch(t)},markForLayerRefresh:function(){for(var t=this._instances.length;t--;)this._instances[t].markForLayerRefresh()},markForInsertion:function(t,e){for(var i=this._instances.length;i--;)this._instances[i].markForInsertion(t,e)},markForRemoval:function(t,e){for(var i=this._instances.length;i--;)this._instances[i].markForRemoval(t,e)},localToParentPoint:function(t){return this._transform.transformPosition2(t)},localToParentBounds:function(t){return this._transform.transformBounds2(t)},parentToLocalPoint:function(t){return this._transform.inversePosition2(t)},parentToLocalBounds:function(t){return this._transform.inverseBounds2(t)},transformBoundsFromLocalToParent:function(t){return t.transform(this._transform.getMatrix())},getLocalToGlobalMatrix:function(){for(var t=this,e=[];t;)e.push(t._transform.getMatrix()),t=t._parents[0];for(var i=new n,s=e.length-1;s>=0;s--)i.multiplyMatrix(e[s]);return i},getUniqueTransform:function(){return new i(this.getLocalToGlobalMatrix())},getGlobalToLocalMatrix:function(){return this.getLocalToGlobalMatrix().invert()},localToGlobalPoint:function(t){for(var e=this,i=t.copy();e;)e._transform.getMatrix().multiplyVector2(i),e=e._parents[0];return i},globalToLocalPoint:function(t){for(var e=this,i=[];e;)i.push(e._transform),e=e._parents[0];for(var n=t.copy(),s=i.length-1;s>=0;s--)i[s].getInverse().multiplyVector2(n);return n},localToGlobalBounds:function(t){return t.transformed(this.getLocalToGlobalMatrix())},globalToLocalBounds:function(t){return t.transformed(this.getGlobalToLocalMatrix())},parentToGlobalPoint:function(t){return this.parents.length?this.parents[0].localToGlobalPoint(t):t},parentToGlobalBounds:function(t){return this.parents.length?this.parents[0].localToGlobalBounds(t):t},globalToParentPoint:function(t){return this.parents.length?this.parents[0].globalToLocalPoint(t):t},globalToParentBounds:function(t){return this.parents.length?this.parents[0].globalToLocalBounds(t):t},getGlobalBounds:function(){return this.parentToGlobalBounds(this.getBounds())},boundsOf:function(t){return this.globalToLocalBounds(t.getGlobalBounds())},boundsTo:function(t){return t.globalToLocalBounds(this.getGlobalBounds())},set layerSplit(t){this.setLayerSplit(t)},get layerSplit(){throw new Error("You can't get a layerSplit property, since it modifies two separate properties")},set layerSplitBefore(t){this.setLayerSplitBefore(t)},get layerSplitBefore(){return this.isLayerSplitBefore()},set layerSplitAfter(t){this.setLayerSplitAfter(t)},get layerSplitAfter(){return this.isLayerSplitAfter()},set renderer(t){this.setRenderer(t)},get renderer(){return this.getRenderer()},set rendererOptions(t){this.setRendererOptions(t)},get rendererOptions(){return this.getRendererOptions()},set cursor(t){this.setCursor(t)},get cursor(){return this.getCursor()},set mouseArea(t){this.setMouseArea(t)},get mouseArea(){return this.getMouseArea()},set touchArea(t){this.setTouchArea(t)},get touchArea(){return this.getTouchArea()},set visible(t){this.setVisible(t)},get visible(){return this.isVisible()},set opacity(t){this.setOpacity(t)},get opacity(){return this.getOpacity()},set pickable(t){this.setPickable(t)},get pickable(){return this.isPickable()},set transform(t){this.setTransform(t)},get transform(){return this.getTransform()},set matrix(t){this.setMatrix(t)},get matrix(){return this.getMatrix()},set translation(t){this.setTranslation(t)},get translation(){return this.getTranslation()},set rotation(t){this.setRotation(t)},get rotation(){return this.getRotation()},set x(t){this.setX(t)},get x(){return this.getX()},set y(t){this.setY(t)},get y(){return this.getY()},set left(t){this.setLeft(t)},get left(){return this.getLeft()},set right(t){this.setRight(t)},get right(){return this.getRight()},set top(t){this.setTop(t)},get top(){return this.getTop()},set bottom(t){this.setBottom(t)},get bottom(){return this.getBottom()},set center(t){this.setCenter(t)},get center(){return this.getCenter()},set centerX(t){this.setCenterX(t)},get centerX(){return this.getCenterX()},set centerY(t){this.setCenterY(t)},get centerY(){return this.getCenterY()},set children(t){this.setChildren(t)},get children(){return this.getChildren()},get parents(){return this.getParents()},get width(){return this.getWidth()},get height(){return this.getHeight()},get bounds(){return this.getBounds()},get selfBounds(){return this.getSelfBounds()},get childBounds(){return this.getChildBounds()},get globalBounds(){return this.getGlobalBounds()},get visibleBounds(){return this.getVisibleBounds()},get id(){return this.getId()},get instances(){return this.getInstances()},mutate:function(t){var e=this;return _.each(this._mutatorKeys,function(i){if(void 0!==t[i]){var n=Object.getOwnPropertyDescriptor(l.prototype,i);n&&"function"==typeof n.value?e[i](t[i]):e[i]=t[i]}}),this},toString:function(t,e){t=t||"";var i=this.getPropString(t+"  ",void 0===e?!0:e);return t+this.getBasicConstructor(i?"\n"+i+"\n"+t:"")},getBasicConstructor:function(t){return"new scenery.Node( {"+t+"} )"},getPropString:function(t,e){function i(e,i,s){n&&(n+=",\n"),n+=s||"string"!=typeof i?t+e+": "+i:t+e+": '"+i+"'"}var n="";if(this._children.length&&e){var s="";_.each(this._children,function(e){s&&(s+=",\n"),s+=e.toString(t+"  ")}),i("children","[\n"+s+"\n"+t+"]",!0)}if(this.cursor&&i("cursor",this.cursor),this.visible||i("visible",this.visible),this.pickable||i("pickable",this.pickable),1!==this.opacity&&i("opacity",this.opacity),!this.transform.isIdentity()){var r=this.transform.getMatrix();i("matrix","new dot.Matrix3( "+r.m00()+", "+r.m01()+", "+r.m02()+", "+r.m10()+", "+r.m11()+", "+r.m12()+", "+r.m20()+", "+r.m21()+", "+r.m22()+" )",!0)}return this.renderer&&(i("renderer",this.renderer.name),this.rendererOptions),this._layerSplitBefore&&i("layerSplitBefore",!0),this._layerSplitAfter&&i("layerSplitAfter",!0),n}},l.prototype._mutatorKeys=["children","cursor","visible","pickable","opacity","matrix","translation","x","y","rotation","scale","left","right","top","bottom","center","centerX","centerY","renderer","rendererOptions","layerSplit","layerSplitBefore","layerSplitAfter","mouseArea","touchArea"],l.prototype._supportedRenderers=[],l.prototype.layerStrategy=h,a(l),l}),define("SCENERY/layers/LayerType",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.LayerType=function(t,e,i,n){this.Constructor=t,this.name=e,this.renderer=i,this.args=n};var i=e.LayerType;return i.prototype={constructor:i,supportsRenderer:function(t){return this.renderer===t},supportsNode:function(t){for(var e=t._supportedRenderers,i=e.length;i--;)if(this.supportsRenderer(e[i]))return!0;return!1},createLayer:function(t){var e=this.Constructor;return new e(_.extend({},t,this.args))}},i}),define("SCENERY/util/Trail",["require","DOT/Matrix3","DOT/Transform3","SCENERY/scenery","SCENERY/nodes/Node"],function(t){var e=t("DOT/Matrix3"),i=t("DOT/Transform3"),n=t("SCENERY/scenery");t("SCENERY/nodes/Node"),n.Trail=function r(t){if(t instanceof r){var e=t;return this.nodes=e.nodes.slice(0),this.length=e.length,this.uniqueId=e.uniqueId,this.indices=e.indices.slice(0),void 0}this.nodes=[],this.length=0,this.uniqueId="",this.indices=[];var i=this;if(t)if(t instanceof n.Node){var s=t;i.addDescendant(s)}else for(var o=t.length,a=0;o>a;a++)i.addDescendant(t[a])};var s=n.Trail;return s.prototype={constructor:s,copy:function(){return new s(this)},isPainted:function(){return this.lastNode().isPainted()},isVisible:function(){for(var t=this.nodes.length;t--;)if(!this.nodes[t].isVisible())return!1;return!0},getOpacity:function(){for(var t=1,e=this.nodes.length;e--;)t*=this.nodes[e].getOpacity();return t},get:function(t){return t>=0?this.nodes[t]:this.nodes[this.nodes.length+t]},slice:function(t,e){return new s(this.nodes.slice(t,e))},subtrailTo:function(t,e){return this.slice(0,_.indexOf(this.nodes,t)+(e?0:1))},isEmpty:function(){return 0===this.nodes.length},getInstance:function(){return this.lastNode().getInstanceFromTrail(this)},getMatrix:function(){for(var t=new e,i=this.nodes,n=i.length,s=0;n>s;s++)t.multiplyMatrix(i[s]._transform.getMatrix());return t},getParentMatrix:function(){for(var t=new e,i=this.nodes,n=i.length,s=0;n-1>s;s++)t.multiplyMatrix(i[s]._transform.getMatrix());return t},getTransform:function(){return new i(this.getMatrix())},getParentTransform:function(){return new i(this.getParentMatrix())},addAncestor:function(t,e){if(this.nodes.length){var i=this.nodes[0];this.indices.unshift(void 0===e?_.indexOf(t._children,i):e)}return this.nodes.unshift(t),this.length++,this.uniqueId=this.uniqueId?t._id+"-"+this.uniqueId:t._id+"",this},removeAncestor:function(){return this.nodes.shift(),this.indices.length&&this.indices.shift(),this.length--,this.updateUniqueId(),this},addDescendant:function(t,e){if(this.nodes.length){var i=this.lastNode();this.indices.push(void 0===e?_.indexOf(i._children,t):e)}return this.nodes.push(t),this.length++,this.uniqueId=this.uniqueId?this.uniqueId+"-"+t._id:t._id+"",this},removeDescendant:function(){return this.nodes.pop(),this.indices.length&&this.indices.pop(),this.length--,this.updateUniqueId(),this},reindex:function(){for(var t=this.length,e=1;t>e;e++){var i=this.indices[e-1],n=this.nodes[e-1];n._children[i]!==this.nodes[e]&&(this.indices[e-1]=_.indexOf(n._children,this.nodes[e]))}},setImmutable:function(){return this},setMutable:function(){return this},areIndicesValid:function(){for(var t=1;t<this.length;t++){var e=this.indices[t-1];if(this.nodes[t-1]._children[e]!==this.nodes[t])return!1}return!0},equals:function(t){if(this.length!==t.length)return!1;for(var e=0;e<this.nodes.length;e++)if(this.nodes[e]!==t.nodes[e])return!1;return!0},upToNode:function(t){{_.indexOf(this.nodes,t)}return this.slice(0,_.indexOf(this.nodes,t)+1)},isExtensionOf:function(t,e){if(this.length<=t.length-(e?1:0))return!1;for(var i=0;i<t.nodes.length;i++)if(this.nodes[i]!==t.nodes[i])return!1;return!0},nodeFromTop:function(t){return this.nodes[this.length-1-t]},lastNode:function(){return this.nodeFromTop(0)},rootNode:function(){return this.nodes[0]},previous:function(){if(this.nodes.length<=1)return null;var t=this.nodeFromTop(0),e=this.nodeFromTop(1),i=_.indexOf(e._children,t),n=this.nodes.slice(0,this.nodes.length-1);if(0===i)return new s(n);for(n.push(e._children[i-1]);0!==n[n.length-1]._children.length;){var r=n[n.length-1];n.push(r._children[r._children.length-1])}return new s(n)},previousPainted:function(){for(var t=this.previous();t&&!t.isPainted();)t=t.previous();return t},next:function(){var t=this.nodes.slice(0),e=this.nodeFromTop(0);if(e._children.length>0)return t.push(e._children[0]),new s(t);for(var i=this.nodes.length-1;i>0;){var n=this.nodes[i],r=this.nodes[i-1];t.pop();var o=_.indexOf(r._children,n);if(o!==r._children.length-1)return t.push(r._children[o+1]),new s(t);i--}return null},nextPainted:function(){for(var t=this.next();t&&!t.isPainted();)t=t.next();return t},eachTrailUnder:function(t){new n.TrailPointer(this,!0).eachTrailBetween(new n.TrailPointer(this,!1),t)},compare:function(t){for(var e=Math.min(this.indices.length,t.indices.length),i=0;e>i;i++)if(this.indices[i]!==t.indices[i])return this.indices[i]<t.indices[i]?-1:1;return this.nodes.length<t.nodes.length?-1:this.nodes.length>t.nodes.length?1:0},isBefore:function(t){return-1===this.compare(t)},isAfter:function(t){return 1===this.compare(t)},localToGlobalPoint:function(t){return this.getMatrix().timesVector2(t)},localToGlobalBounds:function(t){return t.transformed(this.getMatrix())},globalToLocalPoint:function(t){return this.getTransform().inversePosition2(t)},globalToLocalBounds:function(t){return this.getTransform().inverseBounds2(t)},parentToGlobalPoint:function(t){return this.getParentMatrix().timesVector2(t)},parentToGlobalBounds:function(t){return t.transformed(this.getParentMatrix())},globalToParentPoint:function(t){return this.getParentTransform().inversePosition2(t)},globalToParentBounds:function(t){return this.getParentTransform().inverseBounds2(t)},updateUniqueId:function(){var t="",e=this.nodes.length;e>0&&(t+=this.nodes[0]._id);for(var i=1;e>i;i++)t+="-"+this.nodes[i]._id;this.uniqueId=t},getUniqueId:function(){return this.uniqueId},toString:function(){return this.reindex(),this.length?"[Trail "+this.indices.join(".")+" "+this.getUniqueId()+"]":"Empty Trail"}},s.eachPaintedTrailBetween=function(t,e,i,n,r){s.eachTrailBetween(t,e,function(t){t&&t.isPainted()&&i(t)},n,r)},s.eachTrailBetween=function(t,e,i,s,r){var o=t?new n.TrailPointer(t.copy(),!0):new n.TrailPointer(new n.Trail(r),!0),a=e?new n.TrailPointer(e.copy(),!0):new n.TrailPointer(new n.Trail(r),!1);s&&(o.nestedForwards(),a.nestedBackwards(),1===o.compareNested(a))||o.depthFirstUntil(a,function(t){t.isBefore&&i(t.trail)},!1)},s}),define("SCENERY/layers/Layer",["require","DOT/Bounds2","DOT/Transform3","SCENERY/scenery","SCENERY/util/Trail"],function(t){var e=t("DOT/Bounds2"),i=t("DOT/Transform3"),n=t("SCENERY/scenery");t("SCENERY/util/Trail");var s=1;n.Layer=function(t){this._id=s++,this.$main=t.$main,this.scene=t.scene,this.baseNode=t.baseNode,this.usesPartialCSSTransforms=t.cssTranslation||t.cssRotation||t.cssScale,this.cssTranslation=t.cssTranslation,this.cssRotation=t.cssRotation,this.cssScale=t.cssScale,this.cssTransform=t.cssTransform,this.dirtyBounds=e.EVERYTHING,this.setStartBoundary(t.startBoundary),this.setEndBoundary(t.endBoundary),this.baseTrail=this.baseNode===this.scene?new n.Trail(this.scene):this.startPaintedTrail.upToNode(this.baseNode),this._layerTrails=[],this._instanceCount=0;var r=this;this.baseNodeBoundsListener=function(){r.baseNodeInternalBoundsChange()},this.baseNode.addEventListener("selfBounds",this.baseNodeBoundsListener),this.baseNode.addEventListener("childBounds",this.baseNodeBoundsListener),this.fitToBounds=this.usesPartialCSSTransforms||this.cssTransform,this.baseNodeTransform=new i,this.disposed=!1};var r=n.Layer;return r.prototype={constructor:r,setStartBoundary:function(t){this.startBoundary=t,this.startPaintedTrail=this.startBoundary.nextPaintedTrail,this.startPaintedTrail.setImmutable()},setEndBoundary:function(t){this.endBoundary=t,this.endPaintedTrail=this.endBoundary.previousPaintedTrail,this.endPaintedTrail.setImmutable()},toString:function(){return this.getName()+" "+(this.startPaintedTrail?this.startPaintedTrail.toString():"!")+" => "+(this.endPaintedTrail?this.endPaintedTrail.toString():"!")},getId:function(){return this._id},get id(){return this._id},getLayerTrails:function(){return this._layerTrails.slice(0)},getPaintedTrailCount:function(){return this._layerTrails.length},render:function(){throw new Error("Layer.render unimplemented")},applyTransformationMatrix:function(){throw new Error("Layer.applyTransformationMatrix unimplemented")},addInstance:function(t){var e=t.trail;this._layerTrails.push(e),e.setImmutable()},removeInstance:function(t){var e;for(e=0;e<this._layerTrails.length&&(this._layerTrails[e].reindex(),0!==this._layerTrails[e].compare(t.trail));e++);this._layerTrails.splice(e,1)},reindex:function(){this.startBoundary.reindex(),this.endBoundary.reindex()},pushClipShape:function(){throw new Error("Layer.pushClipShape unimplemented")},popClipShape:function(){throw new Error("Layer.popClipShape unimplemented")},renderToCanvas:function(){throw new Error("Layer.renderToCanvas unimplemented")},dispose:function(){this.disposed=!0,this.baseNode.removeEventListener("selfBounds",this.baseNodeBoundsListener),this.baseNode.removeEventListener("childBounds",this.baseNodeBoundsListener)},getName:function(){throw new Error("Layer.getName unimplemented")},baseNodeInternalBoundsChange:function(){}},r.cssTransformPadding=3,r}),define("SCENERY/util/CanvasContextWrapper",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.CanvasContextWrapper=function(t,e){this.canvas=t,this.context=e,this.resetStyles()};var i=e.CanvasContextWrapper;return i.prototype={constructor:i,resetStyles:function(){this.fillStyle=void 0,this.strokeStyle=void 0,this.lineWidth=void 0,this.lineCap=void 0,this.lineJoin=void 0,this.lineDash=void 0,this.lineDashOffset=void 0,this.miterLimit=void 0,this.font=void 0,this.direction=void 0},setDimensions:function(t,e){this.canvas.width=t,this.canvas.height=e,this.resetStyles()},setFillStyle:function(t){this.fillStyle!==t&&(this.fillStyle=t,this.context.fillStyle=t&&t.getCanvasStyle?t.getCanvasStyle():t)},setStrokeStyle:function(t){this.strokeStyle!==t&&(this.strokeStyle=t,this.context.strokeStyle=t&&t.getCanvasStyle?t.getCanvasStyle():t)},setLineWidth:function(t){this.lineWidth!==t&&(this.lineWidth=t,this.context.lineWidth=t)},setLineCap:function(t){this.lineCap!==t&&(this.lineCap=t,this.context.lineCap=t)},setLineJoin:function(t){this.lineJoin!==t&&(this.lineJoin=t,this.context.lineJoin=t)},setLineDash:function(t){this.lineDash!==t&&(this.lineDash=t,this.context.setLineDash?this.context.setLineDash(null===t?[]:t):void 0!==this.context.mozDash?this.context.mozDash=t:void 0!==this.context.webkitLineDash&&(this.context.webkitLineDash=t?t:[]))},setLineDashOffset:function(t){this.lineDashOffset!==t&&(this.lineDashOffset=t,void 0!==this.context.lineDashOffset?this.context.lineDashOffset=t:void 0!==this.context.webkitLineDashOffset&&(this.context.webkitLineDashOffset=t))},setFont:function(t){this.font!==t&&(this.font=t,this.context.font=t)},setDirection:function(t){this.direction!==t&&(this.direction=t,this.context.direction=t)}},i}),define("SCENERY/util/TrailPointer",["require","SCENERY/scenery","SCENERY/util/Trail"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/Trail"),e.TrailPointer=function(t,e){this.trail=t,this.setBefore(e)};var i=e.TrailPointer;return i.prototype={constructor:i,copy:function(){return new i(this.trail.copy(),this.isBefore)},setBefore:function(t){this.isBefore=t,this.isAfter=!t},getRenderSwappedPointer:function(){var t=this.isBefore?this.trail.previous():this.trail.next();return null===t?null:new i(t,!this.isBefore)},getRenderBeforePointer:function(){return this.isBefore?this:this.getRenderSwappedPointer()},getRenderAfterPointer:function(){return this.isAfter?this:this.getRenderSwappedPointer()
},compareRender:function(t){var e=this.getRenderBeforePointer(),i=t.getRenderBeforePointer();return null!==e&&null!==i?e.trail.compare(i.trail):e===i?0:null===e?1:-1},compareNested:function(t){var e=this.trail.compare(t.trail);return 0===e?this.isBefore===t.isBefore?0:this.isBefore?-1:1:this.trail.isExtensionOf(t.trail)?t.isBefore?1:-1:t.trail.isExtensionOf(this.trail)?this.isBefore?-1:1:e},equalsRender:function(t){return 0===this.compareRender(t)},equalsNested:function(t){return 0===this.compareNested(t)},hasTrail:function(){return!!this.trail},nestedForwards:function(){if(this.isBefore)this.trail.lastNode()._children.length>0?this.trail.addDescendant(this.trail.lastNode()._children[0],0):this.setBefore(!1);else{if(0===this.trail.indices.length)return this.trail=null,null;var t=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant(),this.trail.lastNode()._children.length>t+1&&(this.trail.addDescendant(this.trail.lastNode()._children[t+1],t+1),this.setBefore(!0))}return this},nestedBackwards:function(){if(this.isBefore){if(0===this.trail.indices.length)return this.trail=null,null;var t=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant(),t-1>=0&&(this.trail.addDescendant(this.trail.lastNode()._children[t-1],t-1),this.setBefore(!1))}else if(this.trail.lastNode()._children.length>0){var e=this.trail.lastNode()._children;this.trail.addDescendant(e[e.length-1],e.length-1)}else this.setBefore(!0);return this},eachNodeBetween:function(t,e){this.eachTrailBetween(t,function(t){e(t.lastNode())})},eachTrailBetween:function(t,e){this.isBefore&&e(this.trail),this.depthFirstUntil(t,function(t){t.isBefore&&e(t.trail)},!0)},depthFirstUntil:function(t,e,i){this.trail.reindex(),t.trail.reindex();var n=this.copy();n.trail.setMutable();for(var s=!0;!n.equalsNested(t);){var r=!1;if(s?(i||(r=e(n)),s=!1):r=e(n),r&&n.isBefore){if(n.setBefore(!1),1===n.compareNested(t))break}else n.nestedForwards()}i||e(n)},toString:function(){return"["+(this.isBefore?"before":"after")+" "+this.trail.toString().slice(1)}},i}),define("SCENERY/layers/CanvasLayer",["require","PHET_CORE/inherit","DOT/Bounds2","SCENERY/scenery","KITE/Shape","SCENERY/layers/Layer","SCENERY/util/CanvasContextWrapper","SCENERY/util/Trail","SCENERY/util/TrailPointer","SCENERY/util/Util"],function(t){var e=t("PHET_CORE/inherit"),i=t("DOT/Bounds2"),n=t("SCENERY/scenery"),s=t("KITE/Shape"),r=t("SCENERY/layers/Layer");t("SCENERY/util/CanvasContextWrapper"),t("SCENERY/util/Trail"),t("SCENERY/util/TrailPointer"),t("SCENERY/util/Util");var o=[];n.CanvasLayer=function(t){r.call(this,t),this.backingScale=t.scene.backingScale,void 0!==t.fullResolution&&(this.backingScale=t.fullResolution?n.Util.backingScale(document.createElement("canvas").getContext("2d")):1),this.logicalWidth=this.scene.sceneBounds.width,this.logicalHeight=this.scene.sceneBounds.height;var e=document.createElement("canvas");e.width=this.logicalWidth*this.backingScale,e.height=this.logicalHeight*this.backingScale,e.style.width=this.logicalWidth+"px",e.style.height=this.logicalHeight+"px",e.style.position="absolute",e.style.left="0",e.style.top="0",this.$main.append(e),this.canvas=e,this.context=e.getContext("2d"),this.scene=t.scene,this.context.miterLimit=20,this.context.miterLimit=10,this.isCanvasLayer=!0,this.wrapper=new n.CanvasContextWrapper(this.canvas,this.context),this.boundlessCount=0};var a=n.CanvasLayer;return e(r,a,{render:function(t,e){e=e||{};var n=this.canUseDirtyRegions()&&!e.fullRender;if(!n||!this.dirtyBounds.isEmpty()){this.context.setTransform(this.backingScale,0,0,this.backingScale,0,0);var r=n?this.dirtyBounds.intersection(t.sceneBounds):t.sceneBounds;r.isEmpty()||(this.clearGlobalBounds(r),n&&this.pushClipShape(s.bounds(r)),this.recursiveRender(t,e),n&&this.popClipShape()),this.dirtyBounds=i.NOTHING}},recursiveRender:function(){function t(t){return t.lastNode().getOpacity()<1}function e(){var t=h.logicalWidth*h.backingScale,e=h.logicalHeight*h.backingScale;if(o.length){var i=o.pop();return i.setDimensions(t,e),i}var s=document.createElement("canvas");s.width=h.logicalWidth*h.backingScale,s.height=h.logicalHeight*h.backingScale;var r=s.getContext("2d");return new n.CanvasContextWrapper(s,r)}function i(){return c[c.length-1]}function s(n){var s=n.lastNode();if(t(n)){var r=e();c.push(r);var o=r.context;o.setTransform(h.backingScale,0,0,h.backingScale,0,0);for(var a=n.nodes.length,u=0;a>u;u++)n.nodes[u].transform.getMatrix().canvasAppendTransform(o)}else s.transform.getMatrix().canvasAppendTransform(i().context);s._clipShape&&h.pushClipShape(s._clipShape)}function r(e){var n=e.lastNode();if(n._clipShape&&h.popClipShape(),t(e)){var s=c[c.length-2].context,r=c[c.length-1].canvas,a=e.lastNode().getOpacity()<1;a&&(s.globalAlpha=e.lastNode().getOpacity()),s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,0,0),s.restore(),a&&(s.globalAlpha=1);var u=c.pop();u!==h.wrapper&&o.push(u)}else n.transform.getInverse().canvasAppendTransform(i().context)}var a,h=this,u=new n.TrailPointer(this.startPaintedTrail,!0),l=new n.TrailPointer(this.endPaintedTrail,!0),c=[this.wrapper];this.wrapper.resetStyles();var d,f=0;u.trail.reindex(),l.trail.reindex();var m=u.trail.length-(u.isBefore?1:0);for(d=new n.Trail,a=0;m>a;a++){var p=u.trail.nodes[a];d.addDescendant(p),f+=p.isVisible()?0:1,0===f&&s(d)}u.depthFirstUntil(l,function(t){var e=t.trail.lastNode();if(t.isBefore){if(f+=e.isVisible()?0:1,0!==f)return!0;if(s(t.trail),e.isPainted()){var i=c[c.length-1];e.paintCanvas(i)}}else 0===f&&r(t.trail),f-=e.isVisible()?0:1},!1),d=l.trail.copy();var g=l.trail.length-(l.isAfter?1:0);for(a=g-1;a>=0;a--){var v=l.trail.nodes[a];f-=v.isVisible()?0:1,0===f&&r(d),d.removeDescendant()}},dispose:function(){r.prototype.dispose.call(this),this.canvas.parentNode.removeChild(this.canvas)},applyTransformationMatrix:function(t){t.canvasAppendTransform(this.context)},reindex:function(t){return r.prototype.reindex.call(this,t),this.zIndex!==t&&(this.canvas.style.zIndex=t,this.zIndex=t),t+1},pushClipShape:function(t){this.context.save(),this.writeClipShape(t)},popClipShape:function(){this.context.restore()},writeClipShape:function(t){this.context.beginPath(),t.writeToContext(this.context),this.context.clip()},clearGlobalBounds:function(t){t.isEmpty()||(this.context.save(),this.context.setTransform(this.backingScale,0,0,this.backingScale,0,0),this.context.clearRect(t.getX(),t.getY(),t.getWidth(),t.getHeight()),this.context.restore())},getSVGString:function(){return'<image xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="'+this.canvas.toDataURL()+'" x="0" y="0" height="'+this.canvas.height+'px" width="'+this.canvas.width+'px"/>'},renderToCanvas:function(t,e){e.drawImage(this.canvas,0,0)},addInstance:function(t){var e=t.trail;r.prototype.addInstance.call(this,t),this.canvasMarkLocalBounds(e.lastNode().getBounds(),e.slice(0,e.length-1)),e.lastNode().boundsInaccurate&&this.boundlessCount++},removeInstance:function(t){var e=t.trail;r.prototype.removeInstance.call(this,t),this.canvasMarkLocalBounds(e.lastNode().getBounds(),e.slice(0,e.length-1)),e.lastNode().boundsInaccurate&&this.boundlessCount--},canUseDirtyRegions:function(){return 0===this.boundlessCount},canvasMarkGlobalBounds:function(t){this.dirtyBounds=this.dirtyBounds.union(t.dilate(2).roundOut())},canvasMarkLocalBounds:function(t,e){this.canUseDirtyRegions()?this.canvasMarkGlobalBounds(e.localToGlobalBounds(t)):this.dirtyBounds=i.EVERYTHING},canvasMarkParentBounds:function(t,e){this.canUseDirtyRegions()?this.canvasMarkGlobalBounds(e.parentToGlobalBounds(t)):this.dirtyBounds=i.EVERYTHING},canvasMarkSelf:function(t){this.canvasMarkLocalBounds(t.getNode().getSelfBounds(),t.trail)},canvasMarkSubtree:function(t){this.canvasMarkParentBounds(t.getNode().getBounds(),t.trail)},getName:function(){return"canvas"},notifyVisibilityChange:function(t){t.trail.isVisible()&&this.canvasMarkSubtree(t)},notifyOpacityChange:function(t){this.canvasMarkSubtree(t)},notifyBeforeSelfChange:function(t){this.canvasMarkSelf(t)},notifyBeforeSubtreeChange:function(t){this.canvasMarkSubtree(t)},notifyDirtySelfPaint:function(t){this.canvasMarkSelf(t)},notifyDirtySubtreePaint:function(t){this.canvasMarkSubtree(t)},notifyTransformChange:function(){},notifyBoundsAccuracyChange:function(t){t.node.boundsInaccurate?this.boundlessCount++:this.boundlessCount--}}),a}),define("SCENERY/layers/DOMLayer",["require","PHET_CORE/inherit","DOT/Bounds2","SCENERY/scenery","SCENERY/layers/Layer","SCENERY/util/Trail"],function(t){var e=t("PHET_CORE/inherit");t("DOT/Bounds2");var i=t("SCENERY/scenery"),n=t("SCENERY/layers/Layer");t("SCENERY/util/Trail"),i.DOMLayer=function(t){n.call(this,t);var e=t.scene.sceneBounds.width,i=t.scene.sceneBounds.height;this.div=document.createElement("div");var s=this.div;s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.width="0",s.style.height="0",s.style.clip="rect(0px,"+e+"px,"+i+"px,0px)",this.$div=$(this.div),this.$main.append(this.div),this.scene=t.scene,this.isDOMLayer=!0,this.idElementMap={},this.idTrailMap={},this.trails=[]};var s=i.DOMLayer;return e(n,s,{addInstance:function(t){n.prototype.addInstance.call(this,t);var e=t.trail;this.reindexTrails();var i=e.lastNode(),s=i.getDOMElement();i.updateDOMElement(s),this.updateVisibility(e,s),this.idElementMap[e.getUniqueId()]=s,this.idTrailMap[e.getUniqueId()]=e;var r;for(r=0;r<this.trails.length;r++){var o=this.trails[r];o.reindex();var a=o.compare(e);if(1===a)break}r===this.div.childNodes.length?(this.div.appendChild(s),this.trails.push(e)):(this.div.insertBefore(this.getElementFromTrail(this.trails[r])),this.trails.splice(r,0,e)),i.updateCSSTransform(e.getTransform(),s)},removeInstance:function(t){n.prototype.removeInstance.call(this,t);var e=t.trail;this.reindexTrails();var i=this.getElementFromTrail(e);delete this.idElementMap[e.getUniqueId],delete this.idTrailMap[e.getUniqueId],this.div.removeChild(i);var s=this.getIndexOfTrail(e);this.trails.splice(s,1)},getElementFromTrail:function(t){return this.idElementMap[t.getUniqueId()]},reindexTrails:function(t){n.prototype.reindex.call(this,t);for(var e=this.trails.length;e--;)this.trails[e].reindex()},getIndexOfTrail:function(t){var e;for(e=0;e<this.trails.length;e++)if(0===this.trails[e].compare(t))return e;throw new Error("DOMLayer.getIndexOfTrail unable to find trail: "+t.toString())},render:function(){},dispose:function(){n.prototype.dispose.call(this),this.div.parentNode.removeChild(this.div)},updateVisibility:function(t,e){e.style.visibility=t.isVisible()?"visible":"hidden"},applyTransformationMatrix:function(){},getContainer:function(){return this.div},reindex:function(t){return n.prototype.reindex.call(this,t),this.zIndex!==t&&(this.div.style.zIndex=t,this.zIndex=t),t+1},pushClipShape:function(){},popClipShape:function(){},getSVGString:function(){"<svg xmlns='http://www.w3.org/2000/svg' width='"+this.$main.width()+"' height='"+this.$main.height()+"'>"+"<foreignObject width='100%' height='100%'>"+$(this.div).html()+"</foreignObject></svg>"},renderToCanvas:function(){},getName:function(){return"dom"},notifyVisibilityChange:function(t){var e=t.trail;for(var i in this.idTrailMap){var n=this.idTrailMap[i];n.reindex(),n.isExtensionOf(e,!0)&&this.updateVisibility(n,this.idElementMap[i])}},notifyOpacityChange:function(t){},notifyBeforeSelfChange:function(){},notifyBeforeSubtreeChange:function(){},notifyDirtySelfPaint:function(t){var e=t.getNode(),i=t.trail,n=this.idElementMap[i.getUniqueId()];n&&(e.updateDOMElement(n),e.domUpdateTransformOnRepaint&&e.updateCSSTransform(i.getTransform(),n))},notifyDirtySubtreePaint:function(t){t.layer===this&&this.notifyDirtySelfPaint(t)},notifyTransformChange:function(t){var e=this,n=t.trail;i.Trail.eachPaintedTrailBetween(this.startPaintedTrail,this.endPaintedTrail,function(t){if(t.isExtensionOf(n,!0)){var i=e.idElementMap[t.getUniqueId()],s=t.lastNode();s.updateCSSTransform(t.getTransform(),i)}},!1,this.scene)},notifyBoundsAccuracyChange:function(){}}),s}),define("SCENERY/layers/SVGLayer",["require","PHET_CORE/inherit","DOT/Bounds2","DOT/Transform3","DOT/Matrix3","SCENERY/scenery","SCENERY/layers/Layer","SCENERY/util/Trail","SCENERY/util/Util"],function(t){var e=t("PHET_CORE/inherit");t("DOT/Bounds2");var i=t("DOT/Transform3"),n=t("DOT/Matrix3"),s=t("SCENERY/scenery"),r=t("SCENERY/layers/Layer");t("SCENERY/util/Trail"),t("SCENERY/util/Util");var o="http://www.w3.org/2000/svg";s.SVGLayer=function(t){var e=t.$main;this.scene=t.scene,this.svg=document.createElementNS(o,"svg"),this.g=document.createElementNS(o,"g"),this.defs=document.createElementNS(o,"defs");var i=t.scene.sceneBounds.width,n=t.scene.sceneBounds.height;this.svg.appendChild(this.defs),this.svg.appendChild(this.g),this.$svg=$(this.svg),this.svg.setAttribute("width",i),this.svg.setAttribute("height",n),this.svg.setAttribute("stroke-miterlimit",10),this.svg.style.position="absolute",this.svg.style.left="0",this.svg.style.top="0",this.svg.style.clip="rect(0px,"+i+"px,"+n+"px,0px)",this.svg.style["pointer-events"]="none",e.append(this.svg),this.isSVGLayer=!0,this.idFragmentMap={},this.idGroupMap={},r.call(this,t),this.baseTransformDirty=!0,this.baseTransformChange=!0};var a=s.SVGLayer;return e(r,a,{addInstance:function(t){var e=t.trail;r.prototype.addInstance.call(this,t);for(var i=this.baseTrail.copy(),n=null;i.length<=e.length;){var s=i.getUniqueId(),a=this.idGroupMap[s];if(a||(n?(a=document.createElementNS(o,"g"),this.applyTransform(i.lastNode().getTransform(),a),this.insertGroupIntoParent(a,this.idGroupMap[n],i)):(a=this.g,this.initializeBase(),this.refreshBaseTransform()),this.updateNodeGroup(i.lastNode(),a),a.referenceCount=0,a.trail=i.copy(),this.idGroupMap[s]=a),a.referenceCount++,i.length===e.length)break;i.addDescendant(e.nodes[i.length]),n=s}var h=e.lastNode(),u=e.getUniqueId(),l=this.idGroupMap[u],c=h.createSVGFragment(this.svg,this.defs,l);this.updateNode(h,c),this.updateNodeGroup(h,l),this.idFragmentMap[u]=c,l.appendChild(c)},removeInstance:function(t){var e=t.trail;r.prototype.removeInstance.call(this,t);var i=e.getUniqueId(),n=e.lastNode(),s=this.idFragmentMap[i];this.idGroupMap[i].removeChild(s),delete this.idFragmentMap[i],n.removeSVGDefs&&n.removeSVGDefs(this.svg,this.defs);for(var o=e.copy();o.length>this.baseTrail.length;){var a=o.getUniqueId(),h=this.idGroupMap[a];h.referenceCount--,0===h.referenceCount&&(h.parentNode.removeChild(h),delete h.trail,delete this.idGroupMap[a]),o.removeDescendant()}this.g.referenceCount--},insertGroupIntoParent:function(t,e,i){if(e.childNodes.length){var n,s=i.length-2,r=i.indices[s];for(n=0;n<e.childNodes.length;n++){var o=e.childNodes[n];if(o.trail){o.trail.reindex();var a=o.trail.indices[s];if(a>r)break}}n===e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n])}else e.appendChild(t)},updateNode:function(t,e){t.updateSVGFragment&&t.updateSVGFragment(e),t.updateSVGDefs&&t.updateSVGDefs(this.svg,this.defs)},updateNodeGroup:function(t,e){this.updateGroupVisibility(t,e),this.updateGroupOpacity(t,e)},updateGroupVisibility:function(t,e){e.style.display=(t===this.baseNode?this.baseTrail.isVisible():t.isVisible())?"inherit":"none"},updateGroupOpacity:function(t,e){var i;i=t===this.baseNode?this.baseTrail.getOpacity():t.getOpacity(),e.setAttribute("opacity",i)},getFragmentFromInstance:function(t){return this.idFragmentMap[t.trail.getUniqueId()]},getGroupFromInstance:function(t){return this.idGroupMap[t.trail.getUniqueId()]},applyTransform:function(t,e){t.isIdentity()?e.hasAttribute("transform")&&e.removeAttribute("transform"):e.setAttribute("transform",t.getMatrix().getSVGTransform())},render:function(){this.refreshBaseTransform()},refreshBaseTransform:function(){if(this.baseTransformDirty){var t=this.baseTransformChange;this.updateBaseTransform(t),this.baseTransformDirty=!1,this.baseTransformChange=!1}},dispose:function(){r.prototype.dispose.call(this),this.svg.parentNode.removeChild(this.svg)},markBaseTransformDirty:function(t){var e=this.baseTransformChange||!!t;this.baseTransformDirty=!0,this.baseTransformChange=e},initializeBase:function(){this.cssTransform?this.baseNodeInternalBoundsChange():this.markBaseTransformDirty(!0)},baseNodeInternalBoundsChange:function(){if(this.cssTransform){var t=this.baseNode.parentToLocalBounds(this.baseNode.getBounds()),e=s.Layer.cssTransformPadding;if(!t.isEmpty()){this.baseNodeTransform.set(n.translation(Math.ceil(-t.minX+e),Math.ceil(-t.minY+e)));var i=this.baseNodeTransform.transformBounds2(t);this.updateContainerDimensions(Math.ceil(i.maxX+e),Math.ceil(i.maxY+e))}this.markBaseTransformDirty(!0)}else this.usesPartialCSSTransforms&&this.markBaseTransformDirty(!0)},updateContainerDimensions:function(t,e){this.svg.setAttribute("width",t),this.svg.setAttribute("height",e)},updateBaseTransform:function(t){var e=this.baseTrail.getTransform();if(this.cssTransform)s.Util.applyCSSTransform(e.getMatrix().timesMatrix(this.baseNodeTransform.getInverse()),this.svg),t&&this.applyTransform(this.baseNodeTransform,this.g);else if(this.usesPartialCSSTransforms){var r=new i,o=e.getMatrix();if(this.cssTranslation&&r.append(n.translation(o.m02(),o.m12())),this.cssRotation&&r.append(n.rotation2(o.getRotation())),this.cssScale){var a=o.getScaleVector();r.append(n.scaling(a.x,a.y))}e.prepend(r.getInverse());var h=s.Layer.cssTransformPadding,u=this.baseNode.parentToLocalBounds(this.baseNode.getBounds()),l=e.transformBounds2(u),c=n.translation(Math.ceil(-l.minX+h),Math.ceil(-l.minY+h)),d=c.inverted();this.updateContainerDimensions(Math.ceil(l.getWidth()+2*h),Math.ceil(l.getHeight()+2*h)),r.append(d),e.prepend(c),s.Util.applyCSSTransform(r.getMatrix(),this.svg),this.applyTransform(e,this.g)}else this.applyTransform(e,this.g)},applyTransformationMatrix:function(){},getContainer:function(){return this.svg},reindex:function(t){return r.prototype.reindex.call(this,t),this.zIndex!==t&&(this.svg.style.zIndex=t,this.zIndex=t),t+1},pushClipShape:function(){},popClipShape:function(){},getSVGString:function(){return $("<div>").append(this.$svg.clone()).html()},renderToCanvas:function(t,e,i){if(this.applyTransform(this.baseTrail.getTransform(),this.g),!window.canvg){var n=window.URL||window.webkitURL||window,s=new Image,r=this.getSVGString();console.log(r);var o=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),a=n.createObjectURL(o);throw i.increment(),s.onload=function(){e.drawImage(s,0,0),n.revokeObjectURL(a),i.decrement()},s.src=a,new Error("this implementation hits Chrome bugs, won't work on IE9/10, etc. deprecated")}i.increment(),canvg(t,this.getSVGString(),{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,renderCallback:function(){i.decrement()}}),this.updateBaseTransform()},getName:function(){return"svg"},notifyVisibilityChange:function(t){var e=this.getGroupFromInstance(t);e?this.updateGroupVisibility(t.getNode(),e):this.baseNode!==this.scene&&this.updateGroupVisibility(this.baseNode,this.getGroupFromInstance(this.baseTrail.getInstance()))},notifyOpacityChange:function(t){var e=this.getGroupFromInstance(t);e?this.updateGroupOpacity(t.getNode(),e):this.baseNode!==this.scene&&this.updateGroupOpacity(this.baseNode,this.getGroupFromInstance(this.baseTrail.getInstance()))},notifyBeforeSelfChange:function(){},notifyBeforeSubtreeChange:function(){},notifyDirtySelfPaint:function(t){var e=this.getFragmentFromInstance(t);if(e){var i=t.getNode();i.updateSVGFragment&&i.updateSVGFragment(e),i.updateSVGDefs&&i.updateSVGDefs(this.svg,this.defs)}},notifyDirtySubtreePaint:function(t){t.layer===this&&this.notifyDirtySelfPaint(t)},notifyTransformChange:function(t){var e=t.node,i=t.trail;if(i.lastNode()===this.baseNode)this.markBaseTransformDirty();else if(_.contains(i.nodes,this.baseNode)){var n=this.idGroupMap[i.getUniqueId()];this.applyTransform(e.getTransform(),n)}else this.markBaseTransformDirty()},notifyBoundsAccuracyChange:function(){}}),a}),define("SCENERY/layers/Renderer",["require","SCENERY/scenery","SCENERY/layers/LayerType","SCENERY/layers/CanvasLayer","SCENERY/layers/DOMLayer","SCENERY/layers/SVGLayer"],function(t){var e=t("SCENERY/scenery");t("SCENERY/layers/LayerType"),t("SCENERY/layers/CanvasLayer"),t("SCENERY/layers/DOMLayer"),t("SCENERY/layers/SVGLayer"),e.Renderer=function(t,e,i){this.layerConstructor=t,this.name=e,this.defaultOptions=i,this.defaultLayerType=this.createLayerType({})};var i=e.Renderer;return i.prototype={constructor:i,createLayerType:function(t){return new e.LayerType(this.layerConstructor,this.name,this,_.extend({},this.defaultOptions,t))}},i.Canvas=new i(e.CanvasLayer,"canvas",{}),i.DOM=new i(e.DOMLayer,"dom",{}),i.SVG=new i(e.SVGLayer,"svg",{}),e.CanvasDefaultLayerType=i.Canvas.defaultLayerType,e.DOMDefaultLayerType=i.DOM.defaultLayerType,e.SVGDefaultLayerType=i.SVG.defaultLayerType,i.canvas=i.Canvas,i.dom=i.DOM,i.svg=i.SVG,i.webgl=i.WebGL,i}),define("SCENERY/nodes/Fillable",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.Fillable=function(t){var e=t.prototype;e.initializeFillable=function(){this._fill=null;var t=this;this._fillListener=function(){t.invalidatePaint(),t.invalidateFill()}},e.hasFill=function(){return null!==this._fill},e.getFill=function(){return this._fill},e.setFill=function(t){if(this.getFill()!==t){var e=this._instances.length>0;e&&this._fill&&this._fill.removeChangeListener&&this._fill.removeChangeListener(this._fillListener),this._fill=t,e&&this._fill&&this._fill.addChangeListener&&this._fill.addChangeListener(this._fillListener),this.invalidatePaint(),this.invalidateFill()}return this};var i=e.firstInstanceAdded;e.firstInstanceAdded=function(){this._fill&&this._fill.addChangeListener&&this._fill.addChangeListener(this._fillListener),i&&i.call(this)};var n=e.lastInstanceRemoved;e.lastInstanceRemoved=function(){this._fill&&this._fill.removeChangeListener&&this._fill.removeChangeListener(this._fillListener),n&&n.call(this)},e.beforeCanvasFill=function(t){t.setFillStyle(this._fill),this._fill.transformMatrix&&(t.context.save(),this._fill.transformMatrix.canvasAppendTransform(t.context))},e.afterCanvasFill=function(t){this._fill.transformMatrix&&t.context.restore()},e.getSVGFillStyle=function(){var t="fill: ";return t+=this._fill?this._fill.toCSS?this._fill.toCSS()+";":this._fill.getSVGDefinition?"url(#fill"+this.getId()+");":this._fill+";":"none;"},e.isFillDOMCompatible=function(){return!this._fill||!this._fill.getSVGDefinition},e.getCSSFill=function(){return this._fill?this._fill.toCSS?this._fill.toCSS():this._fill:"transparent"},e.addSVGFillDef=function(t,e){var i=this.getFill(),n="fill"+this.getId();i&&i.getSVGDefinition&&e.appendChild(i.getSVGDefinition(n))},e.removeSVGFillDef=function(t,e){var i="fill"+this.getId(),n=t.getElementById(i);n&&e.removeChild(n)},e.appendFillablePropString=function(t,e){return this._fill&&(e&&(e+=",\n"),e+="string"==typeof this._fill?t+"fill: '"+this._fill+"'":t+"fill: "+this._fill.toString()),e},e._mutatorKeys=["fill"].concat(e._mutatorKeys),Object.defineProperty(e,"fill",{set:e.setFill,get:e.getFill}),e.invalidateFill||(e.invalidateFill=function(){})};var i=e.Fillable;return i}),define("SCENERY/nodes/Strokable",["require","SCENERY/scenery","KITE/util/LineStyles"],function(t){var e=t("SCENERY/scenery"),i=t("KITE/util/LineStyles");e.Strokable=function(t){var e=t.prototype;e.initializeStrokable=function(){this._stroke=null,this._lineDrawingStyles=new i;var t=this;this._strokeListener=function(){t.invalidatePaint(),t.invalidateStroke()}},e.hasStroke=function(){return null!==this._stroke},e.getLineWidth=function(){return this._lineDrawingStyles.lineWidth},e.setLineWidth=function(t){return this.getLineWidth()!==t&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineWidth=t,this.invalidateStroke()),this},e.getLineCap=function(){return this._lineDrawingStyles.lineCap},e.setLineCap=function(t){return this._lineDrawingStyles.lineCap!==t&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineCap=t,this.invalidateStroke()),this},e.getLineJoin=function(){return this._lineDrawingStyles.lineJoin},e.setLineJoin=function(t){return this._lineDrawingStyles.lineJoin!==t&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineJoin=t,this.invalidateStroke()),this},e.getLineDash=function(){return this._lineDrawingStyles.lineDash},e.setLineDash=function(t){return this._lineDrawingStyles.lineDash!==t&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineDash=t,this.invalidateStroke()),this},e.getLineDashOffset=function(){return this._lineDrawingStyles.lineDashOffset},e.setLineDashOffset=function(t){return this._lineDrawingStyles.lineDashOffset!==t&&(this.markOldSelfPaint(),this._lineDrawingStyles.lineDashOffset=t,this.invalidateStroke()),this},e.setLineStyles=function(t){return this.markOldSelfPaint(),this._lineDrawingStyles=t,this.invalidateStroke(),this},e.getLineStyles=function(){return this._lineDrawingStyles},e.getStroke=function(){return this._stroke},e.setStroke=function(t){if(this.getStroke()!==t){this.markOldSelfPaint();var e=this._instances.length>0;e&&this._stroke&&this._stroke.removeChangeListener&&this._stroke.removeChangeListener(this._strokeListener),this._stroke=t,e&&this._stroke&&this._stroke.addChangeListener&&this._stroke.addChangeListener(this._strokeListener),this.invalidateStroke()}return this};var n=e.firstInstanceAdded;e.firstInstanceAdded=function(){this._stroke&&this._stroke.addChangeListener&&this._stroke.addChangeListener(this._strokeListener),n&&n.call(this)};var s=e.lastInstanceRemoved;e.lastInstanceRemoved=function(){this._stroke&&this._stroke.removeChangeListener&&this._stroke.removeChangeListener(this._strokeListener),s&&s.call(this)},e.beforeCanvasStroke=function(t){t.setStrokeStyle(this._stroke),t.setLineWidth(this.getLineWidth()),t.setLineCap(this.getLineCap()),t.setLineJoin(this.getLineJoin()),t.setLineDash(this.getLineDash()),t.setLineDashOffset(this.getLineDashOffset()),this._stroke.transformMatrix&&(t.context.save(),this._stroke.transformMatrix.canvasAppendTransform(t.context))},e.afterCanvasStroke=function(t){this._stroke.transformMatrix&&t.context.restore()},e.getSVGStrokeStyle=function(){if(!this._stroke)return"stroke: none;";var t="stroke: ";return t+=this._stroke.toCSS?this._stroke.toCSS()+";":this._stroke.getSVGDefinition?"url(#stroke"+this.getId()+");":this._stroke+";",t+="stroke-width: "+this.getLineWidth()+";",t+="stroke-linecap: "+this.getLineCap()+";",t+="stroke-linejoin: "+this.getLineJoin()+";",this.getLineDash()&&(t+="stroke-dasharray: "+this.getLineDash().join(",")+";",t+="stroke-dashoffset: "+this.getLineDashOffset()+";"),t},e.addSVGStrokeDef=function(t,e){var i=this.getStroke(),n="stroke"+this.getId();i&&i.getSVGDefinition&&e.appendChild(i.getSVGDefinition(n))},e.removeSVGStrokeDef=function(t,e){var i="stroke"+this.getId(),n=t.getElementById(i);n&&e.removeChild(n)},e.appendStrokablePropString=function(t,e){function n(i,n,s){e&&(e+=",\n"),e+=s||"string"!=typeof n?t+i+": "+n:t+i+": '"+n+"'"}var s=this;if(this._stroke){var r=new i;"string"==typeof this._stroke?n("stroke",this._stroke):n("stroke",this._stroke.toString(),!0),_.each(["lineWidth","lineCap","lineJoin","lineDashOffset"],function(t){s[t]!==r[t]&&n(t,s[t])}),this.lineDash&&n("lineDash",JSON.stringify(this.lineDash),!0)}return e},e._mutatorKeys=["stroke","lineWidth","lineCap","lineJoin","lineDash","lineDashOffset"].concat(e._mutatorKeys),Object.defineProperty(e,"stroke",{set:e.setStroke,get:e.getStroke}),Object.defineProperty(e,"lineWidth",{set:e.setLineWidth,get:e.getLineWidth}),Object.defineProperty(e,"lineCap",{set:e.setLineCap,get:e.getLineCap}),Object.defineProperty(e,"lineJoin",{set:e.setLineJoin,get:e.getLineJoin}),Object.defineProperty(e,"lineDash",{set:e.setLineDash,get:e.getLineDash}),Object.defineProperty(e,"lineDashOffset",{set:e.setLineDashOffset,get:e.getLineDashOffset}),e.invalidateStroke||(e.invalidateStroke=function(){})};var n=e.Strokable;return n}),define("SCENERY/nodes/Path",["require","PHET_CORE/inherit","KITE/Shape","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/layers/Renderer","SCENERY/nodes/Fillable","SCENERY/nodes/Strokable","SCENERY/util/Util"],function(t){var e=t("PHET_CORE/inherit"),i=t("KITE/Shape"),n=t("SCENERY/scenery"),s=t("SCENERY/nodes/Node"),r=t("SCENERY/layers/Renderer"),o=t("SCENERY/nodes/Fillable"),a=t("SCENERY/nodes/Strokable");t("SCENERY/util/Util").objectCreate,n.Path=function(t){this._shape=null,t=t||{},this.initializeFillable(),this.initializeStrokable(),s.call(this,t)};var h=n.Path;return e(s,h,{setShape:function(t){return this._shape!==t&&("string"==typeof t&&(t=new i(t)),this._shape=t,this.invalidateShape()),this},getShape:function(){return this._shape},invalidateShape:function(){this.markOldSelfPaint(),this.hasShape()&&(this.invalidateSelf(this.computeShapeBounds()),this.invalidatePaint())},computeShapeBounds:function(){return this._stroke?this._shape.computeBounds(this._lineDrawingStyles):this._shape.bounds},invalidateStroke:function(){this.invalidateShape()},hasShape:function(){return null!==this._shape},paintCanvas:function(t){var e=t.context;this.hasShape()&&(e.beginPath(),this._shape.writeToContext(e),this._fill&&(this.beforeCanvasFill(t),e.fill(),this.afterCanvasFill(t)),this._stroke&&(this.beforeCanvasStroke(t),e.stroke(),this.afterCanvasStroke(t)))},paintWebGL:function(){throw new Error("Path.prototype.paintWebGL unimplemented")},createSVGFragment:function(){return document.createElementNS("http://www.w3.org/2000/svg","path")},updateSVGFragment:function(t){var e=this.hasShape()?this._shape.getSVGPath():"";e||(e="M0 0"),e?t.setAttribute("d",e):t.hasAttribute("d")&&t.removeAttribute("d"),t.setAttribute("style",this.getSVGFillStyle()+this.getSVGStrokeStyle())},updateSVGDefs:function(t,e){this.removeSVGDefs(t,e),this.addSVGFillDef(t,e),this.addSVGStrokeDef(t,e)},removeSVGDefs:function(t,e){this.removeSVGFillDef(t,e),this.removeSVGStrokeDef(t,e)},isPainted:function(){return!0},containsPointSelf:function(t){if(!this.hasShape())return!1;var e=this._shape.containsPoint(t);return!e&&this._includeStrokeInHitRegion&&this.hasStroke()&&(e=this._shape.getStrokedShape(this._lineDrawingStyles).containsPoint(t)),e},intersectsBoundsSelf:function(t){return this.hasShape()?this._shape.intersectsBounds(t):!1},set shape(t){this.setShape(t)},get shape(){return this.getShape()},getBasicConstructor:function(t){return"new scenery.Path( {"+t+"} )"},getPropString:function(t,e){var i=s.prototype.getPropString.call(this,t,e);return i=this.appendFillablePropString(t,i),i=this.appendStrokablePropString(t,i),this._shape&&(i&&(i+=",\n"),i+=t+"shape: "+this._shape.toString()),i}}),h.prototype._mutatorKeys=["shape"].concat(s.prototype._mutatorKeys),h.prototype._supportedRenderers=[r.Canvas,r.SVG],o(h),a(h),h}),define("SCENERY/nodes/HBox",["require","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/util/Util"],function(t){var e=t("SCENERY/scenery"),i=t("SCENERY/nodes/Node"),n=t("SCENERY/util/Util").objectCreate;e.HBox=function(t){if(this.options=t=_.extend({spacing:function(){return 0},align:"center"},t),"number"==typeof t.spacing){var e=t.spacing;t.spacing=function(){return e}}i.call(this,t),this.updateLayout(),t&&this.mutate(t)};var s=e.HBox;return s.prototype=n(i.prototype),s.prototype.updateLayout=function(){for(var t=_.min(_.map(this.children,function(t){return t.top})),e=_.max(_.map(this.children,function(t){return t.top+t.height})),i=(e+t)/2,n=0,s=0;s<this.children.length;s++){var r=this.children[s];r.left=n,"top"===this.options.align?r.top=t:"bottom"===this.options.align?r.bottom=e:r.centerY=i,n+=r.width+this.options.spacing(r,this.children[s+1])}},s.prototype.constructor=s,s}),define("SCENERY/nodes/VBox",["require","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/util/Util"],function(t){var e=t("SCENERY/scenery"),i=t("SCENERY/nodes/Node"),n=t("SCENERY/util/Util").objectCreate;e.VBox=function(t){if(this.options=t=_.extend({spacing:function(){return 0},align:"center"},t),"number"==typeof t.spacing){var e=t.spacing;t.spacing=function(){return e}}i.call(this,t),this.updateLayout(),t&&this.mutate(t)};var s=e.VBox;return s.prototype=n(i.prototype),s.prototype.updateLayout=function(){for(var t=_.min(_.map(this.children,function(t){return t.left
})),e=_.max(_.map(this.children,function(t){return t.left+t.width})),i=(e+t)/2,n=0,s=0;s<this.children.length;s++){var r=this.children[s];r.top=n,"left"===this.options.align?r.left=t:"right"===this.options.align?r.right=e:r.centerX=i,n+=r.height+this.options.spacing(r,this.children[s+1])}},s.prototype.constructor=s,s}),define("PHET_CORE/escapeHTML",["require"],function(){return function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")}}),define("SCENERY/util/Font",["require","SCENERY/scenery"],function(t){function e(t){return"number"==typeof t?t+"px":t}var i=t("SCENERY/scenery"),n=["normal","italic","oblique"],s=["normal","small-caps"],r=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],o=["normal","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"];i.Font=function(t){this._style="normal",this._variant="normal",this._weight="normal",this._stretch="normal",this._size="10px",this._lineHeight="normal",this._family="sans-serif";var i=typeof t;if("string"===i)for(var a=_.filter(t.split(/[\x09\x0A\x0C\x0D\x20]/),function(t){return t.length>0}),h=0;h<a.length;h++){var u=a[h];if("normal"===u);else if(_.contains(n,u))this._style=u;else if(_.contains(s,u))this._variant=u;else if(_.contains(r,u))this._weight=u;else{if(!_.contains(o,u)){var l=u.split(/\//);this._size=l[0],l[1]&&(this._lineHeight=l[1]),this._family=a.slice(h+1).join(" ");break}this._stretch=u}}else"object"===i&&(void 0!==t.style&&(this._style=t.style),void 0!==t.variant&&(this._variant=t.variant),void 0!==t.weight&&(this._weight=""+t.weight),void 0!==t.stretch&&(this._stretch=t.stretch),void 0!==t.size&&(this._size=e(t.size)),void 0!==t.lineHeight&&(this._lineHeight=t.lineHeight),void 0!==t.family&&(this._family=t.family));this._font=this.computeShorthand()};var a=i.Font;return a.prototype={constructor:a,getFont:function(){return this._font},getStyle:function(){return this._style},getVariant:function(){return this._variant},getWeight:function(){return this._weight},getStretch:function(){return this._stretch},getSize:function(){return this._size},getLineHeight:function(){return this._lineHeight},getFamily:function(){return this._family},get font(){return this.getFont()},get style(){return this.getStyle()},get variant(){return this.getVariant()},get weight(){return this.getWeight()},get stretch(){return this.getStretch()},get size(){return this.getSize()},get lineHeight(){return this.getLineHeight()},get family(){return this.getFamily()},copy:function(t){return new a(_.extend({style:this._style,variant:this._variant,weight:this._weight,stretch:this._stretch,size:this._size,lineHeight:this._lineHeight,family:this._family},t))},computeShorthand:function(){var t="";return"normal"!==this._style&&(t+=this._style+" "),"normal"!==this._variant&&(t+=this._variant+" "),"normal"!==this._weight&&(t+=this._weight+" "),"normal"!==this._stretch&&(t+=this._stretch+" "),t+=this._size,"normal"!==this._lineHeight&&(t+="/"+this._lineHeight),t+=" "+this._family},toCSS:function(){return this.getFont()}},a.DEFAULT=new a,a}),define("SCENERY/nodes/Text",["require","PHET_CORE/inherit","PHET_CORE/escapeHTML","DOT/Bounds2","DOT/Matrix3","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/layers/Renderer","SCENERY/nodes/Fillable","SCENERY/nodes/Strokable","SCENERY/util/Util","SCENERY/util/Font","SCENERY/util/Util"],function(t){function e(t,e,i){var n="get"+e,s="set"+e;g.prototype[n]=function(){return this._font[i]},g.prototype[s]=function(t){var e={};e[i]=t;var n=this._font.copy(e);return this.setFont(n),this},Object.defineProperty(g.prototype,t,{set:g.prototype[s],get:g.prototype[n]})}var i=t("PHET_CORE/inherit"),n=t("PHET_CORE/escapeHTML"),s=t("DOT/Bounds2"),r=t("DOT/Matrix3"),o=t("SCENERY/scenery"),a=t("SCENERY/nodes/Node"),h=t("SCENERY/layers/Renderer"),u=t("SCENERY/nodes/Fillable"),l=t("SCENERY/nodes/Strokable");t("SCENERY/util/Util").objectCreate,t("SCENERY/util/Font"),t("SCENERY/util/Util");var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("width","2"),c.setAttribute("height","2"),c.setAttribute("style","display: hidden; pointer-events: none; position: absolute; left: -65535; right: -65535;");var d=document.createElementNS("http://www.w3.org/2000/svg","text");d.appendChild(document.createTextNode("")),c.appendChild(d);var f,m=-1!==window.navigator.userAgent.indexOf("like Gecko) Version/5")&&-1!==window.navigator.userAgent.indexOf("Safari/"),p=!1;o.Text=function(t,e){this._text="",this._font=o.Font.DEFAULT,this._direction="ltr",this._boundsMethod="hybrid",this._isHTML=void 0===this._isHTML?!1:this._isHTML,this._supportedRenderers=[h.Canvas,h.SVG,h.DOM],e=e||{},void 0===e.fill&&(e.fill="#000000"),void 0!==t&&(e.text=t),this.initializeStrokable(),a.call(this,e),this.updateTextFlags()};var g=o.Text;return i(a,g,{domUpdateTransformOnRepaint:!0,setText:function(t){return t!==this._text&&(this._text=t,this.invalidateText()),this},getText:function(){return this._text},setBoundsMethod:function(t){return t!==this._boundsMethod&&(this._boundsMethod=t,this.updateTextFlags(),this.dispatchEvent("boundsAccuracy",{node:this}),this.invalidateText()),this},getBoundsMethod:function(){return this._boundsMethod},updateTextFlags:function(){function t(t,n){var s=_.contains(e._supportedRenderers,n);if(t!==s)if(i=!0,t)e._supportedRenderers.push(n);else if(e._supportedRenderers.splice(_.indexOf(e._supportedRenderers,n),1),e.renderer===n)throw e.renderer=null,new Error("The explicitly specified Text renderer: "+n.name+" is not supported by this operation (probably invalid stroke, fill, or boundsMethod)")}var e=this;this.boundsInaccurate="accurate"!==this._boundsMethod;var i=!1;if(t("fast"!==this._boundsMethod&&!this._isHTML,h.Canvas),t(!this._isHTML,h.SVG),t(!this.hasStroke()&&this.isFillDOMCompatible(),h.DOM),0===this._supportedRenderers.length)throw new Error("No renderers are able to support this Text node (probably HTML text with a stroke or incompatible fill)");i&&this.markLayerRefreshNeeded()},invalidateText:function(){this._isHTML||m&&"accurate"!==this._boundsMethod?this.invalidateSelf(this.approximateDOMBounds()):"hybrid"===this._boundsMethod?this.invalidateSelf(this.approximateHybridBounds()):"fast"===this._boundsMethod||"fastCanvas"===this._boundsMethod?this.invalidateSelf(this.approximateSVGBounds()):this.invalidateSelf(this.accurateCanvasBounds()),this.updateTextFlags()},invalidateStroke:function(){this.invalidateText()},invalidateFill:function(){this.invalidateText()},paintCanvas:function(t){var e=t.context;(this.hasFill()||this.hasStroke())&&(t.setFont(this._font.getFont()),t.setDirection(this._direction)),this.hasFill()&&(this.beforeCanvasFill(t),e.fillText(this._text,0,0),this.afterCanvasFill(t)),this.hasStroke()&&(this.beforeCanvasStroke(t),e.strokeText(this._text,0,0),this.afterCanvasStroke(t))},paintWebGL:function(){throw new Error("Text.prototype.paintWebGL unimplemented")},createSVGFragment:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","text");return t.appendChild(document.createTextNode("")),t},updateSVGFragment:function(t){"rtl"===this._direction,t.lastChild.nodeValue=this._text,t.setAttribute("style",this.getSVGFillStyle()+this.getSVGStrokeStyle()),t.setAttribute("dominant-baseline","alphabetic"),t.setAttribute("direction",this._direction),t.setAttribute("font-family",this._font.getFamily()),t.setAttribute("font-size",this._font.getSize()),t.setAttribute("font-style",this._font.getStyle()),t.setAttribute("font-weight",this._font.getWeight()),t.setAttribute("font-stretch",this._font.getStretch())},updateSVGDefs:function(t,e){this.removeSVGDefs(t,e),this.addSVGFillDef(t,e),this.addSVGStrokeDef(t,e)},removeSVGDefs:function(t,e){this.removeSVGFillDef(t,e),this.removeSVGStrokeDef(t,e)},allowsMultipleDOMInstances:!0,getDOMElement:function(){return document.createElement("div")},updateDOMElement:function(t){var e=$(t);t.style.font=this.getFont(),t.style.color=this.getCSSFill(),e.width(this.getSelfBounds().width),e.height(this.getSelfBounds().height),e.empty(),t.appendChild(this.getDOMTextNode()),t.setAttribute("dir",this._direction)},updateCSSTransform:function(t,e){var i=this.getSelfBounds().minY,n=t.getMatrix().timesMatrix(r.translation(0,i));o.Util.applyCSSTransform(n,e)},getDOMTextNode:function(){if(this._isHTML){var t=document.createElement("span");return t.innerHTML=this.text,t}return document.createTextNode(this.text)},accurateCanvasBounds:function(){var t=this,e=this.approximateSVGBounds();return 0===e.width&&0===e.height?e:o.Util.canvasAccurateBounds(function(e){e.font=t.font,e.direction=t.direction,e.fillText(t.text,0,0)},{precision:.5,resolution:128,initialScale:32/Math.max(Math.abs(e.minX),Math.abs(e.minY),Math.abs(e.maxX),Math.abs(e.maxY))})},approximateCanvasWidth:function(){var t=o.scratchContext;return t.font=this.font,t.direction=this.direction,t.measureText(this.text).width},approximateSVGBounds:function(){if(!c.parentNode){if(!document.body){if(p)return s.NOTHING;throw new Error("No document.body and trying to get approximate SVG bounds of a Text node")}document.body.appendChild(c)}this.updateSVGFragment(d);var t=d.getBBox();return new s(t.x,t.y,t.x+t.width,t.y+t.height)},approximateHybridBounds:function(){if(!f)return s.NOTHING;void 0===this._font._cachedSVGBounds&&(f.setFont(this._font),this._font._cachedSVGBounds=f.getBounds());var t=this.approximateCanvasWidth(),e=this._font._cachedSVGBounds;return new s(0,e.minY,t,e.maxY)},approximateDOMBounds:function(){var t=1024,e="rtl"===this.direction,i=document.createElement("div");$(i).css({position:"absolute",left:0,top:0,padding:"0 !important",margin:"0 !important",display:"hidden"});var n=document.createElement("span");$(n).css("font",this.getFont()),n.appendChild(this.getDOMTextNode()),n.setAttribute("direction",this._direction);var r=document.createElement("div");$(r).css({"vertical-align":"baseline",display:"inline-block",width:0,height:t+"px",margin:"0 !important",padding:"0 !important"}),i.appendChild(n),i.appendChild(r),document.body.appendChild(i);var o=n.getBoundingClientRect(),a=i.getBoundingClientRect(),h=new s(o.left,o.top-t,o.right+1,o.bottom-t).shifted(-a.left,-a.top);document.body.removeChild(i);var u=o.right-o.left;return h.shiftedX(e?-u:0)},setFont:function(t){return this.font!==t&&(this._font=t instanceof o.Font?t:new o.Font(t),this.invalidateText()),this},getFont:function(){return this._font.getFont()},setDirection:function(t){return this._direction=t,this.invalidateText(),this},getDirection:function(){return this._direction},isPainted:function(){return!0},getBasicConstructor:function(t){return"new scenery.Text( '"+n(this._text.replace(/'/g,"\\'"))+"', {"+t+"} )"},getPropString:function(t,e){function i(e,i,s){n&&(n+=",\n"),n+=s||"string"!=typeof i?t+e+": "+i:t+e+": '"+i+"'"}var n=a.prototype.getPropString.call(this,t,e);return n=this.appendFillablePropString(t,n),n=this.appendStrokablePropString(t,n),this.font!==(new o.Font).getFont()&&i("font",this.font.replace(/'/g,"\\'")),"ltr"!==this._direction&&i("direction",this._direction),n}}),e("fontWeight","FontWeight","weight"),e("fontFamily","FontFamily","family"),e("fontStretch","FontStretch","stretch"),e("fontStyle","FontStyle","style"),e("fontSize","FontSize","size"),e("lineHeight","LineHeight","lineHeight"),g.prototype._mutatorKeys=["boundsMethod","text","font","fontWeight","fontFamily","fontStretch","fontStyle","fontSize","lineHeight","direction"].concat(a.prototype._mutatorKeys),g.prototype._supportedRenderers=[h.Canvas,h.SVG,h.DOM],g.prototype._supportedRenderersWithFastBounds=[h.SVG,h.DOM],Object.defineProperty(g.prototype,"font",{set:g.prototype.setFont,get:g.prototype.getFont}),Object.defineProperty(g.prototype,"text",{set:g.prototype.setText,get:g.prototype.getText}),Object.defineProperty(g.prototype,"direction",{set:g.prototype.setDirection,get:g.prototype.getDirection}),Object.defineProperty(g.prototype,"boundsMethod",{set:g.prototype.setBoundsMethod,get:g.prototype.getBoundsMethod}),u(g),l(g),p=!0,f=new g("m",{boundsMethod:"fast"}),p=!1,g}),define("SCENERY/nodes/Image",["require","PHET_CORE/inherit","DOT/Bounds2","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/layers/Renderer","SCENERY/util/Util","SCENERY/util/Util"],function(t){var e=t("PHET_CORE/inherit"),i=t("DOT/Bounds2"),n=t("SCENERY/scenery"),s=t("SCENERY/nodes/Node"),r=t("SCENERY/layers/Renderer");t("SCENERY/util/Util").objectCreate,t("SCENERY/util/Util"),n.Image=function(t,e){e=e||{},t&&(e.image=t);var i=this;this.loadListener=function(){i.invalidateImage(),i._image.removeEventListener("load",i.loadListener)},s.call(this,e)};var o=n.Image;return e(s,o,{allowsMultipleDOMInstances:!1,invalidateImage:function(){this.invalidateSelf(new i(0,0,this.getImageWidth(),this.getImageHeight()))},getImage:function(){return this._image},setImage:function(t){if(this._image!==t&&("string"!=typeof t||!this._image||t!==this._image.src)){if(this._image&&this._image.removeEventListener("load",this.loadListener),"string"==typeof t){var e=t;t=document.createElement("img"),t.addEventListener("load",this.loadListener),t.src=e}else t instanceof HTMLImageElement&&(t.width&&t.height||t.addEventListener("load",this.loadListener));t instanceof HTMLCanvasElement?this.hasOwnProperty("_supportedRenderers")||(this._supportedRenderers=[r.Canvas],this.markLayerRefreshNeeded()):this.hasOwnProperty("_supportedRenderers")&&(delete this._supportedRenderers,this.markLayerRefreshNeeded()),this._image=t,this.invalidateImage()}return this},getImageWidth:function(){return this._image.width},getImageHeight:function(){return this._image.height},getImageURL:function(){return this._image.src},isPainted:function(){return!0},paintCanvas:function(t){t.context.drawImage(this._image,0,0)},paintWebGL:function(){throw new Error("paintWebGL:nimplemented")},createSVGFragment:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","image");return t.setAttribute("x",0),t.setAttribute("y",0),t},updateSVGFragment:function(t){var e="http://www.w3.org/1999/xlink";t.setAttribute("width",this.getImageWidth()+"px"),t.setAttribute("height",this.getImageHeight()+"px"),t.setAttributeNS(e,"xlink:href",this.getImageURL())},getDOMElement:function(){return this._image.style.display="block",this._image.style.position="absolute",this._image.style.left="0",this._image.style.top="0",this._image},updateDOMElement:function(t){t.src!==this._image.src&&(t.src=this._image.src)},updateCSSTransform:function(t,e){n.Util.applyCSSTransform(t.getMatrix(),e)},set image(t){this.setImage(t)},get image(){return this.getImage()},getBasicConstructor:function(t){return"new scenery.Image( '"+(this._image.src?this._image.src.replace(/'/g,"\\'"):"other")+"', {"+t+"} )"}}),o.prototype._mutatorKeys=["image"].concat(s.prototype._mutatorKeys),o.prototype._supportedRenderers=[r.Canvas,r.SVG,r.DOM],o.createSVGImage=function(t,e,i){var n="http://www.w3.org/1999/xlink",s="http://www.w3.org/2000/svg",r=document.createElementNS(s,"image");return r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e+"px"),r.setAttribute("height",i+"px"),r.setAttributeNS(n,"xlink:href",t),r},o}),define("SCENERY/nodes/DOM",["require","PHET_CORE/inherit","PHET_CORE/escapeHTML","DOT/Bounds2","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/layers/Renderer","SCENERY/util/Util","SCENERY/util/Util"],function(t){var e=t("PHET_CORE/inherit"),i=t("PHET_CORE/escapeHTML"),n=t("DOT/Bounds2"),s=t("SCENERY/scenery"),r=t("SCENERY/nodes/Node"),o=t("SCENERY/layers/Renderer");t("SCENERY/util/Util").objectCreate,t("SCENERY/util/Util"),s.DOM=function(t,e){e=e||{},this._interactive=!1,t&&t.jquery&&(t=t[0]),this._container=document.createElement("div"),this._$container=$(this._container),this._$container.css("position","absolute"),this._$container.css("left",0),this._$container.css("top",0),this.invalidateDOMLock=!1,e.element=t,r.call(this,e)};var a=s.DOM;return e(r,a,{allowsMultipleDOMInstances:!1,calculateDOMBounds:function(){var t=$(this._element);return new n(0,0,t.width(),t.height())},createTemporaryContainer:function(){var t=document.createElement("div");return $(t).css({display:"hidden",padding:"0 !important",margin:"0 !important",position:"absolute",left:0,top:0,width:65535,height:65535}),t},invalidateDOM:function(){if(!this.invalidateDOMLock){this.invalidateDOMLock=!0;var t=this.createTemporaryContainer();this._container.removeChild(this._element),t.appendChild(this._element),document.body.appendChild(t);var e=this.calculateDOMBounds();this.invalidateSelf(e),this._$container.width(e.getWidth()),this._$container.height(e.getHeight()),document.body.removeChild(t),t.removeChild(this._element),this._container.appendChild(this._element),this.invalidateDOMLock=!1}},getDOMElement:function(){return this._container},updateDOMElement:function(){},updateCSSTransform:function(t){s.Util.applyCSSTransform(t.getMatrix(),this._container)},isPainted:function(){return!0},setElement:function(t){return this._element!==t&&(this._element&&this._container.removeChild(this._element),this._element=t,this._$element=$(t),this._container.appendChild(this._element),this.invalidateDOM()),this},getElement:function(){return this._element},setInteractive:function(t){this._interactive!==t&&(this._interactive=t)},isInteractive:function(){return this._interactive},set element(t){this.setElement(t)},get element(){return this.getElement()},set interactive(t){this.setInteractive(t)},get interactive(){return this.isInteractive()},getBasicConstructor:function(t){return"new scenery.DOM( $( '"+i(this._container.innerHTML.replace(/'/g,"\\'"))+"' ), {"+t+"} )"},getPropString:function(t,e){var i=r.prototype.getPropString.call(this,t,e);return this.interactive&&(i&&(i+=",\n"),i+=t+"interactive: true"),i}}),a.prototype._mutatorKeys=["element","interactive"].concat(r.prototype._mutatorKeys),a.prototype._supportedRenderers=[o.DOM],a}),define("PHET_CORE/collect",["require"],function(){return function(t){var e=[];return t(function(t){e.push(t)}),e}}),define("SCENERY/util/AccessibilityPeer",["require","PHET_CORE/inherit","SCENERY/scenery"],function(t){t("PHET_CORE/inherit");var e=t("SCENERY/scenery"),i=e.AccessibilityPeer=function(t,e,i){var n=this;if(i=i||{},i.tabIndex=i.tabIndex||1,this.element="string"==typeof e?$(e)[0]:e,i.label){this.peerElement=document.createElement("div"),this.element.id="peer-"+t.trail.getUniqueId();var s=document.createElement("label");s.appendChild(document.createTextNode(i.label)),s.setAttribute("for",this.element.id),this.peerElement.appendChild(s),this.peerElement.appendChild(this.element)}else this.peerElement=this.element;this.instance=t,this.trail=t.trail,this.element.setAttribute("tabindex",i.tabIndex),this.element.style.position="absolute";var r=t.getScene();this.clickListener=function(t){i.click&&i.click(t)},this.focusListener=function(){r.focusPeer(n)},this.blurListener=function(){r.blurPeer(n)},this.element.addEventListener("click",this.clickListener),this.element.addEventListener("focus",this.focusListener),this.element.addEventListener("blur",this.blurListener),this.keepPeerBoundsInSync=!0,this.keepPeerBoundsInSync&&(this.boundsSyncListener=this.syncBounds.bind(this),t.getNode().addEventListener("bounds",this.boundsSyncListener),this.syncBounds(),t.getScene().addEventListener("resize",this.boundsSyncListener),window.setTimeout(this.syncBounds.bind(this),30))};return i.prototype={constructor:i,dispose:function(){this.element.removeEventListener("click",this.clickListener),this.element.removeEventListener("focus",this.focusListener),this.element.removeEventListener("blur",this.blurListener),this.keepPeerBoundsInSync&&(this.instance.getNode().removeEventListener("bounds",this.boundsSyncListener),this.instance.getScene().removeEventListener("resize",this.boundsSyncListener))},getGlobalBounds:function(){return this.trail.parentToGlobalBounds(this.trail.lastNode().getBounds()).roundedOut()},syncBounds:function(){var t=this.getGlobalBounds();this.element.style.left=t.x+"px",this.element.style.top=t.y+"px",this.element.style.width=t.width+"px",this.element.style.height=t.height+"px"}},i}),define("SCENERY/util/LiveRegion",["require","PHET_CORE/inherit","PHET_CORE/escapeHTML","SCENERY/scenery"],function(t){t("PHET_CORE/inherit"),t("PHET_CORE/escapeHTML");var e=t("SCENERY/scenery"),i=e.LiveRegion=function(t,e,i){var n=this;this.property=e,i=i||{},i.tabIndex=i.tabIndex||1,this.element=document.createElement("div"),this.element.setAttribute("aria-live","polite"),this.element.setAttribute("role","region"),this.textNode=document.createTextNode(""),this.element.appendChild(this.textNode),this.listener=function(t){n.element.removeChild(n.textNode),n.textNode=document.createTextNode(t),n.element.appendChild(n.textNode)},e.link(this.listener)};return i.prototype={constructor:e.LiveRegion,dispose:function(){this.property.unlink(this.listener)}},i}),define("SCENERY/util/Instance",["require","SCENERY/scenery","SCENERY/util/AccessibilityPeer","SCENERY/util/LiveRegion"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/AccessibilityPeer"),t("SCENERY/util/LiveRegion");var i=window.has&&window.has("scenery.accessibility");e.Instance=function(t,e,n){this.trail=t,this.layer=e,this.oldLayer=e,this.data={},this.parent=n,this.children=[],this.peers=[],this.liveRegions=[],this.startAffectedLayer=null,this.endAffectedLayer=null,t.setImmutable(),i&&(this.addPeers(),this.addLiveRegions())};var n=e.Instance;return n.prototype={constructor:n,getScene:function(){return this.trail.rootNode()},get scene(){return this.getScene()},getNode:function(){return this.trail.lastNode()},get node(){return this.getNode()},changeLayer:function(t){t!==this.layer&&(this.layer&&(this.layer._instanceCount-=1),this.layer=t,this.layer&&(this.layer._instanceCount+=1))},updateLayer:function(){this.layer!==this.oldLayer&&(this.reindex(),this.oldLayer&&this.oldLayer.removeInstance(this),this.layer&&this.layer.addInstance(this),this.oldLayer=this.layer)},createChild:function(t,i){var n=this.trail.copy().addDescendant(t),s=new e.Instance(n,null,this);return this.insertInstance(i,s),s.getNode().addInstance(s),s},addInstance:function(t){this.children.push(t)},insertInstance:function(t,e){this.children.splice(t,0,e)},removeInstance:function(t){this.children.splice(t,1)},reindex:function(){this.trail.reindex()},dispose:function(){this.layer&&(this.changeLayer(null),this.updateLayer()),this.parent=null,this.children.length=0,this.getNode().removeInstance(this),i&&(this.removePeers(),this.removeLiveRegions())},equals:function(t){return this===t},compare:function(t){return this.trail.compare(t.trail)},getLayerString:function(){return this.layer?this.layer.getName()+"#"+this.layer.getId():"-"},getTrailString:function(){return this.trail.toString()},toString:function(){return"{"+this.getTrailString()+", "+this.getLayerString()+"}"},getAffectedLayers:function(){return this.reindex(),this.getScene().affectedLayers(this.trail)},addPeers:function(){var t=this.getNode(),i=this.getScene(),n=t._peers.length;if(n)for(var s=0;n>s;s++){var r=t._peers[s],o=new e.AccessibilityPeer(this,r.element,r.options);i.addPeer(o),this.peers.push(o)}},removePeers:function(){for(var t=this.getScene(),e=this.peers.length;e--;){var i=this.peers[e];t.removePeer(i),i.dispose()}this.peers.length=0},addLiveRegions:function(){var t=this,i=this.getNode(),n=this.getScene();i._liveRegions.length&&_.each(i._liveRegions,function(i){var s=new e.LiveRegion(t,i.property,i.options);n.addLiveRegion(s),t.liveRegions.push(s)})},removeLiveRegions:function(){var t=this.getScene();_.each(this.liveRegions,function(e){t.removeLiveRegion(e),e.dispose()}),this.peers.length=0},notifyVisibilityChange:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyVisibilityChange(this)},notifyOpacityChange:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyOpacityChange(this)},notifyBeforeSelfChange:function(){this.layer.notifyBeforeSelfChange(this)},notifyBeforeSubtreeChange:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyBeforeSubtreeChange(this)},notifyDirtySelfPaint:function(){this.layer.notifyDirtySelfPaint(this)},notifyDirtySubtreePaint:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyDirtySubtreePaint(this)},notifyDirtySubtreeBounds:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyDirtySubtreeBounds(this)},notifyTransformChange:function(){for(var t=this.getAffectedLayers(),e=t.length;e--;)t[e].notifyTransformChange(this)},notifyBoundsAccuracyChange:function(){this.layer.notifyBoundsAccuracyChange(this)},notifyStitch:function(t){this.getScene().stitch(t)},markForLayerRefresh:function(){this.getScene().markSceneForLayerRefresh(this)},markForInsertion:function(t,e){this.reindex(),this.getScene().markSceneForInsertion(this,t,e)},markForRemoval:function(t,e){this.reindex(),this.getScene().markSceneForRemoval(this,t,e)}},n}),define("SCENERY/util/RenderInterval",["require","SCENERY/scenery","SCENERY/util/Trail"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/Trail"),e.RenderInterval=function(t,e){this.start=t,this.end=e};var i=e.RenderInterval;return i.compareDisjoint=function(t,e){return t.start||e.start?t.start&&e.start?t.start.compare(e.start):t.start?1:-1:0},i.prototype={constructor:i,reindex:function(){this.start&&this.start.reindex(),this.end&&this.end.reindex()},isValidExclusive:function(){return!this.start||!this.end||this.start.compare(this.end)<0},exclusiveUnionable:function(t){return!(this.start&&t.end&&-1!==this.start.compare(t.end)||this.end&&t.start&&1!==this.end.compare(t.start))},exclusiveContains:function(t){return(!this.start||this.start.compare(t)<0)&&(!this.end||this.end.compare(t)>0)},union:function(t){var e=!this.start||t.start&&-1===this.start.compare(t.start),n=!this.end||t.end&&1===this.end.compare(t.end);return new i(e?this.start:t.start,n?this.end:t.end)},toString:function(){return"["+(this.start?this.start.toString():this.start)+","+(this.end?this.end.toString():this.end)+"]"}},i}),define("SCENERY/input/Pointer",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.Pointer=function(){this.listeners=[]};var i=e.Pointer;return i.prototype={constructor:i,addInputListener:function(t){this.listeners.push(t)},removeInputListener:function(t){var e=_.indexOf(this.listeners,t);this.listeners.splice(e,1)}},i}),define("SCENERY/input/Mouse",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/input/Pointer"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/input/Pointer");i.Mouse=function(){n.call(this),this.point=null,this.leftDown=!1,this.middleDown=!1,this.rightDown=!1,this.isMouse=!0,this.trail=null,this.type="mouse"};var s=i.Mouse;return e(n,s,{down:function(t,e){switch(this.point=t,e.button){case 0:this.leftDown=!0;break;case 1:this.middleDown=!0;break;case 2:this.rightDown=!0}},up:function(t,e){switch(this.point=t,e.button){case 0:this.leftDown=!1;break;case 1:this.middleDown=!1;break;case 2:this.rightDown=!1}},move:function(t){this.point=t},over:function(t){this.point=t},out:function(){this.point=null},toString:function(){return"Mouse"}}),s}),define("SCENERY/input/Touch",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/input/Pointer"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/input/Pointer");i.Touch=function(t,e){n.call(this),this.id=t,this.point=e,this.isTouch=!0,this.trail=null,this.type="touch"};var s=i.Touch;return e(n,s,{move:function(t){this.point=t},end:function(t){this.point=t},cancel:function(t){this.point=t},toString:function(){return"Touch#"+this.id}}),s}),define("SCENERY/input/Pen",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/input/Pointer"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/input/Pointer");i.Pen=function(t,e){n.call(this),this.id=t,this.point=e,this.isPen=!0,this.trail=null,this.type="pen"};var s=i.Pen;return e(n,s,{move:function(t){this.point=t},end:function(t){this.point=t},cancel:function(t){this.point=t},toString:function(){return"Pen#"+this.id}}),s}),define("SCENERY/input/Key",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/input/Pointer"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/input/Pointer");i.Key=function(t){n.call(this),this.event=t,this.isKey=!0,this.trail=null,this.type="key"};var s=i.Key;return e(n,s,{}),s}),define("SCENERY/input/Event",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.Event=function(t){this.handled=!1,this.aborted=!1,this.trail=t.trail,this.type=t.type,this.pointer=t.pointer,this.domEvent=t.domEvent,this.currentTarget=t.currentTarget,this.target=t.target};var i=e.Event;return i.prototype={constructor:i,handle:function(){this.handled=!0},abort:function(){this.handled=!0,this.aborted=!0}},i}),define("SCENERY/input/Input",["require","SCENERY/scenery","SCENERY/util/Trail","SCENERY/input/Mouse","SCENERY/input/Touch","SCENERY/input/Pen","SCENERY/input/Key","SCENERY/input/Event"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/Trail"),t("SCENERY/input/Mouse"),t("SCENERY/input/Touch"),t("SCENERY/input/Pen"),t("SCENERY/input/Key"),t("SCENERY/input/Event"),e.Input=function(t,i,n){this.scene=t,this.listenerTarget=i,this.batchDOMEvents=n,this.batchedCallbacks=[],this.mouse=new e.Mouse,this.pointers=[this.mouse],this.listenerReferences=[],this.eventLog=[],this.logEvents=!1};var i=e.Input;return i.prototype={constructor:i,addPointer:function(t){this.pointers.push(t)},removePointer:function(t){for(var e=this.pointers.length-1;e>=0;e--)this.pointers[e]===t&&this.pointers.splice(e,1)},findTouchById:function(t){for(var e=this.pointers.length;e--;){var i=this.pointers[e];if(i.id===t)return i}return void 0},findKeyByEvent:function(t){var e=_.find(this.pointers,function(e){return e.keyCode===t.keyCode&&e.charCode===t.charCode});return e},mouseDown:function(t,e){this.logEvents&&this.eventLog.push("mouseDown("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.mouse.down(t,e),this.downEvent(this.mouse,e)},mouseUp:function(t,e){this.logEvents&&this.eventLog.push("mouseUp("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.mouse.up(t,e),this.upEvent(this.mouse,e)},mouseUpImmediate:function(t,e){this.logEvents&&this.eventLog.push("mouseUpImmediate("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.upImmediateEvent(this.mouse,e)},mouseMove:function(t,e){this.logEvents&&this.eventLog.push("mouseMove("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.mouse.move(t,e),this.moveEvent(this.mouse,e)},mouseOver:function(t,e){this.logEvents&&this.eventLog.push("mouseOver("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.mouse.over(t,e)},mouseOut:function(t,e){this.logEvents&&this.eventLog.push("mouseOut("+i.serializeVector2(t)+","+i.serializeDomEvent(e)+");"),this.mouse.out(t,e)},keyDown:function(t){this.logEvents&&this.eventLog.push("keyDown("+i.serializeDomEvent(t)+");");var n=new e.Key(t);this.addPointer(n);var s=this.scene.getTrailFromKeyboardFocus();this.dispatchEvent(s,"keyDown",n,t,!0)},keyUp:function(t){this.logEvents&&this.eventLog.push("keyUp("+i.serializeDomEvent(t)+");");var e=this.findKeyByEvent(t);if(e){this.removePointer(e);var n=this.scene.getTrailFromKeyboardFocus();this.dispatchEvent(n,"keyUp",e,t,!0)}},keyPress:function(t){this.logEvents&&this.eventLog.push("keyPress("+i.serializeDomEvent(t)+");")},touchStart:function(t,n,s){this.logEvents&&this.eventLog.push("touchStart('"+t+"',"+i.serializeVector2(n)+","+i.serializeDomEvent(s)+");");var r=new e.Touch(t,n,s);this.addPointer(r),this.downEvent(r,s)},touchEnd:function(t,e,n){this.logEvents&&this.eventLog.push("touchEnd('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.end(e,n),this.removePointer(s),this.upEvent(s,n))
},touchEndImmediate:function(t,e,n){this.logEvents&&this.eventLog.push("touchEndImmediate('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&this.upImmediateEvent(s,n)},touchMove:function(t,e,n){this.logEvents&&this.eventLog.push("touchMove('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.move(e,n),this.moveEvent(s,n))},touchCancel:function(t,e,n){this.logEvents&&this.eventLog.push("touchCancel('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.cancel(e,n),this.removePointer(s),this.cancelEvent(s,n))},penStart:function(t,n,s){this.logEvents&&this.eventLog.push("penStart('"+t+"',"+i.serializeVector2(n)+","+i.serializeDomEvent(s)+");");var r=new e.Pen(t,n,s);this.addPointer(r),this.downEvent(r,s)},penEnd:function(t,e,n){this.logEvents&&this.eventLog.push("penEnd('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.end(e,n),this.removePointer(s),this.upEvent(s,n))},penEndImmediate:function(t,e,n){this.logEvents&&this.eventLog.push("penEndImmediate('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&this.upImmediateEvent(s,n)},penMove:function(t,e,n){this.logEvents&&this.eventLog.push("penMove('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.move(e,n),this.moveEvent(s,n))},penCancel:function(t,e,n){this.logEvents&&this.eventLog.push("penCancel('"+t+"',"+i.serializeVector2(e)+","+i.serializeDomEvent(n)+");");var s=this.findTouchById(t);s&&(s.cancel(e,n),this.removePointer(s),this.cancelEvent(s,n))},pointerDown:function(t,e,i,n){switch(e){case"mouse":this.mouseDown(i,n);break;case"touch":this.touchStart(t,i,n);break;case"pen":this.penStart(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}},pointerUp:function(t,e,i,n){switch(e){case"mouse":this.mouseUp(i,n);break;case"touch":this.touchEnd(t,i,n);break;case"pen":this.penEnd(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}},pointerUpImmediate:function(t,e,i,n){switch(e){case"mouse":this.mouseUpImmediate(i,n);break;case"touch":this.touchEndImmediate(t,i,n);break;case"pen":this.penEndImmediate(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}},pointerCancel:function(t,e,i,n){switch(e){case"mouse":console&&console.log&&console.log("WARNING: Pointer mouse cancel was received");break;case"touch":this.touchCancel(t,i,n);break;case"pen":this.penCancel(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}},pointerMove:function(t,e,i,n){switch(e){case"mouse":this.mouseMove(i,n);break;case"touch":this.touchMove(t,i,n);break;case"pen":this.penMove(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}},pointerOver:function(){},pointerOut:function(){},pointerEnter:function(){},pointerLeave:function(){},upEvent:function(t,i){var n=this.scene.trailUnderPointer(t)||new e.Trail(this.scene);this.dispatchEvent(n,"up",t,i,!0),t.isTouch&&this.exitEvents(t,i,n,0,!0),t.trail=n},upImmediateEvent:function(t,i){var n=this.scene.trailUnderPointer(t)||new e.Trail(this.scene);this.dispatchEvent(n,"upImmediate",t,i,!0)},downEvent:function(t,i){var n=this.scene.trailUnderPointer(t)||new e.Trail(this.scene);t.isTouch&&this.enterEvents(t,i,n,0,!0),this.dispatchEvent(n,"down",t,i,!0),t.trail=n},moveEvent:function(t,e){this.branchChangeEvents(t,e,!0)},cancelEvent:function(t,i){var n=this.scene.trailUnderPointer(t)||new e.Trail(this.scene);this.dispatchEvent(n,"cancel",t,i,!0),t.isTouch&&this.exitEvents(t,i,n,0,!0),t.trail=n},branchChangeEvents:function(t,i,n){var s=this.scene.trailUnderPointer(t)||new e.Trail(this.scene),r=t.trail||new e.Trail(this.scene),o=r.lastNode()!==s.lastNode();if(o||n){var a;for(a=0;a<Math.min(s.length,r.length)&&s.nodes[a]===r.nodes[a];a++);n&&this.dispatchEvent(s,"move",t,i,!0),this.exitEvents(t,i,r,a,o),this.enterEvents(t,i,s,a,o),t.trail=s}},enterEvents:function(t,e,i,n,s){if(i.length>n)for(var r=i.length-1;r>=n;r--)this.dispatchEvent(i.slice(0,r+1),"enter",t,e,!1);s&&this.dispatchEvent(i,"over",t,e,!0)},exitEvents:function(t,e,i,n,s){if(s&&this.dispatchEvent(i,"out",t,e,!0),i.length>n)for(var r=n;r<i.length;r++)this.dispatchEvent(i.slice(0,r+1),"exit",t,e,!1)},validatePointers:function(){for(var t=this,e=this.pointers.length;e--;){var i=this.pointers[e];i.point&&t.branchChangeEvents(i,null,!1)}},dispatchEvent:function(t,i,n,s,r){if(!t)try{throw new Error("falsy trail for dispatchEvent")}catch(o){throw console.log(o.stack),o}var a=new e.Event({trail:t,type:i,pointer:n,domEvent:s,currentTarget:null,target:t.lastNode()});this.dispatchToPointer(i,n,a),this.dispatchToTargets(t,n,i,a,r),!t.lastNode().interactive&&!n.isKey&&s&&s.preventDefault&&s.preventDefault()},dispatchToPointer:function(t,e,i){if(!i.aborted&&!i.handled)for(var n=e.type+t,s=e.listeners.slice(0),r=0;r<s.length;r++){var o=s[r],a=!1;if(!a&&o[n]&&(o[n](i),a=i.aborted),!a&&o[t]&&(o[t](i),a=i.aborted),a)return}},dispatchToTargets:function(t,e,i,n,s){if(!n.aborted&&!n.handled)for(var r=e.type+i,o=t.length-1;o>=0;s?o--:o=-1){var a=t.nodes[o];n.currentTarget=a;for(var h=a.getInputListeners(),u=0;u<h.length;u++){var l=h[u],c=!1;if(!c&&l[r]&&(l[r](n),c=n.aborted),!c&&l[i]&&(l[i](n),c=n.aborted),c)return}if(n.handled)return}},addListener:function(t,e,i){var n=this,s="keydown"!==t&&"keyup"!==t&&"keypress"!==t;if(this.batchDOMEvents){var r=function(t){s&&t.preventDefault(),n.batchedCallbacks.push(function(){n.validatePointers(),n.logEvents&&n.eventLog.push("validatePointers();"),e(t)})};this.listenerTarget.addEventListener(t,r,i),this.listenerReferences.push({type:t,callback:r,useCapture:i})}else this.listenerTarget.addEventListener(t,e,i),this.listenerReferences.push({type:t,callback:function(t){n.validatePointers(),n.logEvents&&n.eventLog.push("validatePointers();"),e(t)},useCapture:i})},addImmediateListener:function(t,e,i){this.listenerTarget.addEventListener(t,e,i),this.listenerReferences.push({type:t,callback:function(t){e(t)},useCapture:i})},disposeListeners:function(){var t=this;_.each(this.listenerReferences,function(e){t.listenerTarget.removeEventListener(e.type,e.callback,e.useCapture)})},fireBatchedEvents:function(){if(this.batchedCallbacks.length){for(var t=this.batchedCallbacks.length,e=0;t>e;e++)this.batchedCallbacks[e]();this.batchedCallbacks=[]}}},i.serializeDomEvent=function n(t){var e=[];for(var i in t)if(t.hasOwnProperty(i))if("touches"===i||"targetTouches"===i||"changedTouches"===i){for(var s=[],r=0;r<t[i].length;r++){var o=t[i].item(r);s.push(n(o))}e.push(i+":["+s.join(",")+"]")}else e.push(i+":"+("object"==typeof t[i]&&null!==t[i]?"{}":JSON.stringify(t[i])));return"{"+e.join(",")+"}"},i.serializeVector2=function(t){return"dot("+t.x+","+t.y+")"},i}),define("SCENERY/layers/LayerBoundary",["require","SCENERY/scenery"],function(t){var e=t("SCENERY/scenery");e.LayerBoundary=function(){this.previousLayerType=null,this.nextLayerType=null,this.previousPaintedTrail=null,this.nextPaintedTrail=null};var i=e.LayerBoundary;return i.prototype={constructor:i,hasPrevious:function(){return!!this.previousPaintedTrail},hasNext:function(){return!!this.nextPaintedTrail},reindex:function(){this.previousPaintedTrail&&this.previousPaintedTrail.reindex(),this.nextPaintedTrail&&this.nextPaintedTrail.reindex()},equivalentPreviousTrail:function(t){return this.previousPaintedTrail&&t?(this.previousPaintedTrail.reindex(),this.previousPaintedTrail.equals(t)):this.previousPaintedTrail===t},equivalentNextTrail:function(t){return this.nextPaintedTrail&&t?(this.nextPaintedTrail.reindex(),this.nextPaintedTrail.equals(t)):this.nextPaintedTrail===t},toString:function(){return"boundary:\n    types:    "+(this.previousLayerType?this.previousLayerType.name:"")+" => "+(this.nextLayerType?this.nextLayerType.name:"")+"\n    trails:   "+(this.previousPaintedTrail?this.previousPaintedTrail.getUniqueId():"")+" => "+(this.nextPaintedTrail?this.nextPaintedTrail.getUniqueId():"")}},i}),define("SCENERY/layers/LayerBuilder",["require","SCENERY/scenery","SCENERY/layers/LayerBoundary","SCENERY/util/Trail","SCENERY/util/TrailPointer"],function(t){var e=t("SCENERY/scenery");t("SCENERY/layers/LayerBoundary"),t("SCENERY/util/Trail"),t("SCENERY/util/TrailPointer"),e.LayerBuilder=function(t,i,n,s){this.layerTypeStack=[],this.boundaries=[],this.pendingBoundary=new e.LayerBoundary,this.pendingBoundary.previousLayerType=i,this.pendingBoundary.previousPaintedTrail=n,this.currentLayerType=i,this.layerChangePending=null===n,n?(this.startPointer=new e.TrailPointer(n.copy(),!0),this.startPointer.nestedForwards()):this.startPointer=new e.TrailPointer(new e.Trail(t),!0),this.endPointer=s?new e.TrailPointer(s.copy(),!0):new e.TrailPointer(new e.Trail(t),!1),this.includesEndTrail=null!==s};var i=e.LayerBuilder;return i.prototype={constructor:i,prepareLayerStack:function(){for(var t=new e.TrailPointer(new e.Trail(this.startPointer.trail.rootNode()),!0),i=this.startPointer.trail.length-(this.startPointer.isBefore?1:0);t.trail.length<=i;){var n=t.trail.lastNode();if(n.layerStrategy.hasPreferredLayerType(t,this)&&this.pushPreferredLayerType(n.layerStrategy.getPreferredLayerType(t,this)),!(t.trail.length<this.startPointer.trail.nodes.length))break;t.trail.addDescendant(this.startPointer.trail.nodes[t.trail.length])}},run:function(){var t=this;this.prepareLayerStack(),t.startPointer.depthFirstUntil(t.endPointer,function(e){var i=e.trail.lastNode();e.isBefore?i.layerStrategy.enter(e,t):i.layerStrategy.exit(e,t)},!1),this.includesEndTrail||this.layerChange(null)},layerChange:function(t){this.layerChangePending=!1;var i=this.pendingBoundary;i.nextPaintedTrail=t?t.trail.copy():null,this.boundaries.push(i),this.pendingBoundary=new e.LayerBoundary,this.pendingBoundary.previousLayerType=i.nextLayerType,this.pendingBoundary.previousPaintedTrail=i.nextPaintedTrail},switchToType:function(t,e){this.currentLayerType=e,this.pendingBoundary.nextLayerType=e,this.layerChangePending=!0},markPainted:function(t){this.layerChangePending?this.layerChange(t):this.pendingBoundary.previousPaintedTrail=t.trail.copy()},getCurrentLayerType:function(){return this.currentLayerType},pushPreferredLayerType:function(t){this.layerTypeStack.push(t)},popPreferredLayerType:function(){this.layerTypeStack.pop()},getPreferredLayerType:function(){return 0!==this.layerTypeStack.length?this.layerTypeStack[this.layerTypeStack.length-1]:null},bestPreferredLayerTypeFor:function(t){for(var e=this.layerTypeStack.length-1;e>=0;e--)for(var i=this.layerTypeStack[e],n=t.length;n--;)if(i.supportsRenderer(t[n]))return i;return null}},i}),define("SCENERY/Scene",["require","PHET_CORE/collect","PHET_CORE/inherit","DOT/Bounds2","DOT/Vector2","DOT/Matrix3","KITE/Shape","SCENERY/scenery","SCENERY/nodes/Node","SCENERY/util/Instance","SCENERY/util/Trail","SCENERY/util/RenderInterval","SCENERY/util/TrailPointer","SCENERY/input/Input","SCENERY/layers/LayerBuilder","SCENERY/layers/Renderer","SCENERY/util/Util"],function(t){function e(t){for(var i=t.getNode(),n=i._children.length,s=0;n>s;s++)e(t.createChild(i._children[s],s))}function i(t,e){e.allowSceneOverflow||t.css("overflow","hidden"),t.css("-ms-touch-action","none"),e.allowCSSHacks&&function(){var e=["-webkit-","-moz-","-ms-","-o-",""],i={userSelect:"none",touchCallout:"none",touchAction:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"};_.each(e,function(e){_.each(i,function(i,n){t.css(e+n,i)})})}()}t("PHET_CORE/collect");var n=t("PHET_CORE/inherit"),s=t("DOT/Bounds2"),r=t("DOT/Vector2"),o=t("DOT/Matrix3"),a=t("KITE/Shape"),h=t("SCENERY/scenery"),u=t("SCENERY/nodes/Node");t("SCENERY/util/Instance"),t("SCENERY/util/Trail"),t("SCENERY/util/RenderInterval"),t("SCENERY/util/TrailPointer"),t("SCENERY/input/Input"),t("SCENERY/layers/LayerBuilder"),t("SCENERY/layers/Renderer");var l=t("SCENERY/util/Util");l.objectCreate;var c=window.has&&window.has("scenery.accessibility"),d=!0;h.Scene=function(t,e){this.$main=t,this.main=t[0],this.main.scene=this,this.scenery=h,e=_.extend({allowSceneOverflow:!1,allowCSSHacks:!0,allowDevicePixelRatioScaling:!1,enablePointerEvents:!0,preferredSceneLayerType:h.CanvasDefaultLayerType,width:t.width(),height:t.height()},e||{}),this.backingScale=e.allowDevicePixelRatioScaling?l.backingScale(document.createElement("canvas").getContext("2d")):1,this.enablePointerEvents=e.enablePointerEvents,u.call(this,e);var n=this;window.debugScene=n,this.layers=[],this.layerChangeIntervals=[],this.lastCursor=null,this.defaultCursor=t.css("cursor"),this.setSize(e.width,e.height),this.sceneBounds=new s(0,0,e.width,e.height),this.rootInstance=new h.Instance(new h.Trail(this),null,null),this.addInstance(this.rootInstance),this.preferredSceneLayerType=e.preferredSceneLayerType,i(t,e),c&&(this.activePeer=null,this.accessibilityLayer=document.createElement("div"),this.accessibilityLayer.className="accessibility-layer",this.accessibilityLayer.style.zIndex=-1,this.accessibilityLayer.style.position="relative",t[0].appendChild(this.accessibilityLayer),this.focusRingSVGContainer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.focusRingSVGContainer.style.position="absolute",this.focusRingSVGContainer.style.top=0,this.focusRingSVGContainer.style.left=0,this.focusRingSVGContainer.style["pointer-events"]="none",this.resizeFocusRingSVGContainer(e.width,e.height),this.focusRingPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.focusRingPath.setAttribute("style","fill: none; stroke: blue; stroke-width: 5;"),this.focusRingPath.setAttribute("id","p1"),this.focusRingSVGContainer.appendChild(this.focusRingPath),t[0].appendChild(this.focusRingSVGContainer),this.updateFocusRing=function(){n.focusRingPath.setAttribute("d",a.bounds(n.activePeer.getGlobalBounds()).getSVGPath())},this.liveRegionLayer=document.createElement("div"),this.liveRegionLayer.className="live-region-layer",this.liveRegionLayer.style.zIndex=-2,this.liveRegionLayer.style.position="relative",t[0].appendChild(this.liveRegionLayer))};var f=h.Scene;return n(u,f,{updateScene:function(t){var e=this;if(this.input&&this.input.validatePointers(),this.validateBounds(),this.validatePaint(),this.layers.length){for(var i=this.layers.length;i--;)this.layers[i].render(e,t);this.updateCursor()}},renderScene:function(){this.updateScene()},addPeer:function(t){this.accessibilityLayer.appendChild(t.peerElement)},removePeer:function(t){this.accessibilityLayer.removeChild(t.peerElement)},addLiveRegion:function(t){this.liveRegionLayer.appendChild(t.element)},removeLiveRegion:function(t){this.liveRegionLayer.removeChild(t.element)},setActivePeer:function(t){this.activePeer!==t&&(this.activePeer&&this.activePeer.instance.node.removeEventListener("bounds",this.updateFocusRing),this.activePeer=t,t?(this.activePeer.instance.node.addEventListener("bounds",this.updateFocusRing),this.updateFocusRing()):this.focusRingPath.setAttribute("d","M 0 0"))},getActivePeer:function(){return this.activePeer},focusPeer:function(t){this.setActivePeer(t)},blurPeer:function(t){this.setActivePeer(null)},markInterval:function(t){t.reindex();for(var e=t.previousPainted(),i=new h.TrailPointer(t.copy(),!1);i.hasTrail()&&(!i.isBefore||!i.trail.isPainted());)i.nestedForwards();var n=i.trail;this.addLayerChangeInterval(new h.RenderInterval(e,n))},addLayerChangeInterval:function(t){for(var e=0;e<this.layerChangeIntervals.length;e++){var i=this.layerChangeIntervals[e];i.reindex(),t.exclusiveUnionable(i)&&(t=t.union(i),this.layerChangeIntervals.splice(e--,1))}this.layerChangeIntervals.push(t)},createLayer:function(t,e,i,n){var s=t.createLayer(_.extend({startBoundary:i,endBoundary:n},e));return s.type=t,s},insertLayer:function(t){for(var e=0;e<this.layers.length;e++)if(t.endPaintedTrail.isBefore(this.layers[e].startPaintedTrail))return this.layers.splice(e,0,t),void 0;this.layers.push(t)},getBoundaries:function(){return[this.layers[0].startBoundary].concat(_.pluck(this.layers,"endBoundary"))},calculateBoundaries:function(t,e,i){var n=new h.LayerBuilder(this,t,e,i);return this.preferredSceneLayerType&&n.pushPreferredLayerType(this.preferredSceneLayerType),n.run(),n.boundaries},stitch:function(t){var e,i=this;if(this.layerChangeIntervals.length){var n={affectedInstances:[],newLayers:[]},s={$main:this.$main,scene:this,baseNode:this};for(e=this.layerChangeIntervals.length;e--;)this.layerChangeIntervals[e].reindex();for(this.layerChangeIntervals.sort(h.RenderInterval.compareDisjoint),e=0;e<this.layerChangeIntervals.length;e++){var r=this.layerChangeIntervals[e],o=r.start,a=r.end,u=o?o.getInstance():null,l=a?a.getInstance():null,c=u?u.layer:null,d=l?l.layer:null,f=this.calculateBoundaries(c?c.type:null,o,a);this.stitchInterval(n,s,o,a,c,d,f,t)}for(this.layerChangeIntervals.length=0,e=this.layers.length;e--;){var m=this.layers[e];m.startBoundary.reindex(),m.endBoundary.reindex(),0===m._instanceCount&&this.disposeLayer(m)}for(e=n.newLayers.length;e--;){var p=n.newLayers[e];p.startBoundary.reindex(),p.endBoundary.reindex(),i.insertLayer(p)}this.reindexLayers();var g=n.affectedInstances.length;for(e=0;g>e;e++)n.affectedInstances[e].updateLayer()}},stitchInterval:function(t,e,i,n,s,r,o,a){function u(){for(var e=w.length,i=0;e>i;i++){var n=w[i];n.changeLayer(C),t.affectedInstances.push(n)}w.length=0}function l(i,n){C=g.createLayer(x,e,i,n),t.newLayers.push(C)}function c(t,e){if(t&&t.setImmutable(),T&&T.equivalentPreviousTrail(b)&&((C||R)&&(C?C.setEndBoundary(T):P?(P.setStartBoundary(R),P.setEndBoundary(T),C=P):l(R,T),u()),C=null,x=T.nextLayerType,R=T,P=null,S++,T=o[S]),t&&!e&&w.push(t.getInstance()),a&&!e){var i=t.getInstance().layer;i.type!==x||d||(P=i)}b=t}function f(t){}function m(t){c(t,!1)}function p(e){if(c(e,!0),s!==r&&0===o.length){s.setEndBoundary(r.endBoundary),C=s,u();for(var i=r._layerTrails.length,a=0;i>a;a++){var d=r._layerTrails[a];d.reindex();var f=d.getInstance();f.changeLayer(s),t.affectedInstances.push(f)}}else s&&s===r&&o.length>0?(l(R,v),u(),C.endPaintedTrail.reindex(),h.Trail.eachPaintedTrailBetween(n,C.endPaintedTrail,function(e){var i=e.getInstance();i.changeLayer(C),t.affectedInstances.push(i)},!1,g)):(s||r||1!==o.length||o[0].hasNext()||o[0].hasPrevious())&&(C=r,C&&R&&C.setStartBoundary(R),u())}var g=this;i&&i.setImmutable(),n&&n.setImmutable();var v=r?r.endBoundary:null;s?_.indexOf(this.layers,s):-1,r?_.indexOf(this.layers,r):this.layers.length;var y=i?new h.TrailPointer(i,!0):new h.TrailPointer(new h.Trail(this),!0),E=n?new h.TrailPointer(n,!0):new h.TrailPointer(new h.Trail(this),!1),S=0,T=o[S],w=[],b=i,C=s,x=s?s.type:null,R=null,P=null;f(i),y.eachTrailBetween(E,function(t){!t.isPainted()||i&&t.equals(i)||m(t.copy())}),p(n)},rebuildLayers:function(){this.markInterval(new h.Trail(this)),this.stitch(!0)},reindexLayers:function(){var t=1;c&&this.accessibiltyLayer&&(this.accessibilityLayer.style.zIndex=9999,t++);for(var e=this.layers.length,i=0;e>i;i++)t=this.layers[i].reindex(t);c&&this.focusRingSVGContainer&&(this.focusRingSVGContainer.style.zIndex=t)},dispose:function(){this.disposeLayers(),this.input&&this.input.disposeListeners(),delete this.main.scene},disposeLayer:function(t){t.dispose(),this.layers.splice(_.indexOf(this.layers,t),1)},disposeLayers:function(){for(var t=this.layers.length;t--;)this.disposeLayer(this.layers[t])},affectedLayers:function(t){var e=this.layers.length;if(0===e)return[];for(var i,n=new h.TrailPointer(t,!0),s=new h.TrailPointer(t,!1),r=this.layers,o=-1,a=e;a-1>o;){i=a+o>>1;var u=r[i].endPaintedTrail,l=1!==n.compareNested(new h.TrailPointer(u,!0));l?a=i:o=i}var c=a;for(o=-1,a=e;a-1>o;){i=a+o>>1;var d=r[i].startPaintedTrail;d.reindex();var f=-1!==s.compareNested(new h.TrailPointer(d,!0));f?o=i:a=i}var m=o;return r.slice(c,m+1)},renderToCanvas:function(t,e,i){var n=0,s=!1,r={increment:function(){n++},decrement:function(){n--,0===n&&i&&s&&i()}};e.clearRect(0,0,t.width,t.height);for(var o=this.layers.length,a=0;o>a;a++)this.layers[a].renderToCanvas(t,e,r);0===n?i&&i():s=!0},canvasDataURL:function(t){this.canvasSnapshot(function(e){t(e.toDataURL())})},canvasSnapshot:function(t){var e=document.createElement("canvas");e.width=this.sceneBounds.getWidth(),e.height=this.sceneBounds.getHeight();var i=e.getContext("2d");this.renderToCanvas(e,i,function(){t(e,i.getImageData(0,0,e.width,e.height))})},setSize:function(t,e){this.$main.width(t),this.$main.height(e),this.$main.css("clip","rect(0px,"+t+"px,"+e+"px,0px)"),this.sceneBounds=new s(0,0,t,e)},resize:function(t,e){(this.sceneBounds.width!==t||this.sceneBounds.height!==e)&&(this.setSize(t,e),this.rebuildLayers(),c&&(this.resizeAccessibilityLayer(t,e),this.resizeFocusRingSVGContainer(t,e),this.updateFocusRing&&this.activePeer&&this.updateFocusRing()),this.input&&this.input.validatePointers(),this.fireEvent("resize",{width:t,height:e}))},resizeAccessibilityLayer:function(t,e){this.accessibilityLayer&&(this.accessibilityLayer.setAttribute("width",t),this.accessibilityLayer.setAttribute("height",e),this.accessibilityLayer.style.clip="rect(0px,"+t+"px,"+e+"px,0px)")},resizeFocusRingSVGContainer:function(t,e){this.focusRingSVGContainer&&(this.focusRingSVGContainer.setAttribute("width",t),this.focusRingSVGContainer.setAttribute("height",e),this.focusRingSVGContainer.style.clip="rect(0px,"+t+"px,"+e+"px,0px)")},getSceneWidth:function(){return this.sceneBounds.getWidth()},getSceneHeight:function(){return this.sceneBounds.getHeight()},markSceneForLayerRefresh:function(t){this.markInterval(t.trail)},markSceneForInsertion:function(t,i,n){var s=t.trail.copy().addDescendant(i),r=t.createChild(i,n);e(r),this.markInterval(s)},markSceneForRemoval:function(t,e,i){var n=t.trail.copy().addDescendant(e);this.markInterval(n);var s=[t.children[i]];for(t.removeInstance(i);s.length;){var r=s.pop();Array.prototype.push.apply(s,r.children),r.dispose()}},updateCursor:function(){if(this.input&&this.input.mouse.point){var t=this.trailUnderPoint(this.input.mouse.point,{isMouse:!0});if(t)for(var e=t.length-1;e>=0;e--){var i=t.nodes[e].getCursor();if(i)return this.setSceneCursor(i),void 0}}this.setSceneCursor(this.defaultCursor)},setSceneCursor:function(t){t!==this.lastCursor&&(this.lastCursor=t,this.$main.css("cursor",t))},updateOnRequestAnimationFrame:function(t){var e=this;!function i(){window.requestAnimationFrame(i,t),e.updateScene()}()},initializeStandaloneEvents:function(t){var e=this.$main[0];this.initializeEvents(_.extend({},{listenerTarget:e,pointFromEvent:function(t){var i=e.getBoundingClientRect();return new r(t.clientX-i.left,t.clientY-i.top)}},t))},initializeFullscreenEvents:function(t){var e=this.$main[0];this.initializeEvents(_.extend({},{listenerTarget:document,pointFromEvent:function(t){var i=e.getBoundingClientRect();return new r(t.clientX-i.left,t.clientY-i.top)}},t))},initializeWindowEvents:function(t){var e=this.$main[0];this.initializeEvents(_.extend({},{listenerTarget:window,pointFromEvent:function(t){var i=e.getBoundingClientRect();return new r(t.clientX-i.left,t.clientY-i.top)}},t))},initializeEvents:function(t){function e(t){return t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?"touch":t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_PEN?"pen":t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?"mouse":t.pointerType}function i(t,e){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches.item(i);e(n.identifier,s(n))}}var n=this;if(n.input)throw new Error("Attempt to attach events twice to the scene");var s=t.pointFromEvent,r=t.listenerTarget,o=t.batchDOMEvents,a=new h.Input(n,r,!!o);n.input=a;var u=window.navigator&&window.navigator.pointerEnabled,l=window.navigator&&window.navigator.msPointerEnabled;this.enablePointerEvents&&u?(a.addListener("pointerdown",function(t){a.pointerDown(t.pointerId,t.pointerType,s(t),t)}),a.addListener("pointerup",function(t){a.pointerUp(t.pointerId,t.pointerType,s(t),t)}),a.addListener("pointermove",function(t){a.pointerMove(t.pointerId,t.pointerType,s(t),t)}),a.addListener("pointerover",function(t){a.pointerOver(t.pointerId,t.pointerType,s(t),t)}),a.addListener("pointerout",function(t){a.pointerOut(t.pointerId,t.pointerType,s(t),t)}),a.addListener("pointercancel",function(t){a.pointerCancel(t.pointerId,t.pointerType,s(t),t)}),a.addImmediateListener("pointerup",function(t){a.pointerUpImmediate(t.pointerId,t.pointerType,s(t),t)})):this.enablePointerEvents&&l?(a.addListener("MSPointerDown",function(t){a.pointerDown(t.pointerId,e(t),s(t),t)}),a.addListener("MSPointerUp",function(t){a.pointerUp(t.pointerId,e(t),s(t),t)}),a.addListener("MSPointerMove",function(t){a.pointerMove(t.pointerId,e(t),s(t),t)}),a.addListener("MSPointerOver",function(t){a.pointerOver(t.pointerId,e(t),s(t),t)}),a.addListener("MSPointerOut",function(t){a.pointerOut(t.pointerId,e(t),s(t),t)}),a.addListener("MSPointerCancel",function(t){a.pointerCancel(t.pointerId,e(t),s(t),t)}),a.addImmediateListener("MSPointerUp",function(t){a.pointerUpImmediate(t.pointerId,e(t),s(t),t)})):(a.addListener("mousedown",function(t){a.mouseDown(s(t),t)}),a.addListener("mouseup",function(t){a.mouseUp(s(t),t)}),a.addListener("mousemove",function(t){a.mouseMove(s(t),t)}),a.addListener("mouseover",function(t){a.mouseOver(s(t),t)}),a.addListener("mouseout",function(t){a.mouseOut(s(t),t)}),a.addImmediateListener("mouseup",function(t){a.mouseUpImmediate(s(t),t)}),a.addListener("touchstart",function(t){i(t,function(e,i){a.touchStart(e,i,t)})}),a.addListener("touchend",function(t){i(t,function(e,i){a.touchEnd(e,i,t)})}),a.addListener("touchmove",function(t){i(t,function(e,i){a.touchMove(e,i,t)})}),a.addListener("touchcancel",function(t){i(t,function(e,i){a.touchCancel(e,i,t)})}),a.addImmediateListener("touchend",function(t){i(t,function(e,i){a.touchEndImmediate(e,i,t)})})),a.addListener("keyup",function(t){a.keyUp(t)}),a.addListener("keydown",function(t){a.keyDown(t)}),a.addListener("keypress",function(t){a.keyPress(t)})},getTrailFromKeyboardFocus:function(){return new h.Trail(this)},fireBatchedEvents:function(){this.input.fireBatchedEvents()},resizeOnWindowResize:function(){var t=this,e=function(){t.resize(window.innerWidth,window.innerHeight)};$(window).resize(e),e()},layerAudit:function(){var t=this,e=(this.calculateBoundaries(null,null,null),0);new h.Trail(this).eachTrailUnder(function(t){t.isPainted()&&e++});var i=0;_.each(this.layers,function(t){i+=t.getLayerTrails().length,t.startPaintedTrail.reindex(),t.endPaintedTrail.reindex()});var n=0;_.each(this.layers,function(e){var i=0;h.Trail.eachPaintedTrailBetween(e.startPaintedTrail,e.endPaintedTrail,function(){i++},!1,t),n+=i}),_.each(this.layers,function(t){});for(var s=1;s<this.layers.length;s++);return _.each(this.layers,function(e){var i=e.getLayerTrails(),n=[];h.Trail.eachPaintedTrailBetween(e.startPaintedTrail,e.endPaintedTrail,function(t){n.push(t.copy())},!1,t),_.each(i,function(t){}),h.Trail.eachTrailBetween(e.startPaintedTrail,e.endPaintedTrail,function(t){{t.lastNode()}},!1,t)}),new h.Trail(this).eachTrailUnder(function(t){var e,i;if(t.lastNode().layerSplitBefore&&(e=t.previousPainted(),i=t.lastNode().isPainted()?t:t.nextPainted()),t.lastNode().layerSplitAfter){for(var n=new h.TrailPointer(t.copy(),!1);n&&n.isAfter;)n=n.nestedForwards();n&&(e=n.trail.previousPainted(),i=n.trail.lastNode().isPainted()?n.trail:n.trail.nextPainted())}}),!0},getDebugHTML:function(){function t(t){return t?t.toString():t}var e=new h.TrailPointer(new h.Trail(this),!0),i=new h.TrailPointer(new h.Trail(this),!1),n=0,s="",r={},a={};return _.each(this.layers,function(e){var i=e.startPaintedTrail.getUniqueId(),n=e.endPaintedTrail.getUniqueId();r[i]="",a[n]="",e.startPaintedTrail.reindex(),e.endPaintedTrail.reindex();var s=e.getId()+" <strong>"+e.type.name+"</strong>"+" trails: "+(e.startPaintedTrail?t(e.startPaintedTrail):e.startPaintedTrail)+","+(e.endPaintedTrail?t(e.endPaintedTrail):e.endPaintedTrail);s+='<span style="color: #008">',e.canUseDirtyRegions&&!e.canUseDirtyRegions()&&(s+=" dirtyRegionsDisabled"),e.cssTranslation&&(s+=" cssTranslation"),e.cssRotation&&(s+=" cssTranslation"),e.cssScale&&(s+=" cssTranslation"),e.cssTransform&&(s+=" cssTranslation"),e.dirtyBounds&&e.dirtyBounds.isFinite()&&(s+=" dirtyBounds:"+e.dirtyBounds.toString()),s+="</span>",r[i]+='<div style="color: #080">+Layer '+s+"</div>",a[n]+='<div style="color: #800">-Layer '+s+"</div>"}),e.depthFirstUntil(i,function(e){function i(t){h+=' <span style="color: #008">'+t+"</span>"}var h;t(e);var u=e.trail.lastNode();if(e.isBefore&&r[e.trail.getUniqueId()]&&(s+=r[e.trail.getUniqueId()]),e.isBefore){h='<div style="margin-left: '+20*n+'px">',u.constructor.name&&(h+=" "+u.constructor.name),h+=' <span style="font-weight: '+(u.isPainted()?"bold":"normal")+'">'+e.trail.lastNode().getId()+"</span>",h+=' <span style="color: #888">'+t(e.trail)+"</span>",u._visible||i("invisible"),u._pickable||i("unpickable"),u._clipShape&&i("clipShape"),u._renderer&&i("renderer:"+u._renderer.name),u._rendererOptions,u._layerSplitBefore&&i("layerSplitBefore"),u._layerSplitAfter&&i("layerSplitAfter"),u._opacity<1&&i("opacity:"+u._opacity);var l="";switch(u.transform.getMatrix().type){case o.Types.IDENTITY:l="";break;case o.Types.TRANSLATION_2D:l="translated";break;case o.Types.SCALING:l="scale";break;case o.Types.AFFINE:l="affine";break;case o.Types.OTHER:l="other"}l&&(h+=' <span style="color: #88f" title="'+u.transform.getMatrix().toString().replace("\n","&#10;")+'">'+l+"</span>"),h+="</div>",s+=h}e.isAfter&&a[e.trail.getUniqueId()]&&(s+=a[e.trail.getUniqueId()]),n+=e.isBefore?1:-1},!1),s},popupDebug:function(){var t='<!DOCTYPE html><html lang="en"><head><title>Scenery Debug Snapshot</title></head><body>'+this.getDebugHTML()+"</body>"+"</html>";window.open("data:text/html;charset=utf-8,"+encodeURIComponent(t))},getBasicConstructor:function(t){return"new scenery.Scene( $( '#main' ), {"+t+"} )"},toStringWithChildren:function(t){function e(t){return t===i?"scene":t.constructor.name.toLowerCase()+t.id}var i=this,n="",s=this.getTopologicallySortedNodes().slice(0).reverse();return _.each(s,function(s){if(n&&(n+="\n"),t&&s===i){var r=i.getPropString("  ",!1);n+="scene.mutate( {"+(r?"\n"+r+"\n":"")+"} )"}else n+="var "+e(s)+" = "+s.toString("",!1);_.each(s.children,function(t){n+="\n"+e(s)+".addChild( "+e(t)+" );"})}),n}}),f}),define("SCENERY/nodes/Rectangle",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/nodes/Path","KITE/Shape","DOT/Vector2"],function(t){function e(t){var e="getRect"+t,i="setRect"+t,n="_rect"+t;o.prototype[e]=function(){return this[n]},o.prototype[i]=function(t){return this[n]=t,this.invalidateRectangle(),this},Object.defineProperty(o.prototype,"rect"+t,{set:o.prototype[i],get:o.prototype[e]})}var i=t("PHET_CORE/inherit"),n=t("SCENERY/scenery"),s=t("SCENERY/nodes/Path"),r=t("KITE/Shape");t("DOT/Vector2"),n.Rectangle=function(t,e,i,n,r,o,a){"object"==typeof t?a=t:arguments.length<6?(this._rectX=t,this._rectY=e,this._rectWidth=i,this._rectHeight=n,this._rectArcWidth=0,this._rectArcHeight=0,a=r||{},a.shape=this.createRectangleShape()):(this._rectX=t,this._rectY=e,this._rectWidth=i,this._rectHeight=n,this._rectArcWidth=r,this._rectArcHeight=o,a=a||{},a.shape=this.createRectangleShape()),s.call(this,a)};var o=n.Rectangle;return i(s,o,{setRect:function(t,e,i,n,s,r){this._rectX=t,this._rectY=e,this._rectWidth=i,this._rectHeight=n,this._rectArcWidth=s||0,this._rectArcHeight=r||0,this.invalidateRectangle()},isRounded:function(){return 0!==this._rectArcWidth&&0!==this._rectArcHeight},createRectangleShape:function(){if(this.isRounded()){var t=Math.min(this._rectWidth/2,this._rectHeight/2);return r.roundRectangle(this._rectX,this._rectY,this._rectWidth,this._rectHeight,Math.min(t,this._rectArcWidth),Math.min(t,this._rectArcHeight))}return r.rectangle(this._rectX,this._rectY,this._rectWidth,this._rectHeight)},invalidateRectangle:function(){this.setShape(this.createRectangleShape())},computeShapeBounds:function(){return this._stroke?this._shape.bounds.dilated(this._lineDrawingStyles.lineWidth/2):this._shape.bounds
},containsPointSelf:function(t){var e=t.x>=this._rectX&&t.x<=this._rectX+this._rectWidth&&t.y>=this._rectY&&t.y<=this._rectY+this._rectHeight;if(!e||!this.isRounded())return e;var i,n,s=!1;if(t.x<this._rectX+this._rectWidth/2?(i=this._rectX+this._rectArcWidth,s=s||t.x>=i):(i=this._rectX+this._rectWidth-this._rectArcWidth,s=s||t.x<=i),s)return!0;if(t.y<this._rectY+this._rectHeight/2?(n=this._rectY+this._rectArcHeight,s=s||t.y>=n):(n=this._rectY+this._rectHeight-this._rectArcHeight,s=s||t.y<=n),s)return!0;var r=t.x-i,o=t.y-n;return r/=this._rectArcWidth,o/=this._rectArcHeight,r*=r,o*=o,1>=r+o},paintCanvas:function(t){var e=t.context;return this.isRounded()?s.prototype.paintCanvas.call(this,t):(this._fill&&(this.beforeCanvasFill(t),e.fillRect(this._rectX,this._rectY,this._rectWidth,this._rectHeight),this.afterCanvasFill(t)),this._stroke&&(this.beforeCanvasStroke(t),e.strokeRect(this._rectX,this._rectY,this._rectWidth,this._rectHeight),this.afterCanvasStroke(t)),void 0)},createSVGFragment:function(){return document.createElementNS("http://www.w3.org/2000/svg","rect")},updateSVGFragment:function(t){t.setAttribute("x",this._rectX),t.setAttribute("y",this._rectY),t.setAttribute("width",this._rectWidth),t.setAttribute("height",this._rectHeight),t.setAttribute("rx",this._rectArcWidth),t.setAttribute("ry",this._rectArcHeight),t.setAttribute("style",this.getSVGFillStyle()+this.getSVGStrokeStyle())},getBasicConstructor:function(t){return"new scenery.Rectangle( "+this._rectX+", "+this._rectY+", "+this._rectWidth+", "+this._rectHeight+", "+this._rectArcWidth+", "+this._rectArcHeight+", {"+t+"} )"}}),e("X"),e("Y"),e("Width"),e("Height"),e("ArcWidth"),e("ArcHeight"),o.prototype._mutatorKeys=["rectX","rectY","rectWidth","rectHeight","rectArcWidth","rectArcHeight"].concat(s.prototype._mutatorKeys),o}),define("SCENERY/input/SimpleDragHandler",["require","DOT/Matrix3","SCENERY/scenery"],function(t){t("DOT/Matrix3");var e=t("SCENERY/scenery");e.SimpleDragHandler=function(t){var e=this;this.options=_.extend({allowTouchSnag:!1,mouseButton:0},t),this.dragging=!1,this.pointer=null,this.trail=null,this.transform=null,this.node=null,this.lastDragPoint=null,this.startTransformMatrix=null,this.mouseButton=void 0,this.transformListener={transform:function(t){if(e.trail.isExtensionOf(t.trail,!0)){var i=t.trail.getTransform().getMatrix(),n=e.transform.getMatrix();e.node.prependMatrix(i.inverted().timesMatrix(n)),e.transform.set(i)}}},this.dragListener={up:function(t){t.pointer.isMouse&&t.domEvent.button!==e.mouseButton||e.endDrag(t)},cancel:function(t){e.endDrag(t),e.node.setMatrix(e.startTransformMatrix)},move:function(t){var i=e.transform.inverseDelta2(e.pointer.point.minus(e.lastDragPoint));if(e.options.translate){var n=e.node.getTransform().getMatrix().getTranslation();e.options.translate({delta:i,oldPosition:n,position:n.plus(i)})}else e.node.translate(i,!0);e.lastDragPoint=e.pointer.point,e.options.drag&&e.options.drag(t,e.trail)}}};var i=e.SimpleDragHandler;return i.prototype={constructor:i,startDrag:function(t){t.pointer.dragging=!0,t.pointer.addInputListener(this.dragListener),this.dragging=!0,this.pointer=t.pointer,this.trail=t.trail.subtrailTo(t.currentTarget,!0),this.transform=this.trail.getTransform(),this.node=t.currentTarget,this.lastDragPoint=t.pointer.point,this.startTransformMatrix=t.currentTarget.getMatrix(),this.mouseButton=t.pointer.isMouse?t.domEvent.button:void 0,this.options.start&&this.options.start(t,this.trail)},endDrag:function(t){this.pointer.dragging=!1,this.pointer.removeInputListener(this.dragListener),this.dragging=!1,this.options.end&&this.options.end(t,this.trail)},tryToSnag:function(t){t.pointer.isMouse&&t.domEvent&&this.options.mouseButton!==t.domEvent.button&&-1!==this.options.mouseButton||this.dragging||t.pointer.dragging||this.startDrag(t)},down:function(t){this.tryToSnag(t)},touchenter:function(t){this.options.allowTouchSnag&&this.tryToSnag(t)}},i}),define("SUN/FontAwesomeNode",["require","SCENERY/nodes/Image","SCENERY/nodes/VBox","SCENERY/nodes/DOM","SCENERY/nodes/Node","SCENERY/nodes/HBox","SCENERY/Scene","SCENERY/nodes/Text","SCENERY/nodes/Path","SCENERY/nodes/Rectangle","KITE/Shape","SCENERY/input/SimpleDragHandler","DOT/Bounds2","DOT/Matrix3","PHET_CORE/inherit"],function(t){function e(t,e){e=_.extend({fill:"#000",pickable:!1},e),e=_.extend(e,{shape:new n(o[t]),matrix:new s(.025,0,0,0,-.025,0,0,0,1)}),i.call(this,e)}t("SCENERY/nodes/Image"),t("SCENERY/nodes/VBox"),t("SCENERY/nodes/DOM"),t("SCENERY/nodes/Node"),t("SCENERY/nodes/HBox"),t("SCENERY/Scene"),t("SCENERY/nodes/Text");var i=t("SCENERY/nodes/Path");t("SCENERY/nodes/Rectangle");var n=t("KITE/Shape");t("SCENERY/input/SimpleDragHandler"),t("DOT/Bounds2");var s=t("DOT/Matrix3"),r=t("PHET_CORE/inherit"),o={fullscreen:"M1283 995l-355 -355l355 -355l144 144q29 31 70 14q39 -17 39 -59v-448q0 -26 -19 -45t-45 -19h-448q-42 0 -59 40q-17 39 14 69l144 144l-355 355l-355 -355l144 -144q31 -30 14 -69q-17 -40 -59 -40h-448q-26 0 -45 19t-19 45v448q0 42 40 59q39 17 69 -14l144 -144 l355 355l-355 355l-144 -144q-19 -19 -45 -19q-12 0 -24 5q-40 17 -40 59v448q0 26 19 45t45 19h448q42 0 59 -40q17 -39 -14 -69l-144 -144l355 -355l355 355l-144 144q-31 30 -14 69q17 40 59 40h448q26 0 45 -19t19 -45v-448q0 -42 -39 -59q-13 -5 -25 -5q-26 0 -45 19z",reorder:"M1536 192v-128q0 -26 -19 -45t-45 -19h-1408q-26 0 -45 19t-19 45v128q0 26 19 45t45 19h1408q26 0 45 -19t19 -45zM1536 704v-128q0 -26 -19 -45t-45 -19h-1408q-26 0 -45 19t-19 45v128q0 26 19 45t45 19h1408q26 0 45 -19t19 -45zM1536 1216v-128q0 -26 -19 -45 t-45 -19h-1408q-26 0 -45 19t-19 45v128q0 26 19 45t45 19h1408q26 0 45 -19t19 -45z",home:"M1408 544v-480q0 -26 -19 -45t-45 -19h-384v384h-256v-384h-384q-26 0 -45 19t-19 45v480q0 1 0.5 3t0.5 3l575 474l575 -474q1 -2 1 -6zM1631 613l-62 -74q-8 -9 -21 -11h-3q-13 0 -21 7l-692 577l-692 -577q-12 -8 -24 -7q-13 2 -21 11l-62 74q-8 10 -7 23.5t11 21.5 l719 599q32 26 76 26t76 -26l244 -204v195q0 14 9 23t23 9h192q14 0 23 -9t9 -23v-408l219 -182q10 -8 11 -21.5t-7 -23.5z",volume_off:"M768 1184v-1088q0 -26 -19 -45t-45 -19t-45 19l-333 333h-262q-26 0 -45 19t-19 45v384q0 26 19 45t45 19h262l333 333q19 19 45 19t45 -19t19 -45z",volume_up:"M768 1184v-1088q0 -26 -19 -45t-45 -19t-45 19l-333 333h-262q-26 0 -45 19t-19 45v384q0 26 19 45t45 19h262l333 333q19 19 45 19t45 -19t19 -45zM1152 640q0 -76 -42.5 -141.5t-112.5 -93.5q-10 -5 -25 -5q-26 0 -45 18.5t-19 45.5q0 21 12 35.5t29 25t34 23t29 35.5 t12 57t-12 57t-29 35.5t-34 23t-29 25t-12 35.5q0 27 19 45.5t45 18.5q15 0 25 -5q70 -27 112.5 -93t42.5 -142zM1408 640q0 -153 -85 -282.5t-225 -188.5q-13 -5 -25 -5q-27 0 -46 19t-19 45q0 39 39 59q56 29 76 44q74 54 115.5 135.5t41.5 173.5t-41.5 173.5 t-115.5 135.5q-20 15 -76 44q-39 20 -39 59q0 26 19 45t45 19q13 0 26 -5q140 -59 225 -188.5t85 -282.5zM1664 640q0 -230 -127 -422.5t-338 -283.5q-13 -5 -26 -5q-26 0 -45 19t-19 45q0 36 39 59q7 4 22.5 10.5t22.5 10.5q46 25 82 51q123 91 192 227t69 289t-69 289 t-192 227q-36 26 -82 51q-7 4 -22.5 10.5t-22.5 10.5q-39 23 -39 59q0 26 19 45t45 19q13 0 26 -5q211 -91 338 -283.5t127 -422.5z",check:"M1408 606v-318q0 -119 -84.5 -203.5t-203.5 -84.5h-832q-119 0 -203.5 84.5t-84.5 203.5v832q0 119 84.5 203.5t203.5 84.5h832q63 0 117 -25q15 -7 18 -23q3 -17 -9 -29l-49 -49q-10 -10 -23 -10q-3 0 -9 2q-23 6 -45 6h-832q-66 0 -113 -47t-47 -113v-832 q0 -66 47 -113t113 -47h832q66 0 113 47t47 113v254q0 13 9 22l64 64q10 10 23 10q6 0 12 -3q20 -8 20 -29zM1639 1095l-814 -814q-24 -24 -57 -24t-57 24l-430 430q-24 24 -24 57t24 57l110 110q24 24 57 24t57 -24l263 -263l647 647q24 24 57 24t57 -24l110 -110 q24 -24 24 -57t-24 -57z",check_empty:"M1120 1280h-832q-66 0 -113 -47t-47 -113v-832q0 -66 47 -113t113 -47h832q66 0 113 47t47 113v832q0 66 -47 113t-113 47zM1408 1120v-832q0 -119 -84.5 -203.5t-203.5 -84.5h-832q-119 0 -203.5 84.5t-84.5 203.5v832q0 119 84.5 203.5t203.5 84.5h832 q119 0 203.5 -84.5t84.5 -203.5z"};return r(i,e),e}),define("SUN/Panel",["require","PHET_CORE/inherit","SCENERY/nodes/Node","SCENERY/nodes/Rectangle"],function(t){function e(t,e){var i=this;e=_.extend({fill:"white",stroke:"black",lineWidth:1,xMargin:5,yMargin:5,cornerRadius:10,resize:!0},e),n.call(i);var r=new s(0,0,1,1,{stroke:e.stroke,lineWidth:e.lineWidth,fill:e.fill});this.addChild(r),this.addChild(t);var o=function(){r.setRect(0,0,t.width+2*e.xMargin,t.height+2*e.yMargin,e.cornerRadius,e.cornerRadius),t.centerX=r.centerX,t.centerY=r.centerY};e.resize&&t.addEventListener("bounds",function(){o()}),o(),this.mutate(e)}var i=t("PHET_CORE/inherit"),n=t("SCENERY/nodes/Node"),s=t("SCENERY/nodes/Rectangle");return i(n,e),e}),define("SCENERY_PHET/HomeButton",["require","SUN/FontAwesomeNode","PHET_CORE/inherit","SCENERY/nodes/Node","KITE/Shape"],function(t){function e(t){t=_.extend({cursor:"pointer"},t),s.call(this,t);var e=new i("home",{fill:"#fff",scale:.75});this.mouseArea=this.touchArea=r.rectangle(e.bounds.minX,e.bounds.minY,e.bounds.width,e.bounds.height),this.addChild(e)}var i=t("SUN/FontAwesomeNode"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Node"),r=t("KITE/Shape");return n(s,e),e}),define("SCENERY_PHET/MultiLineText",["require","PHET_CORE/inherit","SCENERY/nodes/Node","SCENERY/nodes/Text","SCENERY/nodes/VBox"],function(t){function e(t,e){var i=this;i._options=e=_.extend({align:"center"},e),n.call(i),i.text=t,i.mutate(_.omit(e,"align"))}var i=t("PHET_CORE/inherit"),n=t("SCENERY/nodes/Node"),s=t("SCENERY/nodes/Text"),r=t("SCENERY/nodes/VBox");return i(n,e,{get text(){return this._text},set text(t){var e=this;e._text=t,e.children=[new r({children:t.split("\n").map(function(t){return new s(t,_.omit(e._options,"align"))}),align:e._options.align})]}}),e}),define("KITE/shape",["require","ASSERT/assert","ASSERT/assert","KITE/kite","DOT/Vector2","DOT/Bounds2","DOT/Ray2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/util/Subpath","KITE/../parser/svgPath","KITE/util/LineStyles","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic"],function(t){function e(t,e){return new r(t,e)}function i(t,e){return new r(t,e)}var n=t("ASSERT/assert")("kite");t("ASSERT/assert")("kite.extra",!0);var s=t("KITE/kite"),r=t("DOT/Vector2"),o=t("DOT/Bounds2"),a=t("DOT/Ray2");t("DOT/Matrix3"),t("DOT/Transform3"),t("DOT/Util").toDegrees,t("DOT/Util").lineLineIntersection;var h=t("KITE/util/Subpath"),u=t("KITE/../parser/svgPath");t("KITE/util/LineStyles"),t("KITE/segments/Arc"),t("KITE/segments/Cubic"),t("KITE/segments/EllipticalArc"),t("KITE/segments/Line"),t("KITE/segments/Quadratic"),s.Shape=function c(t,e){this.subpaths="object"==typeof t?t:[],n&&n(0===this.subpaths.length||"Array"!==this.subpaths[0].constructor.name),this.bounds=e||o.NOTHING;var i=this;t&&"object"!=typeof t&&(n&&n("string"==typeof t,"if subpaths is not an object, it must be a string"),_.each(u.parse(t),function(t){n&&n(void 0!==c.prototype[t.cmd],"method "+t.cmd+" from parsed SVG does not exist"),i[t.cmd].apply(i,t.args)}))};var l=s.Shape;return l.prototype={constructor:l,moveTo:function(t,e){return this.moveToPoint(i(t,e))},moveToRelative:function(t,e){return this.moveToPointRelative(i(t,e))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new s.Subpath).addPoint(t))},lineTo:function(t,e){return this.lineToPoint(i(t,e))},lineToRelative:function(t,e){return this.lineToPointRelative(i(t,e))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){var e=this.getLastSubpath().getLastPoint(),i=t,r=new s.Segment.Line(e,i);this.getLastSubpath().addPoint(i),r.invalid||(this.getLastSubpath().addSegment(r),this.bounds=this.bounds.withPoint(e).withPoint(i),n&&n(!isNaN(this.bounds.getX())))}else this.ensure(t);return this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},quadraticCurveTo:function(t,e,n,s){return this.quadraticCurveToPoint(i(t,e),i(n,s))},quadraticCurveToRelative:function(t,e,n,s){return this.quadraticCurveToPointRelative(i(t,e),i(n,s))},quadraticCurveToPointRelative:function(t,e){var i=this.getRelativePoint();return this.quadraticCurveToPoint(i.plus(t),i.plus(e))},smoothQuadraticCurveTo:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),i(t,e))},smoothQuadraticCurveToRelative:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),i(t,e).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,e){this.ensure(t);var i=this.getLastSubpath().getLastPoint(),n=new s.Segment.Quadratic(i,t,e);return this.getLastSubpath().addPoint(e),n.invalid||(this.getLastSubpath().addSegment(n),this.bounds=this.bounds.union(n.bounds)),this},cubicCurveTo:function(t,e,n,s,r,o){return this.cubicCurveToPoint(i(t,e),i(n,s),i(r,o))},cubicCurveToRelative:function(t,e,n,s,r,o){return this.cubicCurveToPointRelative(i(t,e),i(n,s),i(r,o))},cubicCurveToPointRelative:function(t,e,i){var n=this.getRelativePoint();return this.cubicCurveToPoint(n.plus(t),n.plus(e),n.plus(i))},smoothCubicCurveTo:function(t,e,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),i(t,e),i(n,s))},smoothCubicCurveToRelative:function(t,e,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),i(t,e).plus(this.getRelativePoint()),i(n,s).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,e,i){this.ensure(t);var n=this.getLastSubpath().getLastPoint(),r=new s.Segment.Cubic(n,t,e,i);return r.invalid||(r.hasCusp()?(this.getLastSubpath().addSegment(r.startQuadratic),this.getLastSubpath().addSegment(r.endQuadratic)):this.getLastSubpath().addSegment(r),this.bounds=this.bounds.union(r.bounds)),this.getLastSubpath().addPoint(i),this},arc:function(t,e,n,s,r,o){return this.arcPoint(i(t,e),n,s,r,o)},arcPoint:function(t,e,i,n,r){var o=new s.Segment.Arc(t,e,i,n,r),a=o.start,h=o.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!a.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new s.Segment.Line(this.getLastSubpath().getLastPoint(),a)),this.hasSubpaths()||this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(a),this.getLastSubpath().addPoint(h),o.invalid||(this.getLastSubpath().addSegment(o),this.bounds=this.bounds.union(o.bounds)),this},ellipticalArc:function(t,e,n,s,r,o,a,h){return this.ellipticalArcPoint(i(t,e),n,s,r,o,a,h)},ellipticalArcPoint:function(t,e,i,n,r,o,a){var h=new s.Segment.EllipticalArc(t,e,i,n,r,o,a),u=h.start,l=h.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!u.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new s.Segment.Line(this.getLastSubpath().getLastPoint(),u)),this.hasSubpaths()||this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(u),this.getLastSubpath().addPoint(l),h.invalid||(this.getLastSubpath().addSegment(h),this.bounds=this.bounds.union(h.bounds)),this},close:function(){if(this.hasSubpaths()){var t=this.getLastSubpath(),e=new s.Subpath;t.close(),this.addSubpath(e),e.addPoint(t.getFirstPoint())}return this},ellipticalArcToRelative:function(t,e,i,n,s,r,o){var a=this.getRelativePoint();return this.ellipticalArcTo(t,e,i,n,s,r+a.x,o+a.y)},ellipticalArcTo:function(){throw new Error("ellipticalArcTo unimplemented")},circle:function(t,i,n){if("object"==typeof t){var s=t;return n=i,this.arcPoint(s,n,0,2*Math.PI,!1)}return this.arcPoint(e(t,i),n,0,2*Math.PI,!1)},ellipse:function(t,e,n,s,r){if("object"==typeof t){var o=t;return r=s,s=n,n=e,this.ellipticalArcPoint(o,n,s,r||0,0,2*Math.PI,!1)}return this.ellipticalArcPoint(i(t,e),n,s,r||0,0,2*Math.PI,!1)},rect:function(t,e,r,o){var a=new s.Subpath;return this.addSubpath(a),a.addPoint(i(t,e)),a.addPoint(i(t+r,e)),a.addPoint(i(t+r,e+o)),a.addPoint(i(t,e+o)),a.addSegment(new s.Segment.Line(a.points[0],a.points[1])),a.addSegment(new s.Segment.Line(a.points[1],a.points[2])),a.addSegment(new s.Segment.Line(a.points[2],a.points[3])),a.close(),this.addSubpath(new s.Subpath),this.getLastSubpath().addPoint(i(t,e)),this.bounds=this.bounds.withCoordinates(t,e).withCoordinates(t+r,e+o),n&&n(!isNaN(this.bounds.getX())),this},roundRect:function(t,e,i,n,s,r){var o=t+s,a=t+i-s,h=e+r,u=e+n-r;return s===r?this.arc(a,h,s,-Math.PI/2,0,!1).arc(a,u,s,0,Math.PI/2,!1).arc(o,u,s,Math.PI/2,Math.PI,!1).arc(o,h,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(a,h,s,r,0,-Math.PI/2,0,!1).ellipticalArc(a,u,s,r,0,0,Math.PI/2,!1).ellipticalArc(o,u,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(o,h,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},copy:function(){return new l(_.map(this.subpaths,function(t){return t.copy()}),this.bounds)},writeToContext:function(t){for(var e=this.subpaths.length,i=0;e>i;i++)this.subpaths[i].writeToContext(t)},getSVGPath:function(){for(var t=[],e=this.subpaths.length,i=0;e>i;i++){var s=this.subpaths[i];if(s.isDrawable()){var r=s.getFirstSegment().start;n&&n(r.equals(s.getFirstPoint(),1e-5));var o="M "+r.x+" "+r.y+" ";o+=_.map(s.segments,function(t){return t.getSVGPathFragment()}).join(" "),s.isClosed()&&(o+=" Z"),t.push(o)}}return t.join(" ")},transformed:function(t){var e=_.map(this.subpaths,function(e){return e.transformed(t)}),i=_.reduce(e,function(t,e){return t.union(e.computeBounds())},o.NOTHING);return new l(e,i)},computeBounds:function(t){return t?this.bounds.union(this.getStrokedShape(t).bounds):this.bounds},containsPoint:function(t){var e=new a(t,r.X_UNIT);return 0!==this.windingIntersection(e)},intersection:function(t){for(var e=[],i=this.subpaths.length,n=0;i>n;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++){var a=s.segments[o];e=e.concat(a.intersection(t))}s.hasClosingSegment()&&(e=e.concat(s.getClosingSegment().intersection(t)))}}return _.sortBy(e,function(t){return t.distance})},windingIntersection:function(t){for(var e=0,i=this.subpaths.length,n=0;i>n;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++)e+=s.segments[o].windingIntersection(t);s.hasClosingSegment()&&(e+=s.getClosingSegment().windingIntersection(t))}}return e},intersectsBounds:function(t){for(var e=this.subpaths.length,i=0;e>i;i++){var n=this.subpaths[i];if(n.isDrawable()){for(var s=n.segments.length,r=0;s>r;r++)if(n.segments[r].intersectsBounds(t))return!0;if(n.hasClosingSegment()&&n.getClosingSegment().intersectsBounds(t))return!0}}return!1},getStrokedShape:function(t){for(var e=[],i=o.NOTHING.copy(),n=this.subpaths.length,s=0;n>s;s++){var r=this.subpaths[s],a=r.stroked(t);e=e.concat(a)}for(n=e.length,s=0;n>s;s++)i.includeBounds(e[s].computeBounds());return new l(e,i)},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new h),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;var t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){var t=this.getLastPoint(),e=this.getLastSegment();return e&&e instanceof s.Segment.Quadratic?t.plus(t.minus(e.control)):t},getSmoothCubicControlPoint:function(){var t=this.getLastPoint(),e=this.getLastSegment();return e&&e instanceof s.Segment.Cubic?t.plus(t.minus(e.control2)):t},getRelativePoint:function(){var t=this.getLastPoint();return t?t:r.ZERO}},l.rectangle=function(t,e,i,n){return(new l).rect(t,e,i,n)},l.rect=l.rectangle,l.roundRect=function(t,e,i,n,s,r){return(new l).roundRect(t,e,i,n,s,r)},l.roundRectangle=l.roundRect,l.bounds=function(t){return(new l).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},l.lineSegment=function(t,e,i,n){return"number"==typeof t?(new l).moveTo(t,e).lineTo(i,n):(new l).moveToPoint(t).lineToPoint(e)},l.regularPolygon=function(t,e){var i=new l;return _.each(_.range(t),function(n){var s=r.createPolar(e,2*Math.PI*n/t);0===n?i.moveToPoint(s):i.lineToPoint(s)}),i.close()},l.circle=function(t,e,i){return void 0===e?(new l).circle(0,0,t):(new l).circle(t,e,i).close()},l.ellipse=function(t,e,i,n){return void 0===i?(new l).ellipse(0,0,t,e):(new l).ellipse(t,e,i,n).close()},l.arc=function(t,e,i,n,s,r){return(new l).arc(t,e,i,n,s,r)},l}),define("JOIST/ScreenView",["require","SCENERY/nodes/Node","PHET_CORE/inherit","DOT/Bounds2","SCENERY/nodes/Path","KITE/shape"],function(t){function e(t){i.call(this,t),window.phetcommon.getQueryParameter("dev")&&this.addChild(new r({shape:o.bounds(this.layoutBounds),stroke:"red",lineWidth:3,pickable:!1}))}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("DOT/Bounds2"),r=t("SCENERY/nodes/Path"),o=t("KITE/shape");return n(i,e,{layoutBounds:new s(0,0,768,504),getLayoutScale:function(t,e){return Math.min(t/this.layoutBounds.width,e/this.layoutBounds.height)},layout:function(t,e){this.resetTransform();var i=this.getLayoutScale(t,e);this.setScaleMagnitude(i),i===t/this.layoutBounds.width?this.translate(0,(e-this.layoutBounds.height*i)/2/i):i===e/this.layoutBounds.height&&this.translate((t-this.layoutBounds.width*i)/2/i,0)}}),e}),define("SCENERY/nodes/HTMLText",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/nodes/Text"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/nodes/Text");i.HTMLText=function(t,e){this._isHTML=!0,n.call(this,t,e)};var s=i.HTMLText;return e(n,s,{}),s}),define("SCENERY_PHET/PhetFont",["require","ASSERT/assert","SCENERY/util/Font","PHET_CORE/inherit"],function(t){function e(t){("number"==typeof t||"string"==typeof t)&&(t={size:t}),t=_.extend({family:"Arial"},t),i&&i(t.family),t.family=t.family+", sans-serif",n.call(this,t)}var i=t("ASSERT/assert")("scenery-phet"),n=t("SCENERY/util/Font"),s=t("PHET_CORE/inherit");return s(n,e)}),define("JOIST/AboutDialog",["require","SCENERY/nodes/Node","SCENERY/nodes/VBox","SCENERY/nodes/Rectangle","SCENERY/nodes/Text","PHET_CORE/inherit","SCENERY_PHET/MultiLineText","JOIST/ScreenView","SUN/Panel","SCENERY/nodes/HTMLText","SCENERY_PHET/PhetFont"],function(t){function e(t){function e(){s.layout($(window).width(),$(window).height())}var s=this;o.call(this,{renderer:"svg"});var c=new h('<a href="#" onclick="return false;">Software Agreement</a>',{font:new u(14),renderer:"dom",interactive:!0});c.addInputListener({up:function(t){t.handle()},upImmediate:function(){var t=window.open(l,"_blank");t.focus()}});var d="http://phet.colorado.edu/files/troubleshooting/?sim="+encodeURIComponent(t.name)+"&version="+encodeURIComponent(t.version)+"&url="+encodeURIComponent(window.location.href),f=new h('<a href="'+d+'" onclick="return false;">Debugging Information (for bug reports)</a>',{font:new u(12),renderer:"dom",interactive:!0});f.addInputListener({up:function(t){t.handle()},upImmediate:function(){var t=window.open(d,"_blank");t.focus()}});var m=new i({align:"left",spacing:5,children:[new n("PhET Interactive Simulations",{font:new u(16)}),new n("Copyright ¬© 2004-2013 University of Colorado Boulder",{font:new u(12)}),new n(" ",{font:new u(28)}),new n(t.name,{font:new u(28)}),new n("version "+t.version,{font:new u(20)}),new n(" "),new r(t.credits,{align:"left",font:new u(12)}),new n(" "),new r(t.thanks,{align:"left",font:new u(12)}),new n(" "),c,new n(" "),f]});this.addChild(new a(m,{centerX:this.layoutBounds.centerX,centerY:this.layoutBounds.centerY,xMargin:20,yMargin:20})),$(window).resize(e),e()}t("SCENERY/nodes/Node");var i=t("SCENERY/nodes/VBox");t("SCENERY/nodes/Rectangle");var n=t("SCENERY/nodes/Text"),s=t("PHET_CORE/inherit"),r=t("SCENERY_PHET/MultiLineText"),o=t("JOIST/ScreenView"),a=t("SUN/Panel"),h=t("SCENERY/nodes/HTMLText"),u=t("SCENERY_PHET/PhetFont"),l="http://phet.colorado.edu/about/software-agreement_v7.htm";return s(o,e),e}),define("SCENERY/input/DownUpListener",["require","SCENERY/scenery","SCENERY/util/Trail"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/Trail"),e.DownUpListener=function(t){var e=this;this.options=_.extend({mouseButton:0},t),this.isDown=!1,this.downCurrentTarget=null,this.downTrail=null,this.pointer=null,this.downListener={up:function(t){t.pointer.isMouse&&t.domEvent.button!==e.options.mouseButton||e.buttonUp(t)},cancel:function(t){e.buttonUp(t)}}};var i=e.DownUpListener;return i.prototype={constructor:i,buttonDown:function(t){this.isDown||t.pointer.isMouse&&t.domEvent.button!==this.options.mouseButton||(t.pointer.addInputListener(this.downListener),this.isDown=!0,this.downCurrentTarget=t.currentTarget,this.downTrail=t.trail.subtrailTo(t.currentTarget,!1),this.pointer=t.pointer,this.options.down&&this.options.down(t,this.downTrail))},buttonUp:function(t){this.isDown=!1,this.pointer.removeInputListener(this.downListener);var e=t.currentTarget;if(t.currentTarget=this.downCurrentTarget,this.options.upInside||this.options.upOutside){this.downTrail.rootNode();var i=t.trail,n=i.isExtensionOf(this.downTrail,!0);n&&this.options.upInside?this.options.upInside(t,this.downTrail):!n&&this.options.upOutside&&this.options.upOutside(t,this.downTrail)}this.options.up&&this.options.up(t,this.downTrail),t.currentTarget=e},down:function(t){this.buttonDown(t)}},i}),define("SCENERY/input/ButtonListener",["require","SCENERY/scenery","SCENERY/util/Trail","PHET_CORE/inherit","SCENERY/input/DownUpListener"],function(t){var e=t("SCENERY/scenery");t("SCENERY/util/Trail");var i=t("PHET_CORE/inherit"),n=t("SCENERY/input/DownUpListener");e.ButtonListener=function(t){this.buttonState="up",this._overCount=0,this._buttonOptions=t;var e=this;n.call(this,{mouseButton:t.mouseButton||0,down:function(t){e.setButtonState(t,"down")},up:function(t){e.setButtonState(t,e._overCount>0?"over":"up")}})};var s=e.ButtonListener;return i(n,s,{setButtonState:function(t,e){if(e!==this.buttonState){var i=this.buttonState;this.buttonState=e,this._buttonOptions[e]&&this._buttonOptions[e](t,i),this._buttonOptions.fire&&this._overCount>0&&(this._buttonOptions.fireOnDown?"down"===e:"down"===i)&&this._buttonOptions.fire(t)}},enter:function(t){this._overCount++,1===this._overCount&&this.setButtonState(t,this.isDown?"down":"over")},exit:function(t){this._overCount--,0===this._overCount&&this.setButtonState(t,this.isDown?"out":"up")}}),s.TEST_LISTENER=new s({up:function(t,e){console.log("ButtonListener.up oldState="+e)},over:function(t,e){console.log("ButtonListener.over oldState="+e)},down:function(t,e){console.log("ButtonListener.down oldState="+e)},out:function(t,e){console.log("ButtonListener.out oldState="+e)},fire:function(){console.log("ButtonListener.fire")}}),s}),define("SCENERY/nodes/Plane",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/nodes/Rectangle","KITE/Shape"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/nodes/Rectangle");t("KITE/Shape"),i.Plane=function(t){n.call(this,-2e3,-2e3,6e3,6e3,t)};var s=i.Plane;return e(n,s)}),define("AXON/axon",["require"],function(){var t={};return t}),define("AXON/log",["require","AXON/axon"],function(t){function e(){var t=this;this.enabled=window&&window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("log"),this.properties=[],this.collections=[],this.propertySets=[],this.entries=[],this.replacer=function(t,e){return e&&e.cid?{jsonClass:"Property",cid:e.cid}:e&&"Vector2"===e.constructor.name?{x:e.x,y:e.y,jsonClass:"Vector2"}:e},this.reviver=function(e,i){return i&&i.jsonClass&&"Property"===i.jsonClass?t.properties[i.cid]:i&&i.jsonClass&&"Vector2"===i.jsonClass?{x:i.x,y:i.y}:i}}var i=t("AXON/axon");return e.prototype={registerProperty:function(t){if(this.enabled){var e=this.properties.length,i=this;this.properties.push(t),t.lazyLink(function(t){var n={time:Date.now(),type:"property",index:e,action:"change",value:JSON.stringify(t,i.replacer)};i.entries.push(n)})}},clear:function(){this.properties=[],this.collection=[],this.propertySets=[]},stepUntil:function(t,e,i){for(var n=this;i<t.length;){var s=t[i].time;if(!(e>=s))break;var r=t[i],o=r.cid;"change"===r.action?r.value?n.properties[o].value=JSON.parse(r.value,n.reviver):console.log("missing value for index: ",i,r):"trigger"===r.action?n.properties[o].trigger(r.event):"add"===r.action?n.collections[r.collectionCid].add(n.properties[r.cid]):"remove"===r.action?n.collections[r.collectionCid].remove(n.properties[r.cid]):"reset"===r.action?n.collections[r.collectionCid].reset():"sort"===r.action&&n.collections[r.collectionCid].sort(),i++}return i}},i.log=i.log||new e,i.log}),define("JOIST/PhetMenu",["require","SCENERY/nodes/Node","KITE/Shape","SCENERY/nodes/Path","SCENERY/nodes/Text","PHET_CORE/inherit","JOIST/AboutDialog","SCENERY/nodes/Rectangle","SCENERY/input/ButtonListener","SCENERY/nodes/Plane","AXON/log","SCENERY_PHET/PhetFont"],function(t){function e(t,e){e=_.extend({renderer:"svg"},e);var o=this;i.call(o);var h=[{text:"PhET website",present:!0,callback:function(){},immediateCallback:function(){var t=window.open("http://phet.colorado.edu","_blank");t.focus()}},{text:"Output Log",present:c.enabled?!0:!1,callback:function(){console.log(JSON.stringify(c.entries))}},{text:"Output Input Events Log",present:!!t.options.recordInputEventLog,callback:function(){console.log(t.getRecordedInputEventLogString())}},{text:"Submit Input Events Log",present:!!t.options.recordInputEventLog,callback:function(){t.submitEventLog()}},{text:"Mail Input Events Log",present:!!t.options.recordInputEventLog,callback:function(){},immediateCallback:function(){t.mailEventLog()}},{text:"About...",present:!0,callback:function(){var e=new a(t),i=new l({fill:"black",opacity:.3});t.addChild(i),t.addChild(e);var n={up:function(){e.removeInputListener(n),i.addInputListener(n),e.detach(),i.detach()}};e.addInputListener(n),i.addInputListener(n)}}],u=_.filter(h,function(t){return t.present}),m=_.map(u,function(t){return new r(t.text,{font:new d(f)})}),v=_.max(m,function(t){return t.width}).width,y=_.max(m,function(t){return t.height}).height,E=_.map(u,function(t){return p(t.text,v,y,t.callback,t.immediateCallback)}),S=_.max(E,function(t){return t.width}).width,T=_.max(E,function(t){return t.height}).height,w=5,b=5,C=S+w+w,x=T*E.length+b+b;o.addChild(g(C,x));var R=b;_.each(E,function(t){t.top=R,t.left=w,o.addChild(t),t===E[E.length-2]&&o.addChild(new s({shape:n.lineSegment(8,R+T,C-8,R+T),stroke:"gray",lineWidth:1})),R+=T}),o.mutate(e)}var i=t("SCENERY/nodes/Node"),n=t("KITE/Shape"),s=t("SCENERY/nodes/Path"),r=t("SCENERY/nodes/Text"),o=t("PHET_CORE/inherit"),a=t("JOIST/AboutDialog"),h=t("SCENERY/nodes/Rectangle"),u=t("SCENERY/input/ButtonListener"),l=t("SCENERY/nodes/Plane"),c=t("AXON/log"),d=t("SCENERY_PHET/PhetFont"),f=18,m="#a6d2f4",p=function(t,e,n,s,o){var a=5,l=3,c=5,p=new r(t,{font:new d(f)}),g=new h(0,0,e+a+a,n+l+l,c,c),v=new i({cursor:"pointer"});return v.addChild(g),v.addChild(p),p.left=g.left+a,p.centerY=g.centerY,v.addInputListener({enter:function(){g.fill=m},exit:function(){g.fill=null},upImmediate:function(){o&&o()}}),v.addInputListener(new u({fire:s})),v},g=function(t,e){var r=new h(0,0,t,e,8,8,{fill:"white",lineWidth:1,stroke:"black"}),o=new n;o.moveTo(t-20,e-2),o.lineToRelative(0,20),o.lineToRelative(-20,-20),o.close();var a=new n;a.moveTo(t-20,e),a.lineToRelative(0,18),a.lineToRelative(-18,-18);var u=new i;return u.addChild(r),u.addChild(new s({shape:o,fill:"white"})),u.addChild(new s({shape:a,stroke:"black",lineWidth:1})),u};return o(i,e),e}),define("SCENERY/util/Color",["require","SCENERY/scenery","DOT/Util","DOT/Util"],function(t){function e(t){var e=1;return"%"===t.charAt(t.length-1)&&(e=2.55,t=t.slice(0,t.length-1)),Math.round(parseInt(t,10)*e)}var i=t("SCENERY/scenery"),n=t("DOT/Util").clamp,s=t("DOT/Util").linear;i.Color=function u(t,e,i,n){if(this.listeners=[],"string"==typeof t){var s=t.replace(/ /g,"").toLowerCase(),r=!1,o=u.colorKeywords[s];
o&&(s="#"+o);for(var a=0;a<u.formatParsers.length;a++){var h=u.formatParsers[a],l=h.regexp.exec(s);if(l){h.apply(this,l),r=!0;break}}if(!r)throw new Error("scenery.Color unable to parse color string: "+t)}else{var c=void 0===n?1:n;void 0===e||void 0===i?this.setRGBA(t>>16&&255,t>>8&&255,t>>0&&255,c):this.setRGBA(t,e,i,c)}};var r=i.Color,o="(-?\\d{1,3}%?)",a="(\\d+|\\d*\\.\\d+)",h="(\\d{1,3})";return r.formatParsers=[{regexp:/^transparent$/,apply:function(t){t.setRGBA(0,0,0,0)}},{regexp:/^#(\w{1})(\w{1})(\w{1})$/,apply:function(t,e){t.setRGBA(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1)}},{regexp:/^#(\w{2})(\w{2})(\w{2})$/,apply:function(t,e){t.setRGBA(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1)}},{regexp:new RegExp("^rgb\\("+o+","+o+","+o+"\\)$"),apply:function(t,i){t.setRGBA(e(i[1]),e(i[2]),e(i[3]),1)}},{regexp:new RegExp("^rgba\\("+o+","+o+","+o+","+a+"\\)$"),apply:function(t,i){t.setRGBA(e(i[1]),e(i[2]),e(i[3]),parseFloat(i[4]))}},{regexp:new RegExp("^hsl\\("+h+","+h+"%,"+h+"%\\)$"),apply:function(t,e){t.setHSLA(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),1)}},{regexp:new RegExp("^hsla\\("+h+","+h+"%,"+h+"%,"+a+"\\)$"),apply:function(t,e){t.setHSLA(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4]))}}],r.hueToRGB=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t},r.prototype={constructor:r,copy:function(){return new r(this.r,this.g,this.b,this.a)},getRed:function(){return this.r},setRed:function(t){return this.setRGBA(t,this.g,this.b,this.a)},get red(){return this.getRed()},set red(t){return this.setRed(t)},getGreen:function(){return this.g},setGreen:function(t){return this.setRGBA(this.r,t,this.b,this.a)},get green(){return this.getGreen()},set green(t){return this.setGreen(t)},getBlue:function(){return this.b},setBlue:function(t){return this.setRGBA(this.r,this.g,t,this.a)},get blue(){return this.getBlue()},set blue(t){return this.setBlue(t)},getAlpha:function(){return this.a},setAlpha:function(t){return this.setRGBA(this.r,this.g,this.b,t)},get alpha(){return this.getAlpha()},set alpha(t){return this.setAlpha(t)},setRGBA:function(t,e,i,s){return this.r=Math.round(n(t,0,255)),this.g=Math.round(n(e,0,255)),this.b=Math.round(n(i,0,255)),this.a=n(s,0,1),this.updateColor(),this},computeCSS:function(){if(1===this.a)return"rgb("+this.r+","+this.g+","+this.b+")";var t=0===this.a||1===this.a?this.a:this.a.toFixed(20);return"rgba("+this.r+","+this.g+","+this.b+","+t+")"},toCSS:function(){return this._css},updateColor:function(){var t=this._css;if(this._css=this.computeCSS(),t!==this._css&&this.listeners.length)for(var e=this.listeners.slice(0),i=e.length,n=0;i>n;n++)e[n]()},setImmutable:function(){return this},getCanvasStyle:function(){return this.toCSS()},setHSLA:function(t,e,i,s){t=t%360/360,e=n(e/100,0,1),i=n(i/100,0,1);var o,a;return a=.5>i?i*(e+1):i+e-i*e,o=2*i-a,this.r=Math.round(255*r.hueToRGB(o,a,t+1/3)),this.g=Math.round(255*r.hueToRGB(o,a,t)),this.b=Math.round(255*r.hueToRGB(o,a,t-1/3)),this.a=n(s,0,1),this.updateColor(),this},equals:function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},withAlpha:function(t){return new r(this.r,this.g,this.b,t)},brighterColor:function(t){if(0>t||t>1)throw new Error("factor must be between 0 and 1: "+t);t=void 0===t?.7:t;var e=Math.min(255,Math.floor(this.r/t)),i=Math.min(255,Math.floor(this.g/t)),n=Math.min(255,Math.floor(this.b/t));return new r(e,i,n,this.a)},darkerColor:function(t){if(0>t||t>1)throw new Error("factor must be between 0 and 1: "+t);t=void 0===t?.7:t;var e=Math.max(0,Math.floor(t*this.r)),i=Math.max(0,Math.floor(t*this.g)),n=Math.max(0,Math.floor(t*this.b));return new r(e,i,n,this.a)},addChangeListener:function(t){this.listeners.push(t)},removeChangeListener:function(t){this.listeners.splice(_.indexOf(this.listeners,t),1)}},r.basicColorKeywords={aqua:"00ffff",black:"000000",blue:"0000ff",fuchsia:"ff00ff",gray:"808080",green:"008000",lime:"00ff00",maroon:"800000",navy:"000080",olive:"808000",purple:"800080",red:"ff0000",silver:"c0c0c0",teal:"008080",white:"ffffff",yellow:"ffff00"},r.colorKeywords={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},r.BLACK=new r(0,0,0).setImmutable(),r.BLUE=new r(0,0,255).setImmutable(),r.CYAN=new r(0,255,255).setImmutable(),r.DARK_GRAY=new r(64,64,64).setImmutable(),r.GRAY=new r(128,128,128).setImmutable(),r.GREEN=new r(0,255,0).setImmutable(),r.LIGHT_GRAY=new r(192,192,192).setImmutable(),r.MAGENTA=new r(255,0,255).setImmutable(),r.ORANGE=new r(255,200,0).setImmutable(),r.PINK=new r(255,175,175).setImmutable(),r.RED=new r(255,0,0).setImmutable(),r.WHITE=new r(255,255,255).setImmutable(),r.YELLOW=new r(255,255,0).setImmutable(),r.interpolateRBGA=function(t,e,i){if(0>i||i>1)throw new Error("distance must be between 0 and 1: "+i);var n=Math.floor(s(0,1,t.r,e.r,i)),o=Math.floor(s(0,1,t.g,e.g,i)),a=Math.floor(s(0,1,t.b,e.b,i)),h=s(0,1,t.a,e.a,i);return new r(n,o,a,h)},r}),define("SCENERY/util/Gradient",["require","SCENERY/util/Color","SCENERY/scenery","DOT/Vector2"],function(t){t("SCENERY/util/Color");var e=t("SCENERY/scenery");t("DOT/Vector2"),e.Gradient=function(t){this.stops=[],this.lastStopRatio=0,this.canvasGradient=t,this.transformMatrix=null};var i=e.Gradient;return i.prototype={constructor:i,addColorStop:function(t,i){if(this.lastStopRatio>t)throw new Error("Color stops not specified in the order of increasing ratios");return this.lastStopRatio=t,"string"==typeof i&&(i=new e.Color(i)),this.stops.push({ratio:t,color:i}),this.canvasGradient.addColorStop(t,i.toCSS()),this},setTransformMatrix:function(t){return this.transformMatrix!==t&&(this.transformMatrix=t),this},getCanvasStyle:function(){return this.canvasGradient}},i}),define("SCENERY/util/LinearGradient",["require","SCENERY/scenery","PHET_CORE/inherit","DOT/Vector2","SCENERY/util/Gradient"],function(t){var e=t("SCENERY/scenery"),i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),s=t("SCENERY/util/Gradient");e.LinearGradient=function(t,i,r,o){var a=void 0===o;this.start=a?t:new n(t,i),this.end=a?i:new n(r,o),s.call(this,e.scratchContext.createLinearGradient(t,i,r,o))};var r=e.LinearGradient;return i(s,r,{getSVGDefinition:function(t){var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"linearGradient");return i.setAttribute("id",t),i.setAttribute("gradientUnits","userSpaceOnUse"),i.setAttribute("x1",this.start.x),i.setAttribute("y1",this.start.y),i.setAttribute("x2",this.end.x),i.setAttribute("y2",this.end.y),this.transformMatrix&&i.setAttribute("gradientTransform",this.transformMatrix.getSVGTransform()),_.each(this.stops,function(t){var n=document.createElementNS(e,"stop");n.setAttribute("offset",t.ratio),n.setAttribute("style","stop-color: "+t.color.withAlpha(1).toCSS()+"; stop-opacity: "+t.color.a.toFixed(20)+";"),i.appendChild(n)}),i},toString:function(){var t="new scenery.LinearGradient( "+this.start.x+", "+this.start.y+", "+this.end.x+", "+this.end.y+" )";return _.each(this.stops,function(e){t+=".addColorStop( "+e.ratio+", '"+e.color.toString()+"' )"}),t}}),r}),define("PHET_CORE/platform",["require"],function(){return{get firefox(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},get mobileSafari(){return navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)}}}),define("JOIST/PhetButton",["require","SCENERY/nodes/Node","SCENERY/nodes/Path","SCENERY/nodes/Text","SCENERY/nodes/Image","SUN/FontAwesomeNode","SCENERY/nodes/Rectangle","SCENERY/nodes/Plane","PHET_CORE/inherit","PHET_CORE/platform","JOIST/PhetMenu","SCENERY/util/Font","KITE/Shape","SCENERY/util/LinearGradient","SCENERY/input/ButtonListener","DOT/Vector2","JOIST/joistImageLoader"],function(t){function e(t,e){var n=this;i.call(this,{renderer:"svg",cursor:"pointer"}),e=_.extend({phetLogo:"phet-logo-short.svg",phetLogoScale:.28,optionsButtonVerticalMargin:1.5},e);var a=new s(m.getImage(e.phetLogo),{scale:e.phetLogoScale});h.firefox&&(a.renderer="canvas");var c=new r("reorder",{fill:"#fff",scale:.6,left:a.width+10,bottom:a.bottom-e.optionsButtonVerticalMargin});this.addChild(a),this.addChild(c);var v=p(this.width+6,this.height-2);v.bottom=this.bottom+3,v.x=-3,this.addChild(v);var y=function(){var e=new u(t);e.right=n.globalToParentPoint(new f(n.globalBounds.maxX,0)).x,e.bottom=n.centerY;var i=new o({fill:"black",opacity:.3}),s=function(){i.detach(),e.detach(),e.removeInputListener(r),i.removeInputListener(a)},r=new d({fire:s}),a={down:s};e.addInputListener(r),i.addInputListener(a),n.parents[0].addChild(i),n.parents[0].addChild(e)};this.addPeer('<input type="button" aria-label="PhET Menu">',{click:y,tabIndex:101}),this.addInputListener(new d({fire:y})),this.addInputListener(g(v)),this.mouseArea=this.touchArea=l.bounds(this.bounds),this.mutate(e)}var i=t("SCENERY/nodes/Node"),n=t("SCENERY/nodes/Path");t("SCENERY/nodes/Text");var s=t("SCENERY/nodes/Image"),r=t("SUN/FontAwesomeNode");t("SCENERY/nodes/Rectangle");var o=t("SCENERY/nodes/Plane"),a=t("PHET_CORE/inherit"),h=t("PHET_CORE/platform"),u=t("JOIST/PhetMenu");t("SCENERY/util/Font");var l=t("KITE/Shape"),c=t("SCENERY/util/LinearGradient"),d=t("SCENERY/input/ButtonListener"),f=t("DOT/Vector2"),m=t("JOIST/joistImageLoader"),p=function(t,e){var s=new n({shape:l.lineSegment(0,0,0,e),lineWidth:1,stroke:new c(0,0,0,e).addColorStop(0,"black").addColorStop(.5,"white").addColorStop(1,"black")}),r=new n({shape:l.lineSegment(t,0,t,e),lineWidth:1,stroke:new c(0,0,0,e).addColorStop(0,"black").addColorStop(.5,"white").addColorStop(1,"black")});return new i({children:[s,r],visible:!1})},g=function(t){return{over:function(e){e.pointer.isMouse&&(t.visible=!0)},out:function(e){e.pointer.isMouse&&(t.visible=!1)}}};return a(i,e)}),define("JOIST/Highlight",["require","SCENERY/nodes/Node","SCENERY/nodes/Path","KITE/Shape","SCENERY/util/LinearGradient"],function(t){var e=t("SCENERY/nodes/Node"),i=t("SCENERY/nodes/Path"),n=t("KITE/Shape"),s=t("SCENERY/util/LinearGradient"),r=function(t,r){var o=new i({shape:n.lineSegment(0,0,0,r),lineWidth:1,stroke:new s(0,0,0,r).addColorStop(0,"black").addColorStop(.5,"white").addColorStop(1,"black")}),a=new i({shape:n.lineSegment(t,0,t,r),lineWidth:1,stroke:new s(0,0,0,r).addColorStop(0,"black").addColorStop(.5,"white").addColorStop(1,"black")});return new e({children:[o,a],visible:!1})},o=function(t){return{over:function(e){e.pointer.isMouse&&(t.visible=!0)},out:function(e){e.pointer.isMouse&&(t.visible=!1)}}};return{createHighlight:r,createHighlightListener:o}}),define("JOIST/NavigationBar",["require","SCENERY/nodes/Node","SCENERY/nodes/Path","SCENERY/nodes/HBox","SCENERY/nodes/VBox","SCENERY/nodes/Text","SUN/FontAwesomeNode","SUN/Panel","SCENERY_PHET/HomeButton","SCENERY/nodes/Rectangle","PHET_CORE/inherit","JOIST/PhetMenu","SCENERY_PHET/PhetFont","KITE/Shape","SCENERY/util/LinearGradient","JOIST/PhetButton","SCENERY/input/ButtonListener","JOIST/Highlight"],function(t){function e(t,e,u){this.screens=e,this.navBarHeight=40,this.navBarScale=1,this.navBarWidth=768,i.call(this,{renderer:"svg"}),this.background=new h(0,0,0,0,{fill:"black"}),this.addChild(this.background),this.hbox=new c(t),this.addChild(this.hbox),this.titleLabel=new r(t.name,{font:new l(18),fill:"white"});var m=0,p=new l({size:10,weight:"bold"}),g=new l({size:10});if(this.addChild(this.titleLabel),e.length>1){var v=_.map(e,function(t){var e=new i({children:[t.icon],scale:25/t.icon.height}),n=new r(t.name,{fill:"white",visible:!0}),a=new o(n,{fill:null,stroke:null,lineWidth:1,xMargin:4,yMargin:0,cornerRadius:0,resize:!1}),h=new s({children:[e,a]});return h.icon=e,h.text=n,h.textPanel=a,h.index=m++,h.screen=t,u.screenIndexProperty.link(function(t){var e=h.index===t;h.text.fill=e?"yellow":"white",h.text.font=e?p:g,h.opacity=e?1:.5}),h}),y=_.max(v,function(t){return t.width}).width,E=_.max(v,function(t){return t.height}).height;this.buttonArray=v.map(function(t){var e=new h(0,0,y,E),n=f.createHighlight(y,E);t.centerX=y/2,t.top=0;var s=new i({children:[e,n,t]});u.screenIndexProperty.link(function(e){s.cursor=e===t.index?"default":"pointer"});var r=function(){u.screenIndex=t.index,u.showHomeScreen=!1};return s.addInputListener(new d({fire:r})),s.addInputListener({over:function(t){t.pointer.isMouse&&(n.visible=!0)},out:function(t){t.pointer.isMouse&&(n.visible=!1)}}),s.addPeer('<input type="button" aria-label="Switch to the '+t.screen.name+' screen">',{click:r,tabIndex:99}),s});var S=_.max(v,function(t){return t.icon.width}).icon.width,T=_.max(v,function(t){return t.text.width}).text.width;this.buttonHBox=new n({spacing:S+2>=T?20:0,children:this.buttonArray}),this.addChild(this.buttonHBox),this.homeIcon=new a;var w=f.createHighlight(this.homeIcon.width+10,this.homeIcon.height+5);w.bottom=this.homeIcon.bottom+3,w.x=-5,this.homeIcon.addChild(w),u.showHomeScreenProperty.link(function(t){t&&(w.visible=!1)}),this.homeIcon.addInputListener({down:function(){u.showHomeScreen=!0}}),this.homeIcon.addInputListener(f.createHighlightListener(w)),this.homeIcon.addPeer('<input type="button" aria-label="Home Screen">',{click:function(){u.showHomeScreen=!0},tabIndex:100}),this.addChild(this.homeIcon)}}var i=t("SCENERY/nodes/Node");t("SCENERY/nodes/Path");var n=t("SCENERY/nodes/HBox"),s=t("SCENERY/nodes/VBox"),r=t("SCENERY/nodes/Text");t("SUN/FontAwesomeNode");var o=t("SUN/Panel"),a=t("SCENERY_PHET/HomeButton"),h=t("SCENERY/nodes/Rectangle"),u=t("PHET_CORE/inherit");t("JOIST/PhetMenu");var l=t("SCENERY_PHET/PhetFont");t("KITE/Shape"),t("SCENERY/util/LinearGradient");var c=t("JOIST/PhetButton"),d=t("SCENERY/input/ButtonListener"),f=t("JOIST/Highlight");return u(i,e,{relayout:function(){var t=this;t.background.rectHeight=this.navBarHeight,t.background.rectWidth=this.navBarWidth,t.screenIndex,this.buttonHBox&&this.buttonHBox.setScaleMagnitude(t.navBarScale),this.titleLabel.setScaleMagnitude(this.navBarScale),this.titleLabel.centerY=this.navBarHeight/2,this.titleLabel.left=10,1!==this.screens.length&&(this.buttonHBox.centerX=this.navBarWidth/2,this.buttonHBox.top=2,t.homeIcon.setScaleMagnitude(this.navBarScale),t.homeIcon.top=2,t.homeIcon.left=t.buttonHBox.right+15),this.hbox.setScaleMagnitude(this.navBarScale),this.hbox.right=this.navBarWidth-5,this.hbox.centerY=this.navBarHeight/2},layout:function(t,e,i){this.navBarScale=t,this.navBarWidth=e,this.navBarHeight=i,this.relayout()}})}),define("JOIST/Frame",["require","PHET_CORE/inherit","SCENERY/nodes/Node","SCENERY/nodes/Rectangle","SCENERY/util/LinearGradient"],function(t){function e(t,e){var i=this;e=_.extend({xMargin1:6,yMargin1:6,cornerRadius:0},e),n.call(i);var o=t.width+2*e.xMargin1,a=t.height+2*e.yMargin1;this.gradient=new r(0,0,o,0).addColorStop(0,"#fbff41").addColorStop(.1475,"#fef98b").addColorStop(.465,"#feff40").addColorStop(.77,"#fffccd").addColorStop(1,"#fbff41"),this.rectangle=new s(0,0,o,a,e.cornerRadius,e.cornerRadius,{stroke:this.gradient,lineWidth:3,x:t.x-e.xMargin1,y:t.y-e.yMargin1}),this.addChild(this.rectangle),this.mutate(e),this.width1=o,this.height1=a}var i=t("PHET_CORE/inherit"),n=t("SCENERY/nodes/Node"),s=t("SCENERY/nodes/Rectangle"),r=t("SCENERY/util/LinearGradient");return i(n,e,{setHighlighted:function(t){this.rectangle.lineWidth=t?4.5:3,t?this.rectangle.setRect(-0.75,-0.75,this.width1+1.5,this.height1+1.5):this.rectangle.setRect(0,0,this.width1,this.height1)}}),e}),define("AXON/Property",["require","AXON/log","AXON/axon"],function(t){var e=t("AXON/log"),i=t("AXON/axon");return i.Property=function(t){this._value=t,this._initialValue=t,this._observers=[],e.registerProperty(this)},i.Property.prototype={get:function(){return this._value},set:function(t){if(t!==this._value){var e=this._value;this._value=t;for(var i=this._observers.slice(),n=0;n<i.length;n++)i[n](t,e)}},reset:function(){this.set(this._initialValue)},_set:function(t){return this.set.bind(this,t)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){-1===this._observers.indexOf(t)&&(this._observers.push(t),t(this._value,null))},unlink:function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,e+1)},lazyLink:function(t){-1===this._observers.indexOf(t)&&this._observers.push(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},once:function(t){var e=this,i=function(n,s){t(n,s),e.unlink(i)};return this.lazyLink(i),i},linkAttribute:function(t,e){var i=function(i){t[e]=i};return this.link(i),i},valueEquals:function(t){return new i.DerivedProperty([this],function(e){return e===t})},not:function(){var t=this,e=new i.Property(!this.value),n=function(t){e.set(!t)};t.link(n);var s=function(e){t.set(!e)};return e.link(s),e.detach=function(){t.unlink(n),e.unlink(s)},e},debug:function(t){var e=function(e){console.log(t,e)};return this.link(e),e}},i.Property}),define("JOIST/FullScreenButton",["require","SCENERY/nodes/Node","SCENERY/nodes/Path","KITE/Shape","SCENERY/util/LinearGradient","SUN/FontAwesomeNode","PHET_CORE/inherit","SCENERY/input/ButtonListener","SCENERY/input/Input"],function(t){function e(t){var e=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(e)e.call(t);else if("undefined"!=typeof window.ActiveXObject){var i=new ActiveXObject("WScript.Shell");null!==i&&i.SendKeys("{F11}")}}function i(t){n.call(this,{cursor:"pointer"}),this.addChild(new s("fullscreen",{fill:"#fff",scale:.8})),this.mutate(_.extend({cursor:"pointer"},t)),this.addInputListener({down:function(){$("body").one("mouseup",o)}}),this.mouseArea=this.bounds,this.touchArea=this.bounds}var n=t("SCENERY/nodes/Node");t("SCENERY/nodes/Path"),t("KITE/Shape"),t("SCENERY/util/LinearGradient");var s=t("SUN/FontAwesomeNode"),r=t("PHET_CORE/inherit");t("SCENERY/input/ButtonListener"),t("SCENERY/input/Input");var o=function(){e(document.body)};return r(n,i)}),define("JOIST/HomeScreen",["require","JOIST/PhetButton","SCENERY/nodes/Node","SCENERY/nodes/HBox","SCENERY/nodes/VBox","SCENERY/nodes/Text","KITE/Shape","PHET_CORE/inherit","JOIST/ScreenView","JOIST/Frame","SCENERY/nodes/Rectangle","AXON/Property","SCENERY/input/ButtonListener","JOIST/FullScreenButton","SCENERY_PHET/PhetFont"],function(t){function e(t){function e(t){var e=new RegExp("msie"+(isNaN(t)?"":"\\s"+t),"i");return e.test(navigator.userAgent)}var h=this;u.call(this,{renderer:"svg"}),this.backgroundColor="black";var m=new o(t.name,{font:new d({size:52,family:"Century Gothic, Futura"}),fill:"white",y:110,centerX:this.layoutBounds.width/2});this.addChild(m);var p=new c(-1),g=_.map(t.screens,function(e){var i=t.screens.indexOf(e),s=new n({children:[e.icon],scale:2*(f/e.icon.height)}),h=new l(s);p.link(function(t){h.setHighlighted(t===i)});var u=new n({children:[h,s]}),c=new r({cursor:"pointer",children:[u,new o(e.name,{font:new d(42),fill:"yellow"})]});c.addInputListener({down:function(){t.simModel.showHomeScreen=!1,p.value=-1}});var m=new r({spacing:3,cursor:"pointer",children:[new n({opacity:.5,children:[e.icon],scale:4===t.screens.length?f/e.icon.height:3===t.screens.length?1.25*f/e.icon.height:2===t.screens.length?1.75*f/e.icon.height:f/e.icon.height}),new o(e.name,{font:new d(18),fill:"gray"})]});m.mouseArea=m.touchArea=a.bounds(m.bounds),m.addInputListener({down:function(){t.simModel.screenIndex=i},over:function(e){e.pointer.isMouse||(t.simModel.screenIndex=i)}});var g={over:function(t){t.pointer.isMouse&&(p.value=i,m.children[0].opacity=1,m.children[1].fill="white")},out:function(t){t.pointer.isMouse&&(p.value=-1,m.children[0].opacity=.5,m.children[1].fill="gray")}};return m.addInputListener(g),c.addInputListener(g),c.mouseArea=c.touchArea=a.bounds(c.bounds),{screen:e,small:m,large:c,index:i}}),v=new n({y:170});h.addChild(v),t.simModel.screenIndexProperty.link(function(e){var i=2===t.screens.length?60:3===t.screens.length?60:33,n=_.map(g,function(t){return t.index===e?t.large:t.small});v.children=[new s({spacing:i,children:n,align:"top"})],v.centerX=h.layoutBounds.width/2});{navigator.userAgent.indexOf("Android")>0,/iP(ad|hone|od)/.test(navigator.userAgent),e(9)||e(10)}this.addChild(new i(t,{phetLogo:"phet-logo-short.svg",phetLogoScale:.4,optionsButtonVerticalMargin:6}).mutate({right:this.layoutBounds.maxX-5,bottom:this.layoutBounds.maxY-5}))}var i=t("JOIST/PhetButton"),n=t("SCENERY/nodes/Node"),s=t("SCENERY/nodes/HBox"),r=t("SCENERY/nodes/VBox"),o=t("SCENERY/nodes/Text"),a=t("KITE/Shape"),h=t("PHET_CORE/inherit"),u=t("JOIST/ScreenView"),l=t("JOIST/Frame");t("SCENERY/nodes/Rectangle");var c=t("AXON/Property");t("SCENERY/input/ButtonListener");var d=(t("JOIST/FullScreenButton"),t("SCENERY_PHET/PhetFont")),f=70;return h(u,e)}),define("version",[],function(){return function(){return"1.1.0-rc2"}}),define("AXON/DerivedProperty",["require","AXON/Property","AXON/axon"],function(t){t("AXON/Property");var e=t("AXON/axon");return e.DerivedProperty=function(t,e){function i(){var i=t.map(function(t){return t.get()}),s=e.apply(null,i);if(s!==n._value){var r=n._value;n._value=s,n.observers.forEach(function(t){t(s,r)})}}this.observers=[],this.dependencies=t;var n=this;this.update=i,t.forEach(function(t){t.lazyLink(i)}),i()},e.DerivedProperty.prototype={get value(){return this._value},get:function(){return this._value},link:function(t){this.observers.push(t),t(this._value)},linkAttribute:function(t,e){var i=function(i){t[e]=i};return this.link(i),i},unlink:function(t){var e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,e+1)},lazyLink:function(t){this.observers.push(t)},detach:function(){var t=this;this.dependencies.forEach(function(e){e.unlink(t.update)})}},e.DerivedProperty}),define("AXON/PropertySet",["require","AXON/Property","AXON/DerivedProperty","AXON/axon"],function(t){var e=t("AXON/Property"),i=t("AXON/DerivedProperty"),n=t("AXON/axon");return n.PropertySet=function(t){var e=this;this.keys=[],Object.getOwnPropertyNames(t).forEach(function(i){e.addProperty(i,t[i])}),this.eventListeners={}},n.PropertySet.prototype={addProperty:function(t,i){this[t+"Property"]=new e(i),this.addGetterAndSetter(t),this.keys.push(t)},removeProperty:function(t){var e=this.keys.indexOf(t);-1!==e&&this.keys.splice(e,e+1),delete this[t+"Property"],delete this[t]},addGetterAndSetter:function(t){var e=t+"Property";Object.defineProperty(this,t,{get:function(){return this[e].get()},set:function(t){this[e].set(t)},configurable:!0,enumerable:!0})},addGetter:function(t){var e=t+"Property";Object.defineProperty(this,t,{get:function(){return this[e].get()},configurable:!0,enumerable:!0})},reset:function(){var t=this;this.keys.forEach(function(e){t[e+"Property"].reset()})},toDerivedProperty:function(t,e){var n=this,s=t.map(function(t){return n[t+"Property"]});return new i(s,e)},addDerivedProperty:function(t,e,i){this[t+"Property"]=this.toDerivedProperty(e,i),this.addGetter(t)},set:function(t){var e=this;Object.getOwnPropertyNames(t).forEach(function(i){e[i+"Property"].set(t[i])})},multilink:function(t,e){return this.toDerivedProperty(t,e)},unmultilink:function(t){t.detach()},toString:function(){for(var t="PropertySet{",e=this,i=0;i<this.keys.length;i++){var n=this.keys[i];t=t+n+":"+e[n].toString(),i<this.keys.length-1&&(t+=",")}return t+"}"},on:function(t,e){this.eventListeners[t]=this.eventListeners[t]||[],this.eventListeners[t].push(e)},once:function(t,e){var i=this,n=function(){i.off(t,n),0===arguments.length?e():e.apply(this,Array.prototype.slice.call(arguments,0))};return this.on(t,n),n},off:function(t,e){if(this.eventListeners[t]){var i=this.eventListeners[t].indexOf(e);-1!==i&&this.eventListeners[t].splice(i,i+1)}},trigger:function(t){if(this.eventListeners[t])for(var e=this.eventListeners[t].slice(),i=0;i<e.length;i++){var n=e[i];if(1===arguments.length)n(arguments);else{var s=Array.prototype.slice.call(arguments,1);n.apply(this,s)}}}},n.PropertySet}),define("JOIST/share/Pointer",["require"],function(){function t(){}return t}),define("JOIST/share/Pointers",["require","JOIST/share/Pointer"],function(t){return t("JOIST/share/Pointer"),[]}),define("JOIST/share/LogPointers",["require","JOIST/share/Pointer","JOIST/share/Pointers"],function(t){function e(){this.pointers=new n}var i=t("JOIST/share/Pointer"),n=t("JOIST/share/Pointers");return e.prototype={startLogging:function(){var t=this;window.addEventListener("mousemove",function(e){var n={x:e.clientX,y:e.clientY};0===t.pointers.length?t.pointers.add(new i(n)):t.pointers.at(0).set(n)},!1),window.addEventListener("touchmove",function(e){for(var n=e.touches,s=0;s<n.length;s++){var r=n[s],o={x:r.pageX,y:r.pageY};s>=t.pointers.length?t.pointers.add(new i(o)):t.pointers.at(s).set(o)}for(;t.pointers.length>n.length;)t.pointers.pop()},!1)},showPointers:function(){var t=this;this.pointers.on("add",function(e){var i=$('<img id="cursor">');i.attr("src","http://dc440.4shared.com/img/mFJBl0A0/s7/mouse-cursor-icon.png"),i.css({zIndex:9999,position:"absolute",width:12,height:20,"pointer-events":"none"}),i.appendTo("body"),e.on("change:x change:y",function(){i.css({left:e.x,top:e.y})}),t.pointers.on("remove",function(t){t===e&&i.detach()})})}},e}),define("JOIST/Sim",["require","SCENERY/util/Util","JOIST/NavigationBar","JOIST/HomeScreen","SCENERY/Scene","SCENERY/nodes/Node","SCENERY/nodes/Text","DOT/Vector2","DOT/Bounds2","version","AXON/PropertySet","SCENERY_PHET/PhetFont","AXON/log","JOIST/share/LogPointers"],function(require){function Sim(t,e,i){function n(t){return"true"===t?!0:!1}i=_.extend({showHomeScreen:!0,screenIndex:0,standalone:!1,credits:"",thanks:""},i),this.options=i;var s=this;window.sim=s,s.name=t,s.version=version(),s.credits=i.credits,s.thanks=i.thanks,s.frameCounter=0,s.inputEventLog=[],s.inputEventBounds=Bounds2.NOTHING,s.fuzzMouseAverage=10,s.fuzzMouseIsDown=!1,s.fuzzMousePosition=new Vector2,s.fuzzMouseLastMoved=!1,$("title").html(t+" "+s.version),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("showHomeScreen")&&(i.showHomeScreen=n(window.phetcommon.getQueryParameter("showHomeScreen"))),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("screenIndex")&&(i.screenIndex=parseInt(window.phetcommon.getQueryParameter("screenIndex"),10)),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("recordInputEventLog")&&(i.recordInputEventLog=!0,i.inputEventLogName=window.phetcommon.getQueryParameter("recordInputEventLog")),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("playbackInputEventLog")&&(i.playbackInputEventLog=!0,i.inputEventLogName=window.phetcommon.getQueryParameter("playbackInputEventLog")),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("fuzzMouse")&&(i.fuzzMouse=!0,"undefined"!==window.phetcommon.getQueryParameter("fuzzMouse")&&(s.fuzzMouseAverage=parseFloat(window.phetcommon.getQueryParameter("fuzzMouse")))),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("fuzzTouches")&&(i.fuzzTouches=!0),window.phetcommon&&window.phetcommon.getQueryParameter&&window.phetcommon.getQueryParameter("standalone")&&(i.standalone=!0,e=[e[i.screenIndex]],i.screenIndex=0);var r=_.isUndefined(i.showHomeScreen)?!0:i.showHomeScreen;1===e.length&&(r=!1),s.screens=e,s.simModel=new PropertySet({showHomeScreen:r,screenIndex:i.screenIndex||0});var o=$("body");o.css("padding","0").css("margin","0").css("overflow","hidden");var a=$("<div>").attr("id","sim").css("position","absolute").css("left",0).css("top",0);o.append(a),s.scene=new Scene(a,{allowDevicePixelRatioScaling:!1,accessible:!0}),s.scene.sim=s,s.scene.initializeWindowEvents({batchDOMEvents:!0}),i.recordInputEventLog&&(s.scene.input.logEvents=!0),window.simScene=s.scene,s.navigationBar=new NavigationBar(s,e,s.simModel),e.length>1&&(s.homeScreen=new HomeScreen(s));var h=new Node,u=new Node({layerSplit:!0}),l=function(){if(s.simModel.showHomeScreen)a.css("background","black");else{var t=e[s.simModel.screenIndex].backgroundColor||"white",i="string"==typeof t?t:t.toCSS();a.css("background",i)}};s.simModel.showHomeScreenProperty.link(function(t){h.children=t?[]:[u],s.scene.children=t?[s.homeScreen]:[h,s.navigationBar],l()}),_.each(e,function(t){t.model=t.createModel(),t.view=t.createView(t.model)}),s.simModel.screenIndexProperty.link(function(t){u.children=[e[t].view],l()}),l(),$(window).resize(function(){s.resizeToWindow()}),s.resizeToWindow()}var Util=require("SCENERY/util/Util"),NavigationBar=require("JOIST/NavigationBar"),HomeScreen=require("JOIST/HomeScreen"),Scene=require("SCENERY/Scene"),Node=require("SCENERY/nodes/Node"),Text=require("SCENERY/nodes/Text"),Vector2=require("DOT/Vector2"),Bounds2=require("DOT/Bounds2"),version=require("version"),PropertySet=require("AXON/PropertySet"),PhetFont=require("SCENERY_PHET/PhetFont"),log=require("AXON/log"),LogPointers=require("JOIST/share/LogPointers");return Sim.prototype.resizeToWindow=function(){this.resize($(window).width(),$(window).height())},Sim.prototype.resize=function(t,e){var i=this,n=Math.min(t/768,e/504),s=40*n;i.navigationBar.layout(n,t,s,e),i.navigationBar.y=e-s,i.scene.resize(t,e),_.each(i.screens,function(n){n.view.layout(t,e-i.navigationBar.height)}),i.homeScreen&&i.homeScreen.layout(t,e),i.scene.input.eventLog.push("scene.sim.resize("+t+","+e+");")},Sim.prototype.start=function(){var sim=this;if(this.options.playbackInputEventLog){var request=new XMLHttpRequest;
return request.open("GET",this.getEventLogLocation(),!0),request.onload=function(e){sim.startInputEventPlayback(eval(request.responseText))},request.send(),void 0}var lastTime=-1;Util.polyfillRequestAnimationFrame(),function t(){var e;if(sim.frameCounter++,window.requestAnimationFrame(t),sim.options.fuzzMouse?sim.fuzzMouseEvents():sim.options.fuzzTouches||sim.scene.fireBatchedEvents(),!sim.simModel.showHomeScreen){var i=Date.now(),n=-1===lastTime?1e3/60:i-lastTime;lastTime=i,e=n/1e3,sim.screens[sim.simModel.screenIndex].model.step(e)}if(window.TWEEN&&window.TWEEN.update(),sim.options.recordInputEventLog){var s={dt:e,events:sim.scene.input.eventLog,id:sim.frameCounter,time:Date.now()};sim.inputEventBounds.equals(sim.scene.sceneBounds)||(sim.inputEventBounds=sim.scene.sceneBounds.copy(),s.width=sim.scene.sceneBounds.width,s.height=sim.scene.sceneBounds.height),sim.inputEventLog.push(s),sim.scene.input.eventLog=[]}sim.scene.updateScene()}()},Sim.prototype.startPlayback=function(t){var e=this,i=0,n=t[0].time;Util.polyfillRequestAnimationFrame();var s=0;!function r(){if(i>=t.length)return console.log(s),e.scene.addChild(new Text("Elapsed time (ms): "+s,{x:100,y:100,font:new PhetFont(32)})),e.scene.updateScene(),void 0;window.requestAnimationFrame(r);var o=Date.now();i=log.stepUntil(t,n,i),n+=17,e.scene.updateScene();var a=Date.now(),h=a-o;s+=h}()},Sim.prototype.startInputEventPlayback=function(t){var e=this,i=0;Util.polyfillRequestAnimationFrame(),t.length&&t[0].width&&e.resize(t[0].width,t[0].height);var n=Date.now();!function s(){var r=t[i++];if(void 0===r){var o=Date.now(),a=o-n,h=t.length/(a/1e3);return document.body.innerHTML='<div style="text-align: center; font-size: 16px;"><h1>Performance results:</h1><p>Approximate frames per second: <strong>'+h.toFixed(1)+"</strong></p>"+"<p>Average time per frame (ms/frame): <strong>"+(a/i).toFixed(1)+"</strong></p>"+"<p>Elapsed time: <strong>"+a+"ms</strong></p>"+"<p>Number of frames: <strong>"+i+"</strong></p>"+"</div>",document.body.style.backgroundColor="#fff",void 0}window.requestAnimationFrame(s),r.fireEvents&&r.fireEvents(e.scene,function(t,e){return new Vector2(t,e)}),e.simModel.showHomeScreen||e.screens[e.simModel.screenIndex].model.step(r.dt),window.TWEEN&&window.TWEEN.update(),e.scene.updateScene()}()},Sim.prototype.addChild=function(t){this.scene.addChild(t)},Sim.prototype.getRecordedInputEventLogString=function(){return"[\n"+_.map(this.inputEventLog,function(t){var e="fireEvents:function(scene,dot){"+_.map(t.events,function(t){return"scene.input."+t}).join("")+"}";return"{dt:"+t.dt+(t.events.length?","+e:"")+(t.width?",width:"+t.width:"")+(t.height?",height:"+t.height:"")+",id:"+t.id+",time:"+t.time+"}"}).join(",\n")+"\n]"},Sim.prototype.getEventLogName=function(){var t=this.options.inputEventLogName;return"browser"===t&&(t=window.navigator.userAgent),(this.name+"_"+t).replace(/[^a-zA-Z0-9]/g,"_")},Sim.prototype.getEventLogLocation=function(){var t=window.location.host.split(":")[0];return"//"+t+":8083/"+this.getEventLogName()},Sim.prototype.submitEventLog=function(){if(this.options.recordInputEventLog){var t=this.getRecordedInputEventLogString(),e=new XMLHttpRequest;e.open("POST",this.getEventLogLocation(),!0),e.setRequestHeader("Content-type","text/javascript"),e.send(t)}},Sim.prototype.mailEventLog=function(){if(this.options.recordInputEventLog){var t=this.getRecordedInputEventLogString();window.open("mailto:phethelp@colorado.edu?subject="+encodeURIComponent(this.name+" input event log at "+Date.now())+"&body="+encodeURIComponent(t))}},Sim.prototype.fuzzMouseEvents=function(){for(var t,e=this;(t=Math.random())<1-1/e.fuzzMouseAverage;){var i;t<(e.fuzzMouseLastMoved?.02:.4)?(i=document.createEvent("MouseEvent"),i.initMouseEvent(e.fuzzMouseIsDown?"mouseup":"mousedown",!0,!0,window,1,e.fuzzMousePosition.x,e.fuzzMousePosition.y,e.fuzzMousePosition.x,e.fuzzMousePosition.y,!1,!1,!1,!1,0,null),e.scene.input.validatePointers(),e.fuzzMouseIsDown?(e.scene.input.mouseUp(e.fuzzMousePosition,i),e.fuzzMouseIsDown=!1):(e.scene.input.mouseDown(e.fuzzMousePosition,i),e.fuzzMouseIsDown=!0)):(e.fuzzMousePosition=new Vector2(Math.floor(Math.random()*e.scene.sceneBounds.width),Math.floor(Math.random()*e.scene.sceneBounds.height)),i=document.createEvent("MouseEvent"),i.initMouseEvent("mousemove",!0,!0,window,0,e.fuzzMousePosition.x,e.fuzzMousePosition.y,e.fuzzMousePosition.x,e.fuzzMousePosition.y,!1,!1,!1,!1,0,null),e.scene.input.validatePointers(),e.scene.input.mouseMove(e.fuzzMousePosition,i))}},Sim}),function(){function t(t,e,i,n,s,r){e[t]&&(i.push(t),(e[t]===!0||1===e[t])&&n.push(s+t+"/"+r))}function e(t,e,i,n,s){var r=n+e+"/"+s;require._fileExists(t.toUrl(r+".js"))&&i.push(r)}function i(t,e,n){var s;for(s in e)!e.hasOwnProperty(s)||t.hasOwnProperty(s)&&!n?"object"==typeof e[s]&&i(t[s],e[s],n):t[s]=e[s]}var n=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(s){var r=s.config?s.config():{};return{version:"2.0.1+",load:function(s,o,a,h){h=h||{},h.locale&&(r.locale=h.locale);var u,l,c,d=n.exec(s),f=d[1],m=d[4],p=d[5],g=m.split("-"),v=[],y={},E="";if(d[5]?(f=d[1],u=f+p):(u=s,p=d[4],m=r.locale,m||(m=r.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=m.split("-")),h.isBuild){for(v.push(u),e(o,"root",v,f,p),l=0;l<g.length;l++)c=g[l],E+=(E?"-":"")+c,e(o,E,v,f,p);o(v,function(){a()})}else o([u],function(e){var n,s=[];for(t("root",e,s,v,f,p),l=0;l<g.length;l++)n=g[l],E+=(E?"-":"")+n,t(E,e,s,v,f,p);o(v,function(){var t,n,r;for(t=s.length-1;t>-1&&s[t];t--)r=s[t],n=e[r],(n===!0||1===n)&&(n=o(f+r+"/"+p)),i(y,n);a(y)})})}}})}(),define("../nls/resistance-in-a-wire-strings",{root:{simTitle:"Resistance in a Wire",cm:"cm",ohm:"ohm",resistivity:"resistivity",length:"length",area:"area",resistanceEq:"Resistance ="},am:!0,ar:!0,"ar-sa":!0,da:!0,de:!0,el:!0,es:!0,"es-pe":!0,et:!0,eu:!0,fa:!0,fi:!0,fr:!0,gl:!0,hr:!0,hu:!0,"in":!0,it:!0,iw:!0,ja:!0,ka:!0,ko:!0,lv:!0,mk:!0,mn:!0,nl:!0,pl:!0,pt:!0,"pt-br":!0,ro:!0,ru:!0,sk:!0,sr:!0,sv:!0,tk:!0,tr:!0,vi:!0,"zh-cn":!0,"zh-tw":!0}),define("resistance-in-a-wire-strings",["require","i18n!../nls/resistance-in-a-wire-strings"],function(t){var e=t("i18n!../nls/resistance-in-a-wire-strings");return e}),define("model/ResistanceInAWireModel",["require","AXON/PropertySet","PHET_CORE/inherit"],function(t){function e(){var t=this;i.call(this,{resistance:0,resistivity:.5,length:10,area:7.5});var e=function(){t.resistance=t.resistivity*t.length/t.area};this.resistivityProperty.link(e),this.lengthProperty.link(e),this.areaProperty.link(e),this.reset()}var i=t("AXON/PropertySet"),n=t("PHET_CORE/inherit");return n(i,e,{step:function(){},reset:function(){this.resistivityProperty.reset(),this.lengthProperty.reset(),this.areaProperty.reset()}}),e}),define("imageLoader",["require"],function(){return{imageNames:["slider.png","reset_button_disabled.png","reset_button_down.png","reset_button_over.png","reset_button_up.png"]}}),define("SUN/PushButton",["require","SCENERY/input/ButtonListener","PHET_CORE/inherit","SCENERY/nodes/Node","AXON/Property"],function(t){function e(t,e,n,o,a,h){h=_.extend({cursor:"pointer",label:"Button"},h);var u=this;s.call(u),u._upNode=t,u._overNode=e,u._downNode=n,u._disabledNode=o,u._state="up",u._enabled=new r(!0),u._listeners=[a],u.addChild(t),u.addChild(e),u.addChild(n),u.addChild(o),u.addInputListener(new i({up:function(){u._state="up",u._update()},over:function(){u._state="over",u._update()},down:function(){u._state="down",u._update()},out:function(){u._state="up",u._update()},fire:function(){u._fire()}})),u.addPeer('<input type="button" aria-label="'+_.escape(h.label)+'">',{click:u._fire.bind(u)}),u._enabled.link(function(t){u.cursor=t?h.cursor:"default",u._update()}),u.mutate(h)}var i=t("SCENERY/input/ButtonListener"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Node"),r=t("AXON/Property");return n(s,e,{addListener:function(t){-1===this._listeners.indexOf(t)&&this._listeners.push(t)},removeListener:function(t){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)},_fire:function(){this._listeners.forEach(function(t){t()})},_update:function(){var t=this._enabled.get();this._upNode.visible="up"===this._state&&t,this._downNode.visible="down"===this._state&&t,this._overNode.visible="over"===this._state&&t,this._disabledNode.visible=!t},set enabled(t){this._enabled.set(t)},get enabled(){return this._enabled.get()}})}),define("view/ResetAllButton",["require","imageLoader","SCENERY/nodes/Image","PHET_CORE/inherit","SUN/PushButton","DOT/Vector2"],function(t){function e(t,e){o.call(this,new i(n.getImage("reset_button_up.png")),new i(n.getImage("reset_button_over.png")),new i(n.getImage("reset_button_down.png")),new i(n.getImage("reset_button_disabled.png")),t,e)}function i(t){s.call(this,t)}var n=t("imageLoader"),s=t("SCENERY/nodes/Image"),r=t("PHET_CORE/inherit"),o=t("SUN/PushButton"),a=t("DOT/Vector2"),h=33,u=h*h,l=new a(h,h);return r(s,i,{containsPointSelf:function(t){return t.distanceSquared(l)<=u}}),r(o,e)}),define("SCENERY_PHET/ArrowShape",["require","PHET_CORE/inherit","KITE/Shape","DOT/Vector2"],function(t){function e(t,e,i,r,o){o=_.extend({tailWidth:5,headWidth:10,headHeight:10,doubleHead:!1},o);var a=this;if(n.call(a),i!==t||r!==e){var h=new s(i-t,r-e),u=h.normalized(),l=u.rotated(Math.PI/2),c=h.magnitude();o.headHeight=Math.min(o.headHeight,o.doubleHead?.35*c:.5*c);var d=function(i,n){var r=u.x*i+l.x*n+t,o=u.y*i+l.y*n+e;return new s(r,o)},f=[];o.doubleHead?(f.push(d(0,0)),f.push(d(o.headHeight,o.headWidth/2)),f.push(d(o.headHeight,o.tailWidth/2))):f.push(d(0,o.tailWidth/2)),f.push(d(c-o.headHeight,o.tailWidth/2)),f.push(d(c-o.headHeight,o.headWidth/2)),f.push(d(c,0)),f.push(d(c-o.headHeight,-o.headWidth/2)),f.push(d(c-o.headHeight,-o.tailWidth/2)),o.doubleHead?(f.push(d(o.headHeight,-o.tailWidth/2)),f.push(d(o.headHeight,-o.headWidth/2))):f.push(d(0,-o.tailWidth/2)),a.moveTo(f[0].x,f[0].y);var m=_.tail(f);_.each(m,function(t){a.lineTo(t.x,t.y)}),a.close()}}var i=t("PHET_CORE/inherit"),n=t("KITE/Shape"),s=t("DOT/Vector2");return i(n,e)}),define("SCENERY_PHET/ArrowNode",["require","SCENERY_PHET/ArrowShape","ASSERT/assert","PHET_CORE/inherit","SCENERY/nodes/Path","SCENERY/nodes/Node"],function(t){function e(t,e,s,a,h){h=_.extend({headHeight:10,headWidth:10,tailWidth:5,doubleHead:!1,fill:"black",stroke:"black",lineWidth:1},h),n&&n(h.headWidth>h.tailWidth),h.shape=new i(t,e,s,a,h);var u=new r(h);o.call(this,h),this.addChild(u)}var i=t("SCENERY_PHET/ArrowShape"),n=t("ASSERT/assert")("scenery-phet"),s=t("PHET_CORE/inherit"),r=t("SCENERY/nodes/Path"),o=t("SCENERY/nodes/Node");return s(o,e)}),define("view/shape-views/slider-box-view/WhiteBox",["require","SCENERY/nodes/Node","PHET_CORE/inherit","SCENERY/nodes/Rectangle"],function(t){function e(t,e,n,r){i.call(this),this.addChild(new s(t,e,n,r,12,12,{fill:"#FFF",stroke:"#000",lineWidth:3}))}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Rectangle");return n(i,e),e}),define("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){var e=t("DOT/dot");return t("DOT/Util"),e.LinearFunction=function(t,i,n,s,r){r=_.isUndefined(r)?!1:r;var o=function(t,i,n,s,r,o){var a=e.Util.linear(t,i,n,s,r);if(o){var h=Math.max(n,s),u=Math.min(n,s);a=e.Util.clamp(a,u,h)}return a},a=function(e){return o(t,i,n,s,e,r)};return a.inverse=function(e){return o(n,s,t,i,e,r)},a},e.LinearFunction}),define("view/shape-views/slider-box-view/Slider",["require","SCENERY/nodes/Node","PHET_CORE/inherit","SCENERY/nodes/Image","SCENERY/nodes/Rectangle","SCENERY/input/SimpleDragHandler","DOT/LinearFunction"],function(t){function e(t,e,n,h,u,l){var c=this;i.call(this,{x:t,y:e}),this.addChild(new r(-3,0,6,n,{fill:"black"}));var d,f=new i({children:[new s(u,{centerX:0,top:0})],cursor:"pointer"}),m=0,p=n-f.height,g=new a(l.min,l.max,p,m,!0),v=new a(p,m,l.min,l.max,!0);this.addChild(f),f.addInputListener(new o({start:function(t){d=c.globalToParentPoint(t.pointer.point).y-t.currentTarget.y},drag:function(t){var e=c.globalToParentPoint(t.pointer.point).y-d;e=Math.max(Math.min(e,p),m),h.set(v(e))},translate:function(){}})),h.link(function(t){f.y=g(t)})}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Image"),r=t("SCENERY/nodes/Rectangle"),o=t("SCENERY/input/SimpleDragHandler"),a=t("DOT/LinearFunction");return n(i,e),e}),define("view/shape-views/slider-box-view/CurrentResistanceView",["require","SCENERY/nodes/Node","PHET_CORE/inherit","resistance-in-a-wire-strings","SCENERY/nodes/Text","SCENERY_PHET/PhetFont"],function(t){function e(t,e,n,o){i.call(this,{x:e,y:n});var h,u=new i,l=.95*o;u.addChild(new r(s.resistanceEq,{font:a,fill:"#F00",right:200,y:0})),u.addChild(h=new r("2000",{font:a,fill:"#F00",right:290,y:0})),u.addChild(new r(s.ohm,{font:a,fill:"#F00",left:300,y:0})),u.centerX=0,u.centerY=0,this.addChild(u);var c=1;u.width>l&&(c=l/u.width),this.scale(c),t.resistanceProperty.link(function(t){h.text=t.toFixed(2),t>9&&(h.text=t.toFixed(1)),t>99&&(h.text=t.toFixed(0)),h.right=290})}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("resistance-in-a-wire-strings"),r=t("SCENERY/nodes/Text"),o=t("SCENERY_PHET/PhetFont"),a=new o(30);return n(i,e),e}),define("view/shape-views/SlidersBox",["require","SCENERY/nodes/Node","PHET_CORE/inherit","resistance-in-a-wire-strings","view/shape-views/slider-box-view/WhiteBox","view/shape-views/slider-box-view/Slider","view/shape-views/slider-box-view/CurrentResistanceView","imageLoader","SCENERY/nodes/Text","SCENERY_PHET/PhetFont"],function(t){function e(t,e,n,c){i.call(this,{x:e,y:n});var d,f,m,p=380,g=500;this.addChild(new r(0,0,p,g));var v=[60,120,410,453],y=[70,195,320];this.addChild(new u("œÅ",{font:new l({family:"Times New Roman",size:60}),fill:"#0f0ffb",centerX:y[0],top:v[0]-10})),this.addChild(new u(s.resistivity,{font:new l(16),textAlign:"center",textAnchor:"middle",fill:"#0f0ffb",centerX:y[0],top:v[1]})),this.addChild(d=new u(t.resistivity.toFixed(2),{font:new l(30),textAlign:"end",textAnchor:"end",fill:"#000",centerX:y[0],top:v[2]})),this.addChild(new u("Œ©"+s.cm,{font:new l(30),textAlign:"start",textAnchor:"start",fill:"#0f0ffb",centerX:y[0],top:v[3]})),this.addChild(new u("L",{font:new l({family:"Times New Roman",size:60}),fill:"#0f0ffb",centerX:y[1],top:v[0]})),this.addChild(new u(s.length,{font:new l(16),textAlign:"center",textAnchor:"middle",fill:"#0f0ffb",centerX:y[1],top:v[1]})),this.addChild(f=new u(t.length.toFixed(2),{font:new l(30),textAlign:"end",textAnchor:"end",fill:"#000",centerX:y[1],top:v[2]})),this.addChild(new u(s.cm,{font:new l(30),textAlign:"start",textAnchor:"start",fill:"#0f0ffb",centerX:y[1],top:v[3]})),this.addChild(new u("A",{font:new l({family:"Times New Roman",size:60}),fill:"#0f0ffb",centerX:y[2],top:v[0]})),this.addChild(new u(s.area,{font:new l(16),textAlign:"center",textAnchor:"middle",fill:"#0f0ffb",centerX:y[2],top:v[1]})),this.addChild(m=new u(t.area.toFixed(2),{font:new l(30),textAlign:"end",textAnchor:"end",fill:"#000",centerX:y[2],top:v[2]})),this.addChild(new u(s.cm+"¬≤",{font:new l(30),textAlign:"start",textAnchor:"start",fill:"#0f0ffb",centerX:y[2],top:v[3]})),this.addChild(new o(y[0],145,260,t.resistivityProperty,h.getImage("slider.png"),c.resistivity)),this.addChild(new o(y[1],145,260,t.lengthProperty,h.getImage("slider.png"),c.length)),this.addChild(new o(y[2],145,260,t.areaProperty,h.getImage("slider.png"),c.area)),t.resistivityProperty.link(function(t){d.text=t.toFixed(2),d.centerX=y[0]}),t.lengthProperty.link(function(t){f.text=t.toFixed(2),f.centerX=y[1]}),t.areaProperty.link(function(t){m.text=t.toFixed(2),m.centerX=y[2]}),this.addChild(new a(t,p/2,30,p))}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("resistance-in-a-wire-strings"),r=t("view/shape-views/slider-box-view/WhiteBox"),o=t("view/shape-views/slider-box-view/Slider"),a=t("view/shape-views/slider-box-view/CurrentResistanceView"),h=t("imageLoader"),u=t("SCENERY/nodes/Text"),l=t("SCENERY_PHET/PhetFont");return n(i,e),e}),define("view/shape-views/FormulaView",["require","SCENERY/nodes/Node","PHET_CORE/inherit","SCENERY/nodes/Text","DOT/Matrix3","SCENERY/nodes/Path","KITE/Shape","SCENERY_PHET/PhetFont"],function(t){function e(t,e,n){var u=this;i.call(this,{x:e,y:n});var l=[{label:"R",scale:1.5,x:20,y:0,targetProperty:"resistanceProperty",color:"#ed1c24"},{label:"œÅ",x:220,y:-110,targetProperty:"resistivityProperty",color:"#0f0ffb"},{label:"L",x:320,y:-90,targetProperty:"lengthProperty",color:"#0f0ffb"},{label:"A",x:280,y:90,targetProperty:"areaProperty",color:"#0f0ffb"}];u.addChild(new s("=",{font:new h({family:"Times New Roman",size:100}),fill:"#000",centerX:100,centerY:0})),u.addChild(new o({shape:a.lineSegment(150,8,400,8),stroke:"black",lineWidth:6})),l.forEach(function(e){e.view=new s(e.label,{font:new h({family:"Times New Roman",size:130}),fill:e.color,centerX:e.x,centerY:e.y}),u.addChild(e.view),e.scale=e.scale||1/t[e.targetProperty].get(),t[e.targetProperty].link(function(t){e.view.matrix=new r,e.view.scale(e.scale*t+.125),e.view.centerX=e.x,e.view.centerY=e.y})})}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Text"),r=t("DOT/Matrix3"),o=t("SCENERY/nodes/Path"),a=t("KITE/Shape"),h=t("SCENERY_PHET/PhetFont");return n(i,e),e}),define("SCENERY/nodes/Circle",["require","PHET_CORE/inherit","SCENERY/scenery","SCENERY/nodes/Path","KITE/Shape"],function(t){var e=t("PHET_CORE/inherit"),i=t("SCENERY/scenery"),n=t("SCENERY/nodes/Path"),s=t("KITE/Shape");i.Circle=function(t,e){"object"==typeof t?e=t:(this._radius=t,e=e||{},e.shape=s.circle(0,0,t)),n.call(this,e)};var r=i.Circle;return e(n,r,{invalidateCircle:function(){this.setShape(s.circle(0,0,this._radius))},createSVGFragment:function(){return document.createElementNS("http://www.w3.org/2000/svg","circle")},updateSVGFragment:function(t){t.setAttribute("r",this._radius),t.setAttribute("style",this.getSVGFillStyle()+this.getSVGStrokeStyle())},getBasicConstructor:function(t){return"new scenery.Circle( "+this._radius+", {"+t+"} )"},getRadius:function(){return this._radius},setRadius:function(t){return this._radius!==t&&(this._radius=t,this.invalidateCircle()),this},computeShapeBounds:function(){return this._stroke?this._shape.bounds.dilated(this._lineDrawingStyles.lineWidth/2):this._shape.bounds},containsPointSelf:function(t){return t.x*t.x+t.y*t.y<this._radius*this._radius},get radius(){return this.getRadius()},set radius(t){return this.setRadius(t)}}),r.prototype._mutatorKeys=["radius"].concat(n.prototype._mutatorKeys),r}),define("view/shape-views/ResistorView",["require","SCENERY/nodes/Node","PHET_CORE/inherit","SCENERY/nodes/Circle","SCENERY/util/LinearGradient","SCENERY/nodes/Path","KITE/Shape","DOT/LinearFunction"],function(t){function e(t,e,n,u){function l(t,e){return Math.sqrt(Math.abs((1-(t-100)*(t-100))/(e*e)*e/3*(e/3)))-e/5}function c(t,e){return t.y-100>-e/2+3&&t.y-100<e/2-3&&t.x-290>-p/2+0+l(t.y,e)&&t.x-290<p/2+0-l(t.y,e)}i.call(this,{x:e,y:n});var d,f,m=200,p=500,g=m/3,v=new a,y=new a,E=new i,S=new r(0,0,0,m).addColorStop(0,"#e4e4e4").addColorStop(.2,"#FFF").addColorStop(.5,"#FFF").addColorStop(.81,"#bfbfbf").addColorStop(1,"#575757"),T=new h(u.area.min,u.area.max,3,200,!0),w=new h(u.length.min,u.length.max,15,500,!0),b=new h(u.resistivity.min,u.resistivity.max,25,500,!0);E.addChild(d=new o({shape:v,stroke:"#000",fill:S,lineWidth:1})),E.addChild(f=new o({shape:y,stroke:"#000",fill:"#f2f2f2",lineWidth:1})),this.addChild(E);for(var C=new i,x=500,_=(m-3)*(p+g)/x,R=Math.pow(_,.5),P=Math.round(m/R),N=Math.round((p+g)/R),I=0,L=[],A=1;P>=A;A++)for(var M=1;N>=M;M++){var O=new s(2,{fill:"#000"});O.y=A*R-R/2+.7*Math.random()*R-3,O.x=M*R-R/2+.7*Math.random()*R,L.push(O),C.addChild(O),I++}for(x=I,A=L.length-1;A>-1;A--){var Y=parseInt(Math.random()*A,10),B=L[A];L[A]=L[Y],L[Y]=B}this.addChild(C),t.resistanceProperty.link(function(){v=new a,y=new a,m=T(t.area),p=w(t.length),g=m/3,S.end.y=m,v.moveTo(5,0),v.cubicCurveTo(g+5,0,g+5,m,5,m),v.lineTo(p-3,m),v.cubicCurveTo(p-3+g,m,p-3+g,0,p-3,0),v.close(),y.moveTo(5,0),y.cubicCurveTo(g+5,0,g+5,m,5,m),y.cubicCurveTo(-g+5,m,-g+5,0,5,0),y.close(),d.shape=v,f.shape=y,E.centerX=0,E.centerY=0;for(var e=b(t.resistivity),i=0;x>i;i++)e>i&&c(L[i],m)?L[i].setVisible(!0):L[i].setVisible(!1);C.centerX=0,C.centerY=0})}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("SCENERY/nodes/Circle"),r=t("SCENERY/util/LinearGradient"),o=t("SCENERY/nodes/Path"),a=t("KITE/Shape"),h=t("DOT/LinearFunction");return n(i,e),e}),define("view/ResistanceInAWireStageContainer",["require","SCENERY/nodes/Node","PHET_CORE/inherit","view/ResetAllButton","SCENERY_PHET/ArrowNode","view/shape-views/SlidersBox","view/shape-views/FormulaView","view/shape-views/ResistorView"],function(t){function e(t){i.call(this,{scale:.75});var e={resistivity:{max:1,min:.01},length:{max:20,min:.1},area:{max:15,min:.01}};this.addChild(new a(t,70,180)),this.addChild(new h(t,290,470,e)),this.addChild(new r(200,600,350,600,{headHeight:50,headWidth:30,tailWidth:10,fill:"#FFF",stroke:"#000",lineWidth:1})),this.addChild(new o(t,600,40,e)),this.addChild(new i({x:750,y:560,children:[new s(function(){t.reset()})]}))}var i=t("SCENERY/nodes/Node"),n=t("PHET_CORE/inherit"),s=t("view/ResetAllButton"),r=t("SCENERY_PHET/ArrowNode"),o=t("view/shape-views/SlidersBox"),a=t("view/shape-views/FormulaView"),h=t("view/shape-views/ResistorView");return n(i,e),e}),define("view/ResistanceInAWireView",["require","view/ResistanceInAWireStageContainer","JOIST/ScreenView","PHET_CORE/inherit"],function(t){function e(t){n.call(this,{renderer:"svg"}),this.addChild(new i(t))}var i=t("view/ResistanceInAWireStageContainer"),n=t("JOIST/ScreenView"),s=t("PHET_CORE/inherit");return s(n,e),e}),define("resistance-in-a-wire-main",["require","JOIST/SimLauncher","JOIST/Sim","resistance-in-a-wire-strings","SCENERY/nodes/Rectangle","model/ResistanceInAWireModel","view/ResistanceInAWireView","imageLoader"],function(t){var e=t("JOIST/SimLauncher"),i=t("JOIST/Sim"),n=t("resistance-in-a-wire-strings"),s=t("SCENERY/nodes/Rectangle"),r=t("model/ResistanceInAWireModel"),o=t("view/ResistanceInAWireView"),a=t("imageLoader"),h={credits:"PhET Development Team -\nLead Design: Michael Dubson\nSoftware Development: Michael Dubson, John Blanco\nDesign Team: Ariel Paul\nInterviews: Wendy Adams, Mindy Gratny\n",thanks:"Thanks -\nThanks to Mobile Learner Labs for working with the PhET development team to convert this simulation to HTML5."};e.launch(a,function(){new i(n.simTitle,[{name:n.simTitle,icon:new s(0,0,50,50,{fill:"blue"}),createModel:function(){return new r},createView:function(t){return new o(t)},backgroundColor:"#ffffdf"}],h).start()})}),require.config({deps:["resistance-in-a-wire-main"],config:{i18n:{locale:"en_us"}},paths:{i18n:"../lib/i18n-2.0.2",ASSERT:"../../assert/js",AXON:"../../axon/js",DOT:"../../dot/js",JOIST:"../../joist/js",KITE:"../../kite/js",NITROGLYCERIN:"../../nitroglycerin/js",PHET_CORE:"../../phet-core/js",PHETCOMMON:"../../phetcommon/js",SCENERY:"../../scenery/js",SCENERY_PHET:"../../scenery-phet/js",SUN:"../../sun/js"},urlArgs:(new Date).getTime()}),define("resistance-in-a-wire-config",function(){})}();